<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(e){/^global-alert-/.test(e)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://coraza.io/main.08040bc4f930cbd11ade8cde0f20f30f51874e67e12c205ee34b2bc8e27b935fc1403e5dc7e89fd73be9a140225ede53f8b469ee6bb84eebbc32c3bba1982c1f.css integrity="sha512-CAQLxPkwy9Ea3ozeDyDzD1GHTmfhLCBe40sryOJ7k1/BQD5dx+if1zvpoUAiXt5T+LRp7mu4Tuu8MsO7oZgsHw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Extending - OWASP Coraza</title><meta name=description content="Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines."><link rel=canonical href=https://coraza.io/docs/reference/extending/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Extending"><meta property="og:description" content="Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines."><meta property="og:url" content="https://coraza.io/docs/reference/extending/"><meta property="og:site_name" content="OWASP Coraza"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Extending"><meta name=twitter:description content="Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines."><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Extending"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/reference/extending/","url":"https://coraza.io/docs/reference/extending/","name":"Extending","description":"Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines.","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/reference/extending/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/reference/extending/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/reference/extending/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/reference/extending/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/reference/","url":"https://coraza.io/docs/reference/","name":"Reference"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/reference/extending/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Extending","description":"Easily extend Coraza with your own Operators, Actions, Audit Loggers and Persistence engines.","isPartOf":{"@id":"https://coraza.io/docs/reference/extending/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/reference/extending/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/reference/extending/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso and Coraza contributors","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/reference/extending/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Extending"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div id=announcement data-id=global-alert-c965de2304062d13ca89378ac0b47df7 class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>Coraza v3 <a class=alert-link href=https://github.com/corazawaf/coraza/releases>available here!</a>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class="docs-link active" href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class="docs-link active" href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#installing-a-plugin>Installing a plugin</a></li><li><a href=#creating-rule-actions>Creating Rule Actions</a><ul><li><a href=#rule-action-interface>Rule Action interface</a></li><li><a href=#action-types>Action types</a></li><li><a href=#creating-a-custom-action>Creating a custom action</a></li><li><a href=#transforming-the-action-to-plugin>Transforming the action to plugin</a></li></ul></li><li><a href=#creating-rule-transformations>Creating Rule Transformations</a><ul><li><a href=#transformation-type>Transformation Type</a></li><li><a href=#example>Example</a></li></ul></li><li><a href=#creating-rule-operators>Creating Rule Operators</a><ul><li><a href=#rule-operator-interface>Rule Operator interface</a></li><li><a href=#creating-a-custom-operator>Creating a custom operator</a></li><li><a href=#transforming-the-operator-to-plugin>Transforming the operator to plugin</a></li></ul></li><li><a href=#testing-your-plugin>Testing your plugin</a></li><li><a href=#adding-plugins-to-coraza-plugin-repository>Adding plugins to Coraza Plugin Repository</a><ul><li><a href=#requirements>Requirements</a></li><li><a href=#corazayml>.coraza.yml</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#installing-a-plugin>Installing a plugin</a></li><li><a href=#creating-rule-actions>Creating Rule Actions</a><ul><li><a href=#rule-action-interface>Rule Action interface</a></li><li><a href=#action-types>Action types</a></li><li><a href=#creating-a-custom-action>Creating a custom action</a></li><li><a href=#transforming-the-action-to-plugin>Transforming the action to plugin</a></li></ul></li><li><a href=#creating-rule-transformations>Creating Rule Transformations</a><ul><li><a href=#transformation-type>Transformation Type</a></li><li><a href=#example>Example</a></li></ul></li><li><a href=#creating-rule-operators>Creating Rule Operators</a><ul><li><a href=#rule-operator-interface>Rule Operator interface</a></li><li><a href=#creating-a-custom-operator>Creating a custom operator</a></li><li><a href=#transforming-the-operator-to-plugin>Transforming the operator to plugin</a></li></ul></li><li><a href=#testing-your-plugin>Testing your plugin</a></li><li><a href=#adding-plugins-to-coraza-plugin-repository>Adding plugins to Coraza Plugin Repository</a><ul><li><a href=#requirements>Requirements</a></li><li><a href=#corazayml>.coraza.yml</a></li></ul></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/reference/>Reference</a></li><li class="breadcrumb-item active" aria-current=page>Extending</li></ol></nav><h1>Extending</h1><p class=lead>Plugins can be used to extend Coraza functionalities, right now, you can only extend Rule Actions, Rule Operators and Rule Transactions, but in the near future you may be able to add many additional functionalities.</p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#installing-a-plugin>Installing a plugin</a></li><li><a href=#creating-rule-actions>Creating Rule Actions</a><ul><li><a href=#rule-action-interface>Rule Action interface</a></li><li><a href=#action-types>Action types</a></li><li><a href=#creating-a-custom-action>Creating a custom action</a></li><li><a href=#transforming-the-action-to-plugin>Transforming the action to plugin</a></li></ul></li><li><a href=#creating-rule-transformations>Creating Rule Transformations</a><ul><li><a href=#transformation-type>Transformation Type</a></li><li><a href=#example>Example</a></li></ul></li><li><a href=#creating-rule-operators>Creating Rule Operators</a><ul><li><a href=#rule-operator-interface>Rule Operator interface</a></li><li><a href=#creating-a-custom-operator>Creating a custom operator</a></li><li><a href=#transforming-the-operator-to-plugin>Transforming the operator to plugin</a></li></ul></li><li><a href=#testing-your-plugin>Testing your plugin</a></li><li><a href=#adding-plugins-to-coraza-plugin-repository>Adding plugins to Coraza Plugin Repository</a><ul><li><a href=#requirements>Requirements</a></li><li><a href=#corazayml>.coraza.yml</a></li></ul></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#installing-a-plugin>Installing a plugin</a></li><li><a href=#creating-rule-actions>Creating Rule Actions</a><ul><li><a href=#rule-action-interface>Rule Action interface</a></li><li><a href=#action-types>Action types</a></li><li><a href=#creating-a-custom-action>Creating a custom action</a></li><li><a href=#transforming-the-action-to-plugin>Transforming the action to plugin</a></li></ul></li><li><a href=#creating-rule-transformations>Creating Rule Transformations</a><ul><li><a href=#transformation-type>Transformation Type</a></li><li><a href=#example>Example</a></li></ul></li><li><a href=#creating-rule-operators>Creating Rule Operators</a><ul><li><a href=#rule-operator-interface>Rule Operator interface</a></li><li><a href=#creating-a-custom-operator>Creating a custom operator</a></li><li><a href=#transforming-the-operator-to-plugin>Transforming the operator to plugin</a></li></ul></li><li><a href=#testing-your-plugin>Testing your plugin</a></li><li><a href=#adding-plugins-to-coraza-plugin-repository>Adding plugins to Coraza Plugin Repository</a><ul><li><a href=#requirements>Requirements</a></li><li><a href=#corazayml>.coraza.yml</a></li></ul></li></ul></nav></div></nav><ul><li><strong>Rule Operators:</strong> Create rule operators like @even to detect even numbers</li><li><strong>Rule Transformations:</strong> Create rule transformations like t:rot13 to encode your values in ROT13</li><li><strong>Rule Actions:</strong> Create rule actions like challenge to redirect a malicious request to some bot detection system</li></ul><p>The plugin interface provides three functions to extend rule operators, transformations and actions. Each one of them must match it&rsquo;s proper type or interface and be registered using the <code>plugins</code> package.</p><ul><li><strong>Operators</strong>: <code>type PluginOperatorWrapper() types.RuleOperator</code></li><li><strong>Actions</strong>: <code>type PluginOperatorWrapper() types.RuleAction</code></li><li><strong>Transformations</strong>: <code>type Transformation = func(input string, tools *transformations.Tools) string</code></li></ul><p>After defining the plugins, we must register them using the <code>plugins.Register...</code> function inside the init function <code>func init(){}</code>.</p><ul><li><strong>Operators</strong>: <code>operators.RegisterPlugin(operator PluginOperatorWrapper)</code></li><li><strong>Actions</strong>: <code>actions.RegisterPlugin(action PluginActionWrapper)</code></li><li><strong>Transformations</strong>: <code>transformations.RegisterPlugin(transformation transformations.Transformation)</code></li></ul><p><strong>Important:</strong> Some integrations like Traefik does not support plugins, because we cannot control how the integration is compiled by Pilot.</p><h2 id=installing-a-plugin>Installing a plugin <a href=#installing-a-plugin class=anchor aria-hidden=true>#</a></h2><p>Plugin model is based on Caddy plugins system, they must be compiled within the project just by importing them like this:</p><pre><code class=language-go>import(
    &quot;github.com/corazawaf/coraza/v3&quot;
    _ &quot;github.com/someone/somecorazaplugin&quot;
)
</code></pre><h2 id=creating-rule-actions>Creating Rule Actions <a href=#creating-rule-actions class=anchor aria-hidden=true>#</a></h2><h3 id=rule-action-interface>Rule Action interface <a href=#rule-action-interface class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type RuleAction interface {
	// Initializes an action, will be done during compilation
	Init(*Rule, string) error
	// Evaluate will be done during rule evaluation
	Evaluate(*Rule, *Transaction)
	// Type will return the rule type, it's used by Evaluate
	// to choose when to evaluate each action
	Type() types.RuleActionType
}
</code></pre><h3 id=action-types>Action types <a href=#action-types class=anchor aria-hidden=true>#</a></h3><p>Each action can have one type that defines in which part of the rule lifetime it will be evaluated.</p><ul><li><strong>ACTION_TYPE_DISRUPTIVE</strong>: Cause Coraza to do something. In many cases something means block transaction, but not in all. For example, the allow action is classified as a disruptive action, but it does the opposite of blocking. There can only be one disruptive action per rule (if there are multiple disruptive actions present, or inherited, only the last one will take effect), or rule chain (in a chain, a disruptive action can only appear in the first rule).</li><li><strong>ACTION_TYPE_NONDISRUPTIVE</strong>: Do something, but that something does not and cannot affect the rule processing flow. Setting a variable, or changing its value is an example of a non-disruptive action. Non-disruptive action can appear in any rule, including each rule belonging to a chain.</li><li><strong>ACTION_TYPE_FLOW</strong>: These actions affect the rule flow (for example skip or skipAfter).</li><li><strong>ACTION_TYPE_METADATA</strong>: Meta-data actions are used to provide more information about rules. Examples include id, rev, severity and msg.</li><li><strong>ACTION_TYPE_DATA</strong>: - Not really actions, these are mere containers that hold data used by other actions. For example, the status action holds the status that will be used for blocking (if it takes place).</li></ul><h3 id=creating-a-custom-action>Creating a custom action <a href=#creating-a-custom-action class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type id15 struct{}

// Initializes an action, will be done during compilation
func (id15) Init(rule *coraza.Rule, _ string) error {
 rule.Id = 15
 return nil
}

// Evaluate will be done during rule evaluation
func (id15) Evaluate(_ *coraza.Rule, _ *coraza.Transaction) {}

// ACTION_TYPE_DATA will be only evaluated while compiling the rule, Evaluate won't be called
func (id15) Type() int {
 return coraza.ACTION_TYPE_DATA
}

// Tripwire to match coraza.RuleAction type
var _ coraza.RuleAction = &amp;id15{}
</code></pre><h3 id=transforming-the-action-to-plugin>Transforming the action to plugin <a href=#transforming-the-action-to-plugin class=anchor aria-hidden=true>#</a></h3><p>Once the action is created, it must be wrapper inside a <code>type PluginActionWrapper = func() types.RuleAction</code> in order to be registered.</p><pre><code class=language-go>import(
    &quot;github.com/corazawaf/coraza/v3/actions&quot;
    &quot;github.com/corazawaf/coraza/v3/types&quot;
)

func init() {
 actions.RegisterPlugin(&quot;id15&quot;, func() types.RuleAction {
  return &amp;id15{}
 })
}
</code></pre><p>After properly importing the plugin, you may be able to create rules with <code>id15</code> action, for example:</p><pre><code class=language-conf>SecAction &quot;id15, nolog, pass&quot;
</code></pre><h2 id=creating-rule-transformations>Creating Rule Transformations <a href=#creating-rule-transformations class=anchor aria-hidden=true>#</a></h2><p>Transformations are the easiest components to extend, each transformation implements the <code>transformations.Transformation</code> type and can be registered directly using <code>plugins.RegisterPlugin(transformation transformations.Transformation)</code>.</p><p>The *Tools struct is designed to add additional functionalities like logging and unicode mapping.</p><h3 id=transformation-type>Transformation Type <a href=#transformation-type class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type Transformation = func(input string, tools *Tools) string
</code></pre><h3 id=example>Example <a href=#example class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>import (
  &quot;github.com/corazawaf/coraza/v3/transformations&quot;
  &quot;strings&quot;
)

func transformationToLowercase(input string) (string, error) {
 return strings.ToLower(input)
}

func init() {
  transformations.RegisterPlugin(&quot;tolower2&quot;, transformationToLowercase)
}
</code></pre><h2 id=creating-rule-operators>Creating Rule Operators <a href=#creating-rule-operators class=anchor aria-hidden=true>#</a></h2><h3 id=rule-operator-interface>Rule Operator interface <a href=#rule-operator-interface class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>// Operator interface is used to define rule @operators
type Operator interface {
 // Init is used during compilation to setup and cache
 // the operator
 Init(string) error
 // Evaluate is used during the rule evaluation,
 // it returns true if the operator succeeded against
 // the input data for the transaction
 Evaluate(*Transaction, string) bool
}
</code></pre><h3 id=creating-a-custom-operator>Creating a custom operator <a href=#creating-a-custom-operator class=anchor aria-hidden=true>#</a></h3><pre><code class=language-go>type opEven struct{}

func (opEven) Init(_ string) error {
 return nil
}

func (opEven) Evaluate(_ *coraza.Transaction, input string) bool {
 i, _ := strconv.Atoi(input)
 return i%2 == 0
}

//Tripwire
var _ coraza.Operator = &amp;opEven{}
</code></pre><h3 id=transforming-the-operator-to-plugin>Transforming the operator to plugin <a href=#transforming-the-operator-to-plugin class=anchor aria-hidden=true>#</a></h3><p>Once the operator is created, it must be wrapper inside a <code>type PluginOperatorWrapper = func() coraza.Operator</code> in order to be registered.</p><pre><code class=language-go>import(
    &quot;github.com/corazawaf/coraza/v3/operators&quot;
    &quot;github.com/corazawaf/coraza/v3/types&quot;
)

func init() {
 operators.RegisterPlugin(&quot;even&quot;, func() types.Operator {
  return &amp;opEven{}
 })
}
</code></pre><p>After properly importing the plugin, you may be able to create rules with <code>even</code> operator, for example:</p><pre><code class=language-conf>SecRule ARGS:id &quot;@even&quot; &quot;id:1, nolog, pass&quot;
</code></pre><h2 id=testing-your-plugin>Testing your plugin <a href=#testing-your-plugin class=anchor aria-hidden=true>#</a></h2><p>There are no special helpers to test plugins but you may use the seclang compiler to achieve this, for example, if we want to test that the tolower2 transformation works we must write the following test:</p><pre><code class=language-go>import(
    &quot;github.com/jptosso/coraza-waf/v2/seclang&quot;
    &quot;github.com/jptosso/coraza-waf/v2/types&quot;
    &quot;github.com/jptosso/coraza-waf/v2/transformations&quot;
    &quot;strings&quot;
    &quot;testing&quot;
)

func TestToLower2(t *testing.T){
  waf := coraza.NewWaf()
  parser, _ := seclang.NewParser(waf)
  if err := parser.FromString(`SecRule ARGS:id &quot;lowercase&quot; &quot;id:1, t:tolower2&quot;`); err != nil{
    t.Error(err)
  }
  str := &quot;TOLowEr&quot;
  if strings.ToLower(str) != transformationToLowercase(str) {
    t.Error(&quot;Transformation tolower2 failed&quot;)
  }
}
</code></pre><h2 id=adding-plugins-to-coraza-plugin-repository>Adding plugins to Coraza Plugin Repository <a href=#adding-plugins-to-coraza-plugin-repository class=anchor aria-hidden=true>#</a></h2><p>This feature will be available soon, in the meantime, you can edit this site and add plugins to <code>plugins.html</code>.</p><p>The site will update it&rsquo;s database every 60 minutes, searching for projects with the <code>coraza-plugin</code> topic.</p><p>If the site fails to add the plugin to the database, it will create an issue with the details.</p><h3 id=requirements>Requirements <a href=#requirements class=anchor aria-hidden=true>#</a></h3><ul><li>The project must be public in github.</li><li>The project must have the <code>coraza-plugin</code> keyword.</li><li>The project must have a valid <code>.coraza.yml</code> file in the root path.</li><li>The project must have a valid <code>go.mod</code> file</li></ul><h3 id=corazayml>.coraza.yml <a href=#corazayml class=anchor aria-hidden=true>#</a></h3><p>This file will be used in the future by the Coraza Public Plugin Repository, it&rsquo;s not required by the plugin itself.</p><p><code>.coraza.yml</code> must be placed in the root directory of your repository and it must contain the following valid yaml structure:</p><pre><code class=language-yaml># We only accept alphanumeric and -.  ([\w-])
name: some-plugin
author: Your Full name or whatever you want to show
repository: github.com/path/to-project
# Coraza Plugin repository will only accept projects with apache2, MIT and BSD licenses,
# we might accept more in the future
license: apache2
description: Short description to display in plugins.coraza.io
# We are using Ruby Gem version syntax: https://guides.rubygems.org/patterns/#pessimistic-version-constraint
# The min supported Coraza version, each item represents an AND operator
version: 
  - &quot;&gt;= v1.1&quot;
  - &quot;&lt; v2&quot;
  # or ~&gt; that is identical to the previous statements
  - &quot;~&gt; v1.1&quot;
tags:
  - Add some tags
  - For filtering
defs:
  - name: even
    type: action|operator|transformation
    description: Will match if the number is even
</code></pre><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/reference/extending.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/reference/body-processing/><div class="card my-1"><div class="card-body py-2">&larr; Body Processing</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ❤️ (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.f06fe6dc0efc9ee1e806021a0c338278256ecf163b547e8e8769fe60b0a1c0d505782852616ca4e1ff6a719eb8fc954e1d26031b8ab3ca71fb9d9998081b319e.js integrity="sha512-8G/m3A78nuHoBgIaDDOCeCVuzxY7VH6Oh2n+YLChwNUFeChSYWyk4f9qcZ64/JVOHSYDG4qzynH7nZmYCBsxng==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.5c42765ed4daf59624a6e775bdc4bc68bba6664f4d678ecbc55390f986b6852e562c726fb5fd57b078713aa5aef95ebac205fe24f3d998ab84e10b6b28c413ee.js integrity="sha512-XEJ2XtTa9ZYkpud1vcS8aLumZk9NZ47LxVOQ+Ya2hS5WLHJvtf1XsHhxOqWu+V66wgX+JPPZmKuE4QtrKMQT7g==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.3bb8f119f63c6e06aa99acc71b7037b0c5461db421d5a169df0b668ca079081263bcc72dccff7584205495b398338b1da5ab6051c7fd7d0dc8a29c73e0a86c97.js integrity="sha512-O7jxGfY8bgaqmazHG3A3sMVGHbQh1aFp3wtmjKB5CBJjvMctzP91hCBUlbOYM4sdpatgUcf9fQ3Iopxz4Khslw==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.cdbb8d22808922eaf383e333a9859ee124264202d94d624a8f4632d420a8e467174a8f7ffa7c2d5926065063a5ac4b71e8f60e8f5100ed42245ba7efd885eb82.js integrity="sha512-zbuNIoCJIurzg+MzqYWe4SQmQgLZTWJKj0Yy1CCo5GcXSo9/+nwtWSYGUGOlrEtx6PYOj1EA7UIkW6fv2IXrgg==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>