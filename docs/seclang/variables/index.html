<!doctype html><html lang=" en-us"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(e){/^global-alert-/.test(e)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://coraza.io/main.40abc73e5a2a2eff060c63ebda259239092cb4975a1f301e036e0194a1d839f0cba6bd6197d9115760f6685683a05580081bebe421a21d01f8469072245e42bd.css integrity="sha512-QKvHPloqLv8GDGPr2iWSOQkstJdaHzAeA24BlKHYOfDLpr1hl9kRV2D2aFaDoFWACBvr5CGiHQH4RpByJF5CvQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Variables - OWASP Coraza</title><meta name=description content="ARGS # ARGS is a collection and can be used on its own (means all arguments including the POST Payload), with a static parameter (matches arguments with that name), or with a regular expression (matches all arguments with name that matches the regular expression). To look at only the query string or body arguments, see the ARGS_GET and ARGS_POST collections.
Some variables are actually collections, which are expanded into more variables at runtime."><link rel=canonical href=https://coraza.io/docs/seclang/variables/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Variables"><meta property="og:description" content="ARGS # ARGS is a collection and can be used on its own (means all arguments including the POST Payload), with a static parameter (matches arguments with that name), or with a regular expression (matches all arguments with name that matches the regular expression). To look at only the query string or body arguments, see the ARGS_GET and ARGS_POST collections.
Some variables are actually collections, which are expanded into more variables at runtime."><meta property="og:url" content="https://coraza.io/docs/seclang/variables/"><meta property="og:site_name" content="OWASP Coraza"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Variables"><meta name=twitter:description content><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Variables"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/variables/","url":"https://coraza.io/docs/seclang/variables/","name":"Variables","description":"","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/variables/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/variables/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/variables/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/variables/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/variables/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Variables","description":"","isPartOf":{"@id":"https://coraza.io/docs/seclang/variables/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/variables/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/variables/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso and Coraza contributors","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/variables/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Variables"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div id=announcement data-id=global-alert-5c43d4a74d41be706ab06ce490a3cf1b class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>Coraza v3 will be available soon, <a class=alert-link href=https://github.com/corazawaf/coraza/issues/336>stay tuned!</a>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 ðŸ†•</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 ðŸ†•</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#args>ARGS</a></li><li><a href=#args_combined_size>ARGS_COMBINED_SIZE</a></li><li><a href=#args_get>ARGS_GET</a></li><li><a href=#args_get_names>ARGS_GET_NAMES</a></li><li><a href=#args_names>ARGS_NAMES</a></li><li><a href=#args_post>ARGS_POST</a></li><li><a href=#args_post_names>ARGS_POST_NAMES</a></li><li><a href=#auth_type>AUTH_TYPE</a></li><li><a href=#duration>DURATION</a></li><li><a href=#env>ENV</a></li><li><a href=#files>FILES</a></li><li><a href=#files_combined_size>FILES_COMBINED_SIZE</a></li><li><a href=#files_names>FILES_NAMES</a></li><li><a href=#full_request_length>FULL_REQUEST_LENGTH</a></li><li><a href=#files_sizes>FILES_SIZES</a></li><li><a href=#files_tmpnames>FILES_TMPNAMES</a></li><li><a href=#files_tmp_content>FILES_TMP_CONTENT</a></li><li><a href=#geo>GEO</a></li><li><a href=#highest_severity>HIGHEST_SEVERITY</a></li><li><a href=#inbound_data_error>INBOUND_DATA_ERROR</a></li><li><a href=#matched_var>MATCHED_VAR</a></li><li><a href=#matched_vars>MATCHED_VARS</a></li><li><a href=#matched_var_name>MATCHED_VAR_NAME</a></li><li><a href=#matched_vars_names>MATCHED_VARS_NAMES</a></li><li><a href=#multipart_filename>MULTIPART_FILENAME</a></li><li><a href=#multipart_name>MULTIPART_NAME</a></li><li><a href=#outbound_data_error>OUTBOUND_DATA_ERROR</a></li><li><a href=#path_info>PATH_INFO</a></li><li><a href=#perf_all>PERF_ALL</a></li><li><a href=#perf_combined>PERF_COMBINED</a></li><li><a href=#perf_logging>PERF_LOGGING</a></li><li><a href=#perf_phase1>PERF_PHASE1</a></li><li><a href=#perf_phase2>PERF_PHASE2</a></li><li><a href=#perf_phase3>PERF_PHASE3</a></li><li><a href=#perf_phase4>PERF_PHASE4</a></li><li><a href=#perf_phase5>PERF_PHASE5</a></li><li><a href=#perf_rules>PERF_RULES</a></li><li><a href=#perf_sread>PERF_SREAD</a></li><li><a href=#perf_swrite>PERF_SWRITE</a></li><li><a href=#query_string>QUERY_STRING</a></li><li><a href=#remote_addr>REMOTE_ADDR</a></li><li><a href=#remote_host>REMOTE_HOST</a></li><li><a href=#remote_port>REMOTE_PORT</a></li><li><a href=#remote_user>REMOTE_USER</a></li><li><a href=#reqbody_error>REQBODY_ERROR</a></li><li><a href=#reqbody_error_msg>REQBODY_ERROR_MSG</a></li><li><a href=#reqbody_processor>REQBODY_PROCESSOR</a></li><li><a href=#request_basename>REQUEST_BASENAME</a></li><li><a href=#request_body>REQUEST_BODY</a></li><li><a href=#request_body_length>REQUEST_BODY_LENGTH</a></li><li><a href=#request_cookies>REQUEST_COOKIES</a></li><li><a href=#request_cookies_names>REQUEST_COOKIES_NAMES</a></li><li><a href=#request_filename>REQUEST_FILENAME</a></li><li><a href=#request_headers>REQUEST_HEADERS</a></li><li><a href=#request_headers_names>REQUEST_HEADERS_NAMES</a></li><li><a href=#request_line>REQUEST_LINE</a></li><li><a href=#request_method>REQUEST_METHOD</a></li><li><a href=#request_protocol>REQUEST_PROTOCOL</a></li><li><a href=#request_uri_raw>REQUEST_URI_RAW</a></li><li><a href=#response_body>RESPONSE_BODY</a></li><li><a href=#response_content_length>RESPONSE_CONTENT_LENGTH</a></li><li><a href=#response_content_type>RESPONSE_CONTENT_TYPE</a></li><li><a href=#response_headers>RESPONSE_HEADERS</a></li><li><a href=#response_headers_names>RESPONSE_HEADERS_NAMES</a></li><li><a href=#response_protocol>RESPONSE_PROTOCOL</a></li><li><a href=#response_status>RESPONSE_STATUS</a></li><li><a href=#rule>RULE</a></li><li><a href=#server_addr>SERVER_ADDR</a></li><li><a href=#server_name>SERVER_NAME</a></li><li><a href=#server_port>SERVER_PORT</a></li><li><a href=#session>SESSION</a></li><li><a href=#sessionid>SESSIONID</a></li><li><a href=#status_line>STATUS_LINE</a></li><li><a href=#time>TIME</a></li><li><a href=#time_day>TIME_DAY</a></li><li><a href=#time_epoch>TIME_EPOCH</a></li><li><a href=#time_hour>TIME_HOUR</a></li><li><a href=#time_min>TIME_MIN</a></li><li><a href=#time_mon>TIME_MON</a></li><li><a href=#time_sec>TIME_SEC</a></li><li><a href=#time_wday>TIME_WDAY</a></li><li><a href=#time_year>TIME_YEAR</a></li><li><a href=#tx>TX</a></li><li><a href=#unique_id>UNIQUE_ID</a></li><li><a href=#urlencoded_error>URLENCODED_ERROR</a></li><li><a href=#userid>USERID</a></li><li><a href=#webappid>WEBAPPID</a></li><li><a href=#xml>XML</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#args>ARGS</a></li><li><a href=#args_combined_size>ARGS_COMBINED_SIZE</a></li><li><a href=#args_get>ARGS_GET</a></li><li><a href=#args_get_names>ARGS_GET_NAMES</a></li><li><a href=#args_names>ARGS_NAMES</a></li><li><a href=#args_post>ARGS_POST</a></li><li><a href=#args_post_names>ARGS_POST_NAMES</a></li><li><a href=#auth_type>AUTH_TYPE</a></li><li><a href=#duration>DURATION</a></li><li><a href=#env>ENV</a></li><li><a href=#files>FILES</a></li><li><a href=#files_combined_size>FILES_COMBINED_SIZE</a></li><li><a href=#files_names>FILES_NAMES</a></li><li><a href=#full_request_length>FULL_REQUEST_LENGTH</a></li><li><a href=#files_sizes>FILES_SIZES</a></li><li><a href=#files_tmpnames>FILES_TMPNAMES</a></li><li><a href=#files_tmp_content>FILES_TMP_CONTENT</a></li><li><a href=#geo>GEO</a></li><li><a href=#highest_severity>HIGHEST_SEVERITY</a></li><li><a href=#inbound_data_error>INBOUND_DATA_ERROR</a></li><li><a href=#matched_var>MATCHED_VAR</a></li><li><a href=#matched_vars>MATCHED_VARS</a></li><li><a href=#matched_var_name>MATCHED_VAR_NAME</a></li><li><a href=#matched_vars_names>MATCHED_VARS_NAMES</a></li><li><a href=#multipart_filename>MULTIPART_FILENAME</a></li><li><a href=#multipart_name>MULTIPART_NAME</a></li><li><a href=#outbound_data_error>OUTBOUND_DATA_ERROR</a></li><li><a href=#path_info>PATH_INFO</a></li><li><a href=#perf_all>PERF_ALL</a></li><li><a href=#perf_combined>PERF_COMBINED</a></li><li><a href=#perf_logging>PERF_LOGGING</a></li><li><a href=#perf_phase1>PERF_PHASE1</a></li><li><a href=#perf_phase2>PERF_PHASE2</a></li><li><a href=#perf_phase3>PERF_PHASE3</a></li><li><a href=#perf_phase4>PERF_PHASE4</a></li><li><a href=#perf_phase5>PERF_PHASE5</a></li><li><a href=#perf_rules>PERF_RULES</a></li><li><a href=#perf_sread>PERF_SREAD</a></li><li><a href=#perf_swrite>PERF_SWRITE</a></li><li><a href=#query_string>QUERY_STRING</a></li><li><a href=#remote_addr>REMOTE_ADDR</a></li><li><a href=#remote_host>REMOTE_HOST</a></li><li><a href=#remote_port>REMOTE_PORT</a></li><li><a href=#remote_user>REMOTE_USER</a></li><li><a href=#reqbody_error>REQBODY_ERROR</a></li><li><a href=#reqbody_error_msg>REQBODY_ERROR_MSG</a></li><li><a href=#reqbody_processor>REQBODY_PROCESSOR</a></li><li><a href=#request_basename>REQUEST_BASENAME</a></li><li><a href=#request_body>REQUEST_BODY</a></li><li><a href=#request_body_length>REQUEST_BODY_LENGTH</a></li><li><a href=#request_cookies>REQUEST_COOKIES</a></li><li><a href=#request_cookies_names>REQUEST_COOKIES_NAMES</a></li><li><a href=#request_filename>REQUEST_FILENAME</a></li><li><a href=#request_headers>REQUEST_HEADERS</a></li><li><a href=#request_headers_names>REQUEST_HEADERS_NAMES</a></li><li><a href=#request_line>REQUEST_LINE</a></li><li><a href=#request_method>REQUEST_METHOD</a></li><li><a href=#request_protocol>REQUEST_PROTOCOL</a></li><li><a href=#request_uri_raw>REQUEST_URI_RAW</a></li><li><a href=#response_body>RESPONSE_BODY</a></li><li><a href=#response_content_length>RESPONSE_CONTENT_LENGTH</a></li><li><a href=#response_content_type>RESPONSE_CONTENT_TYPE</a></li><li><a href=#response_headers>RESPONSE_HEADERS</a></li><li><a href=#response_headers_names>RESPONSE_HEADERS_NAMES</a></li><li><a href=#response_protocol>RESPONSE_PROTOCOL</a></li><li><a href=#response_status>RESPONSE_STATUS</a></li><li><a href=#rule>RULE</a></li><li><a href=#server_addr>SERVER_ADDR</a></li><li><a href=#server_name>SERVER_NAME</a></li><li><a href=#server_port>SERVER_PORT</a></li><li><a href=#session>SESSION</a></li><li><a href=#sessionid>SESSIONID</a></li><li><a href=#status_line>STATUS_LINE</a></li><li><a href=#time>TIME</a></li><li><a href=#time_day>TIME_DAY</a></li><li><a href=#time_epoch>TIME_EPOCH</a></li><li><a href=#time_hour>TIME_HOUR</a></li><li><a href=#time_min>TIME_MIN</a></li><li><a href=#time_mon>TIME_MON</a></li><li><a href=#time_sec>TIME_SEC</a></li><li><a href=#time_wday>TIME_WDAY</a></li><li><a href=#time_year>TIME_YEAR</a></li><li><a href=#tx>TX</a></li><li><a href=#unique_id>UNIQUE_ID</a></li><li><a href=#urlencoded_error>URLENCODED_ERROR</a></li><li><a href=#userid>USERID</a></li><li><a href=#webappid>WEBAPPID</a></li><li><a href=#xml>XML</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Variables</li></ol></nav><h1>Variables</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#args>ARGS</a></li><li><a href=#args_combined_size>ARGS_COMBINED_SIZE</a></li><li><a href=#args_get>ARGS_GET</a></li><li><a href=#args_get_names>ARGS_GET_NAMES</a></li><li><a href=#args_names>ARGS_NAMES</a></li><li><a href=#args_post>ARGS_POST</a></li><li><a href=#args_post_names>ARGS_POST_NAMES</a></li><li><a href=#auth_type>AUTH_TYPE</a></li><li><a href=#duration>DURATION</a></li><li><a href=#env>ENV</a></li><li><a href=#files>FILES</a></li><li><a href=#files_combined_size>FILES_COMBINED_SIZE</a></li><li><a href=#files_names>FILES_NAMES</a></li><li><a href=#full_request_length>FULL_REQUEST_LENGTH</a></li><li><a href=#files_sizes>FILES_SIZES</a></li><li><a href=#files_tmpnames>FILES_TMPNAMES</a></li><li><a href=#files_tmp_content>FILES_TMP_CONTENT</a></li><li><a href=#geo>GEO</a></li><li><a href=#highest_severity>HIGHEST_SEVERITY</a></li><li><a href=#inbound_data_error>INBOUND_DATA_ERROR</a></li><li><a href=#matched_var>MATCHED_VAR</a></li><li><a href=#matched_vars>MATCHED_VARS</a></li><li><a href=#matched_var_name>MATCHED_VAR_NAME</a></li><li><a href=#matched_vars_names>MATCHED_VARS_NAMES</a></li><li><a href=#multipart_filename>MULTIPART_FILENAME</a></li><li><a href=#multipart_name>MULTIPART_NAME</a></li><li><a href=#outbound_data_error>OUTBOUND_DATA_ERROR</a></li><li><a href=#path_info>PATH_INFO</a></li><li><a href=#perf_all>PERF_ALL</a></li><li><a href=#perf_combined>PERF_COMBINED</a></li><li><a href=#perf_logging>PERF_LOGGING</a></li><li><a href=#perf_phase1>PERF_PHASE1</a></li><li><a href=#perf_phase2>PERF_PHASE2</a></li><li><a href=#perf_phase3>PERF_PHASE3</a></li><li><a href=#perf_phase4>PERF_PHASE4</a></li><li><a href=#perf_phase5>PERF_PHASE5</a></li><li><a href=#perf_rules>PERF_RULES</a></li><li><a href=#perf_sread>PERF_SREAD</a></li><li><a href=#perf_swrite>PERF_SWRITE</a></li><li><a href=#query_string>QUERY_STRING</a></li><li><a href=#remote_addr>REMOTE_ADDR</a></li><li><a href=#remote_host>REMOTE_HOST</a></li><li><a href=#remote_port>REMOTE_PORT</a></li><li><a href=#remote_user>REMOTE_USER</a></li><li><a href=#reqbody_error>REQBODY_ERROR</a></li><li><a href=#reqbody_error_msg>REQBODY_ERROR_MSG</a></li><li><a href=#reqbody_processor>REQBODY_PROCESSOR</a></li><li><a href=#request_basename>REQUEST_BASENAME</a></li><li><a href=#request_body>REQUEST_BODY</a></li><li><a href=#request_body_length>REQUEST_BODY_LENGTH</a></li><li><a href=#request_cookies>REQUEST_COOKIES</a></li><li><a href=#request_cookies_names>REQUEST_COOKIES_NAMES</a></li><li><a href=#request_filename>REQUEST_FILENAME</a></li><li><a href=#request_headers>REQUEST_HEADERS</a></li><li><a href=#request_headers_names>REQUEST_HEADERS_NAMES</a></li><li><a href=#request_line>REQUEST_LINE</a></li><li><a href=#request_method>REQUEST_METHOD</a></li><li><a href=#request_protocol>REQUEST_PROTOCOL</a></li><li><a href=#request_uri_raw>REQUEST_URI_RAW</a></li><li><a href=#response_body>RESPONSE_BODY</a></li><li><a href=#response_content_length>RESPONSE_CONTENT_LENGTH</a></li><li><a href=#response_content_type>RESPONSE_CONTENT_TYPE</a></li><li><a href=#response_headers>RESPONSE_HEADERS</a></li><li><a href=#response_headers_names>RESPONSE_HEADERS_NAMES</a></li><li><a href=#response_protocol>RESPONSE_PROTOCOL</a></li><li><a href=#response_status>RESPONSE_STATUS</a></li><li><a href=#rule>RULE</a></li><li><a href=#server_addr>SERVER_ADDR</a></li><li><a href=#server_name>SERVER_NAME</a></li><li><a href=#server_port>SERVER_PORT</a></li><li><a href=#session>SESSION</a></li><li><a href=#sessionid>SESSIONID</a></li><li><a href=#status_line>STATUS_LINE</a></li><li><a href=#time>TIME</a></li><li><a href=#time_day>TIME_DAY</a></li><li><a href=#time_epoch>TIME_EPOCH</a></li><li><a href=#time_hour>TIME_HOUR</a></li><li><a href=#time_min>TIME_MIN</a></li><li><a href=#time_mon>TIME_MON</a></li><li><a href=#time_sec>TIME_SEC</a></li><li><a href=#time_wday>TIME_WDAY</a></li><li><a href=#time_year>TIME_YEAR</a></li><li><a href=#tx>TX</a></li><li><a href=#unique_id>UNIQUE_ID</a></li><li><a href=#urlencoded_error>URLENCODED_ERROR</a></li><li><a href=#userid>USERID</a></li><li><a href=#webappid>WEBAPPID</a></li><li><a href=#xml>XML</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#args>ARGS</a></li><li><a href=#args_combined_size>ARGS_COMBINED_SIZE</a></li><li><a href=#args_get>ARGS_GET</a></li><li><a href=#args_get_names>ARGS_GET_NAMES</a></li><li><a href=#args_names>ARGS_NAMES</a></li><li><a href=#args_post>ARGS_POST</a></li><li><a href=#args_post_names>ARGS_POST_NAMES</a></li><li><a href=#auth_type>AUTH_TYPE</a></li><li><a href=#duration>DURATION</a></li><li><a href=#env>ENV</a></li><li><a href=#files>FILES</a></li><li><a href=#files_combined_size>FILES_COMBINED_SIZE</a></li><li><a href=#files_names>FILES_NAMES</a></li><li><a href=#full_request_length>FULL_REQUEST_LENGTH</a></li><li><a href=#files_sizes>FILES_SIZES</a></li><li><a href=#files_tmpnames>FILES_TMPNAMES</a></li><li><a href=#files_tmp_content>FILES_TMP_CONTENT</a></li><li><a href=#geo>GEO</a></li><li><a href=#highest_severity>HIGHEST_SEVERITY</a></li><li><a href=#inbound_data_error>INBOUND_DATA_ERROR</a></li><li><a href=#matched_var>MATCHED_VAR</a></li><li><a href=#matched_vars>MATCHED_VARS</a></li><li><a href=#matched_var_name>MATCHED_VAR_NAME</a></li><li><a href=#matched_vars_names>MATCHED_VARS_NAMES</a></li><li><a href=#multipart_filename>MULTIPART_FILENAME</a></li><li><a href=#multipart_name>MULTIPART_NAME</a></li><li><a href=#outbound_data_error>OUTBOUND_DATA_ERROR</a></li><li><a href=#path_info>PATH_INFO</a></li><li><a href=#perf_all>PERF_ALL</a></li><li><a href=#perf_combined>PERF_COMBINED</a></li><li><a href=#perf_logging>PERF_LOGGING</a></li><li><a href=#perf_phase1>PERF_PHASE1</a></li><li><a href=#perf_phase2>PERF_PHASE2</a></li><li><a href=#perf_phase3>PERF_PHASE3</a></li><li><a href=#perf_phase4>PERF_PHASE4</a></li><li><a href=#perf_phase5>PERF_PHASE5</a></li><li><a href=#perf_rules>PERF_RULES</a></li><li><a href=#perf_sread>PERF_SREAD</a></li><li><a href=#perf_swrite>PERF_SWRITE</a></li><li><a href=#query_string>QUERY_STRING</a></li><li><a href=#remote_addr>REMOTE_ADDR</a></li><li><a href=#remote_host>REMOTE_HOST</a></li><li><a href=#remote_port>REMOTE_PORT</a></li><li><a href=#remote_user>REMOTE_USER</a></li><li><a href=#reqbody_error>REQBODY_ERROR</a></li><li><a href=#reqbody_error_msg>REQBODY_ERROR_MSG</a></li><li><a href=#reqbody_processor>REQBODY_PROCESSOR</a></li><li><a href=#request_basename>REQUEST_BASENAME</a></li><li><a href=#request_body>REQUEST_BODY</a></li><li><a href=#request_body_length>REQUEST_BODY_LENGTH</a></li><li><a href=#request_cookies>REQUEST_COOKIES</a></li><li><a href=#request_cookies_names>REQUEST_COOKIES_NAMES</a></li><li><a href=#request_filename>REQUEST_FILENAME</a></li><li><a href=#request_headers>REQUEST_HEADERS</a></li><li><a href=#request_headers_names>REQUEST_HEADERS_NAMES</a></li><li><a href=#request_line>REQUEST_LINE</a></li><li><a href=#request_method>REQUEST_METHOD</a></li><li><a href=#request_protocol>REQUEST_PROTOCOL</a></li><li><a href=#request_uri_raw>REQUEST_URI_RAW</a></li><li><a href=#response_body>RESPONSE_BODY</a></li><li><a href=#response_content_length>RESPONSE_CONTENT_LENGTH</a></li><li><a href=#response_content_type>RESPONSE_CONTENT_TYPE</a></li><li><a href=#response_headers>RESPONSE_HEADERS</a></li><li><a href=#response_headers_names>RESPONSE_HEADERS_NAMES</a></li><li><a href=#response_protocol>RESPONSE_PROTOCOL</a></li><li><a href=#response_status>RESPONSE_STATUS</a></li><li><a href=#rule>RULE</a></li><li><a href=#server_addr>SERVER_ADDR</a></li><li><a href=#server_name>SERVER_NAME</a></li><li><a href=#server_port>SERVER_PORT</a></li><li><a href=#session>SESSION</a></li><li><a href=#sessionid>SESSIONID</a></li><li><a href=#status_line>STATUS_LINE</a></li><li><a href=#time>TIME</a></li><li><a href=#time_day>TIME_DAY</a></li><li><a href=#time_epoch>TIME_EPOCH</a></li><li><a href=#time_hour>TIME_HOUR</a></li><li><a href=#time_min>TIME_MIN</a></li><li><a href=#time_mon>TIME_MON</a></li><li><a href=#time_sec>TIME_SEC</a></li><li><a href=#time_wday>TIME_WDAY</a></li><li><a href=#time_year>TIME_YEAR</a></li><li><a href=#tx>TX</a></li><li><a href=#unique_id>UNIQUE_ID</a></li><li><a href=#urlencoded_error>URLENCODED_ERROR</a></li><li><a href=#userid>USERID</a></li><li><a href=#webappid>WEBAPPID</a></li><li><a href=#xml>XML</a></li></ul></nav></div></nav><h2 id=args>ARGS <a href=#args class=anchor aria-hidden=true>#</a></h2><p><strong>ARGS</strong> is a collection and can be used on its own (means all arguments including the POST Payload), with a static parameter (matches arguments with that name), or with a regular expression (matches all arguments with name that matches the regular expression). To look at only the query string or body arguments, see the ARGS_GET and ARGS_POST collections.</p><p>Some variables are actually collections, which are expanded into more variables at runtime. The following example will examine all request arguments:</p><pre><code>SecRule ARGS dirty &quot;id:7&quot;
</code></pre><p>Sometimes, however, you will want to look only at parts of a collection. This can be achieved with the help of the selection operator(colon). The following example will only look at the arguments named p (do note that, in general, requests can contain multiple arguments with the same name):</p><pre><code>SecRule ARGS:p dirty &quot;id:8&quot;
</code></pre><p>It is also possible to specify exclusions. The following will examine all request arguments for the word dirty, except the ones named z (again, there can be zero or more arguments named z):</p><pre><code>SecRule ARGS|!ARGS:z dirty &quot;id:9&quot;
</code></pre><p>There is a special operator that allows you to count how many variables there are in a collection. The following rule will trigger if there is more than zero arguments in the request (ignore the second parameter for the time being):</p><pre><code>SecRule &amp;ARGS !^0$ &quot;id:10&quot;
</code></pre><p>And sometimes you need to look at an array of parameters, each with a slightly different name. In this case you can specify a regular expression in the selection operator itself. The following rule will look into all arguments whose names begin with id_:</p><pre><code>SecRule ARGS:/^id_/ dirty &quot;id:11&quot;
</code></pre><p><strong>Note :</strong> Using <code>ARGS:p</code> will not result in any invocations against the operator if argument p does not exist.</p><h2 id=args_combined_size>ARGS_COMBINED_SIZE <a href=#args_combined_size class=anchor aria-hidden=true>#</a></h2><p>Contains the combined size of all request parameters. Files are excluded from the calculation. This variable can be useful, for example, to create a rule to ensure that the total size of the argument data is below a certain threshold. The following rule detects a request whose parameters are more than 2500 bytes long:</p><pre><code>SecRule ARGS_COMBINED_SIZE &quot;@gt 2500&quot; &quot;id:12&quot;
</code></pre><h2 id=args_get>ARGS_GET <a href=#args_get class=anchor aria-hidden=true>#</a></h2><p><strong>ARGS_GET</strong> is similar to ARGS, but contains only query string parameters.</p><h2 id=args_get_names>ARGS_GET_NAMES <a href=#args_get_names class=anchor aria-hidden=true>#</a></h2><p><strong>ARGS_GET_NAMES</strong> is similar to <strong>ARGS_NAMES</strong>, but contains only the names of query string parameters.</p><h2 id=args_names>ARGS_NAMES <a href=#args_names class=anchor aria-hidden=true>#</a></h2><p>Contains all request parameter names. You can search for specific parameter names that you want to inspect. In a positive policy scenario, you can also whitelist (using an inverted rule with the exclamation mark) only the authorized argument names. This example rule allows only two argument names: p and a:</p><pre><code>SecRule ARGS_NAMES &quot;!^(p|a)$&quot; &quot;id:13&quot;
</code></pre><h2 id=args_post>ARGS_POST <a href=#args_post class=anchor aria-hidden=true>#</a></h2><p><strong>ARGS_POST</strong> is similar to <strong>ARGS</strong>, but only contains arguments from the POST body.</p><h2 id=args_post_names>ARGS_POST_NAMES <a href=#args_post_names class=anchor aria-hidden=true>#</a></h2><p><strong>ARGS_POST_NAMES</strong> is similar to <strong>ARGS_NAMES</strong>, but contains only the names of request body parameters.</p><h2 id=auth_type>AUTH_TYPE <a href=#auth_type class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>This variable holds the authentication method used to validate a user, if any of the methods built into HTTP are used. In a reverse-proxy deployment, this information will not be available if the authentication is handled in the backend web server.</p><pre><code>SecRule AUTH_TYPE &quot;Basic&quot; &quot;id:14&quot;
</code></pre><h2 id=duration>DURATION <a href=#duration class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the number of microseconds elapsed since the beginning of the current transaction.</p><h2 id=env>ENV <a href=#env class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Collection that provides access to environment variables set by Coraza or other server modules. Requires a single parameter to specify the name of the desired variable.</p><pre><code># Set environment variable 
SecRule REQUEST_FILENAME &quot;printenv&quot; \
&quot;phase:2,id:15,pass,setenv:tag=suspicious&quot; 

# Inspect environment variable
SecRule ENV:tag &quot;suspicious&quot; &quot;id:16&quot;

# Reading an environment variable from other Apache module (mod_ssl)
SecRule TX:ANOMALY_SCORE &quot;@gt 0&quot; &quot;phase:5,id:16,msg:'%{env.ssl_cipher}'&quot;
</code></pre><p><strong>Note :</strong> Use setenv to set environment variables to be accessed by Apache.</p><h2 id=files>FILES <a href=#files class=anchor aria-hidden=true>#</a></h2><p>Contains a collection of original file names (as they were called on the remote userâ€™s filesys- tem). Available only on inspected multipart/form-data requests.</p><pre><code>SecRule FILES &quot;@rx \.conf$&quot; &quot;id:17&quot;
</code></pre><p><strong>Note :</strong> Only available if files were extracted from the request body.</p><h2 id=files_combined_size>FILES_COMBINED_SIZE <a href=#files_combined_size class=anchor aria-hidden=true>#</a></h2><p>Contains the total size of the files transported in request body. Available only on inspected multipart/form-data requests.</p><pre><code>SecRule FILES_COMBINED_SIZE &quot;@gt 100000&quot; &quot;id:18&quot;
</code></pre><h2 id=files_names>FILES_NAMES <a href=#files_names class=anchor aria-hidden=true>#</a></h2><p>Contains a list of form fields that were used for file upload. Available only on inspected multipart/form-data requests.</p><pre><code>SecRule FILES_NAMES &quot;^upfile$&quot; &quot;id:19&quot;
</code></pre><h2 id=full_request_length>FULL_REQUEST_LENGTH <a href=#full_request_length class=anchor aria-hidden=true>#</a></h2><p>Represents the amount of bytes that FULL_REQUEST may use.</p><pre><code>SecRule FULL_REQUEST_LENGTH &quot;@eq 205&quot; &quot;id:21&quot;
</code></pre><h2 id=files_sizes>FILES_SIZES <a href=#files_sizes class=anchor aria-hidden=true>#</a></h2><p>Contains a list of individual file sizes. Useful for implementing a size limitation on individual uploaded files. Available only on inspected multipart/form-data requests.</p><pre><code>SecRule FILES_SIZES &quot;@gt 100&quot; &quot;id:20&quot;
</code></pre><h2 id=files_tmpnames>FILES_TMPNAMES <a href=#files_tmpnames class=anchor aria-hidden=true>#</a></h2><p>Contains a list of temporary filesâ€™ names on the disk. Useful when used together with @inspectFile. Available only on inspected multipart/form-data requests.</p><pre><code>SecRule FILES_TMPNAMES &quot;@inspectFile /path/to/inspect_script.pl&quot; &quot;id:21&quot;
</code></pre><h2 id=files_tmp_content>FILES_TMP_CONTENT <a href=#files_tmp_content class=anchor aria-hidden=true>#</a></h2><p>Contains a key-value set where value is the content of the file which was uploaded. Useful when used together with @fuzzyHash.</p><pre><code>SecRule FILES_TMP_CONTENT &quot;@fuzzyHash $ENV{CONF_DIR}/ssdeep.txt 1&quot; &quot;id:192372,log,deny&quot;
</code></pre><p><strong>Note :</strong> SecUploadKeepFiles should be set to &lsquo;On&rsquo; in order to have this collection filled.</p><h2 id=geo>GEO <a href=#geo class=anchor aria-hidden=true>#</a></h2><p>GEO is a collection populated by the results of the last @geoLookup operator. The collection can be used to match geographical fields looked from an IP address or hostname.</p><p>Fields:</p><ul><li><strong>COUNTRY_CODE:</strong> Two character country code. EX: US, CL, GB, etc.</li><li><strong>COUNTRY_CODE3:</strong> Up to three character country code.</li><li><strong>COUNTRY_NAME:</strong> The full country name.</li><li><strong>COUNTRY_CONTINENT:</strong> The two character continent that the country is located. EX: EU</li><li><strong>REGION:</strong> The two character region. For US, this is state. For Chile, region, etc.</li><li><strong>CITY:</strong> The city name if supported by the database.</li><li><strong>POSTAL_CODE:</strong> The postal code if supported by the database.</li><li><strong>LATITUDE:</strong> The latitude if supported by the database.</li><li><strong>LONGITUDE:</strong> The longitude if supported by the database.</li></ul><p><strong>Example:</strong></p><pre><code>SecGeoLookupDb maxminddb file=/usr/local/geo/data/GeoLiteCity.dat
...
SecRule REMOTE_ADDR &quot;@geoLookup&quot; &quot;chain,id:22,drop,msg:'Non-GB IP address'&quot;
SecRule GEO:COUNTRY_CODE &quot;!@streq GB&quot;
</code></pre><h2 id=highest_severity>HIGHEST_SEVERITY <a href=#highest_severity class=anchor aria-hidden=true>#</a></h2><p>This variable holds the highest severity of any rules that have matched so far. Severities are numeric values and thus can be used with comparison operators such as @lt, and so on. A value of 255 indicates that no severity has been set.</p><pre><code>SecRule HIGHEST_SEVERITY &quot;@le 2&quot; &quot;phase:2,id:23,deny,status:500,msg:'severity %{HIGHEST_SEVERITY}'&quot;
</code></pre><p><strong>Note :</strong> Higher severities have a lower numeric value.</p><h2 id=inbound_data_error>INBOUND_DATA_ERROR <a href=#inbound_data_error class=anchor aria-hidden=true>#</a></h2><p>This variable will be set to 1 when the request body size is above the setting configured by <strong>SecRequestBodyLimit</strong> directive. Your policies should always contain a rule to check this variable. Depending on the rate of false positives and your default policy you should decide whether to block or just warn when the rule is triggered.</p><p>The best way to use this variable is as in the example below:</p><pre><code>SecRule INBOUND_DATA_ERROR &quot;@eq 1&quot; &quot;phase:1,id:24,t:none,log,pass,msg:'Request Body Larger than SecRequestBodyLimit Setting'&quot;
</code></pre><h2 id=matched_var>MATCHED_VAR <a href=#matched_var class=anchor aria-hidden=true>#</a></h2><p>This variable holds the value of the most-recently matched variable. It is similar to the TX:0, but it is automatically supported by all operators and there is no need to specify the capture action.</p><pre><code>SecRule ARGS pattern chain,deny,id:25
  SecRule MATCHED_VAR &quot;further scrutiny&quot;
</code></pre><p><strong>Note :</strong> Be aware that this variable holds data for the last operator match. This means that if there are more than one matches, only the last one will be populated. Use MATCHED_VARS variable if you want all matches.</p><h2 id=matched_vars>MATCHED_VARS <a href=#matched_vars class=anchor aria-hidden=true>#</a></h2><p>Similar to <strong>MATCHED_VAR</strong> except that it is a collection of all matches for the current operator check.</p><pre><code>SecRule ARGS pattern &quot;chain,deny,id:26&quot;
  SecRule MATCHED_VARS &quot;@eq ARGS:param&quot;
</code></pre><h2 id=matched_var_name>MATCHED_VAR_NAME <a href=#matched_var_name class=anchor aria-hidden=true>#</a></h2><p>This variable holds the full name of the variable that was matched against.</p><pre><code>SecRule ARGS pattern &quot;chain,deny,id:27&quot;
  SecRule MATCHED_VAR_NAME &quot;@eq ARGS:param&quot;
</code></pre><p><strong>Note :</strong> Be aware that this variable holds data for the last operator match. This means that if there are more than one matches, only the last one will be populated. Use MATCHED_VARS_NAMES variable if you want all matches.</p><h2 id=matched_vars_names>MATCHED_VARS_NAMES <a href=#matched_vars_names class=anchor aria-hidden=true>#</a></h2><p>Similar to MATCHED_VAR_NAME except that it is a collection of all matches for the current operator check.</p><pre><code>SecRule ARGS pattern &quot;chain,deny,id:28&quot;
  SecRule MATCHED_VARS_NAMES &quot;@eq ARGS:param&quot;
</code></pre><h2 id=multipart_filename>MULTIPART_FILENAME <a href=#multipart_filename class=anchor aria-hidden=true>#</a></h2><p>This variable contains the multipart data from field FILENAME.</p><h2 id=multipart_name>MULTIPART_NAME <a href=#multipart_name class=anchor aria-hidden=true>#</a></h2><p>This variable contains the multipart data from field NAME.</p><h2 id=outbound_data_error>OUTBOUND_DATA_ERROR <a href=#outbound_data_error class=anchor aria-hidden=true>#</a></h2><p>This variable will be set to 1 when the response body size is above the setting configured by SecResponseBodyLimit directive. Your policies should always contain a rule to check this variable. Depending on the rate of false positives and your default policy you should decide whether to block or just warn when the rule is triggered.</p><p>The best way to use this variable is as in the example below:</p><pre><code>SecRule OUTBOUND_DATA_ERROR &quot;@eq 1&quot; &quot;phase:1,id:32,t:none,log,pass,msg:'Response Body Larger than SecResponseBodyLimit Setting'&quot;
</code></pre><h2 id=path_info>PATH_INFO <a href=#path_info class=anchor aria-hidden=true>#</a></h2><p>Contains the extra request URI information, also known as path info. (For example, in the URI /index.php/123, /123 is the path info.) Available only in embedded deployments.</p><pre><code>SecRule PATH_INFO &quot;^/(bin|etc|sbin|opt|usr)&quot; &quot;id:33&quot;
</code></pre><h2 id=perf_all>PERF_ALL <a href=#perf_all class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>This special variable contains a string thatâ€™s a combination of all other performance variables, arranged in the same order in which they appear in the Stopwatch2 audit log header. Itâ€™s intended for use in custom Apache logs</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_combined>PERF_COMBINED <a href=#perf_combined class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent in Coraza during the current transaction. The value in this variable is arrived to by adding all the performance variables except PERF_SREAD (the time spent reading from persistent storage is already included in the phase measurements).</p><p><strong>Supported on Coraza:</strong> TBI</p><p>PERF_GC
Contains the time, in microseconds, spent performing garbage collection.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_logging>PERF_LOGGING <a href=#perf_logging class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent in audit logging. This value is known only after the handling of a transaction is finalized, which means that it can only be logged using mod_log_config and the %{VARNAME}M syntax.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_phase1>PERF_PHASE1 <a href=#perf_phase1 class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent processing phase 1.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_phase2>PERF_PHASE2 <a href=#perf_phase2 class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent processing phase 2.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_phase3>PERF_PHASE3 <a href=#perf_phase3 class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent processing phase 3.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_phase4>PERF_PHASE4 <a href=#perf_phase4 class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent processing phase 4.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_phase5>PERF_PHASE5 <a href=#perf_phase5 class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent processing phase 5.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_rules>PERF_RULES <a href=#perf_rules class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>PERF_RULES is a collection, that is populated with the rules hitting the performance threshold defined with SecRulePerfTime. The collection contains the time, in microseconds, spent processing the individual rule. The various items in the collection can be accessed via the rule id.</p><p>Supported on Coraza: TBI</p><pre><code>SecRulePerfTime            100

SecRule FILES_TMPNAMES &quot;@inspectFile /path/to/util/runav.pl&quot; \
  &quot;phase:2,id:10001,deny,log,msg:'Virus scan detected an error.'&quot;

SecRule   &amp;PERF_RULES &quot;@eq 0&quot;    &quot;phase:5,id:95000,\
  pass,log,msg:'All rules performed below processing time limit.'&quot;
SecRule   PERF_RULES  &quot;@ge 1000&quot; &quot;phase:5,id:95001,pass,log,\
  msg:'Rule %{MATCHED_VAR_NAME} spent at least 1000 usec.'&quot;
SecAction &quot;phase:5,id:95002,pass,log, msg:'File inspection took %{PERF_RULES.10001} usec.'&quot;
</code></pre><p>The rule with id 10001 defines an external file inspection rule. The rule with id 95000 checks the size of the PERF_RULES collection. If the collection is empty, it writes a note in the logfile. Rule 95001 is executed for every item in the PERF_RULES collection. Every item is thus being checked against the limit of 1000 microseconds. If the rule spent at least that amount of time, then a note containing the rule id is being written to the logfile. The final rule 95002 notes the time spent in rule 10001 (the virus inspection).</p><h2 id=perf_sread>PERF_SREAD <a href=#perf_sread class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent reading from persistent storage.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=perf_swrite>PERF_SWRITE <a href=#perf_swrite class=anchor aria-hidden=true>#</a></h2><p><strong>Not Implemented yet</strong></p><p>Contains the time, in microseconds, spent writing to persistent storage.</p><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=query_string>QUERY_STRING <a href=#query_string class=anchor aria-hidden=true>#</a></h2><p>Contains the query string part of a request URI. The value in QUERY_STRING is always provided raw, without URL decoding taking place.</p><pre><code>SecRule QUERY_STRING &quot;attack&quot; &quot;id:34&quot;
</code></pre><h2 id=remote_addr>REMOTE_ADDR <a href=#remote_addr class=anchor aria-hidden=true>#</a></h2><p>This variable holds the IP address of the remote client.</p><pre><code>SecRule REMOTE_ADDR &quot;@ipMatch 192.168.1.101&quot; &quot;id:35&quot;
</code></pre><h2 id=remote_host>REMOTE_HOST <a href=#remote_host class=anchor aria-hidden=true>#</a></h2><p>If the Apache directive HostnameLookups is set to On, then this variable will hold the remote hostname resolved through DNS. If the directive is set to Off, this variable it will hold the remote IP address (same as REMOTE_ADDR). Possible uses for this variable would be to deny known bad client hosts or network blocks, or conversely, to allow in authorized hosts.</p><pre><code>SecRule REMOTE_HOST &quot;\.evil\.network\org$&quot; &quot;id:36&quot;
</code></pre><h2 id=remote_port>REMOTE_PORT <a href=#remote_port class=anchor aria-hidden=true>#</a></h2><p>This variable holds information on the source port that the client used when initiating the connection to our web server.</p><p>In the following example, we are evaluating to see whether the REMOTE_PORT is less than 1024, which would indicate that the user is a privileged user:</p><pre><code>SecRule REMOTE_PORT &quot;@lt 1024&quot; &quot;id:37&quot;
</code></pre><h2 id=remote_user>REMOTE_USER <a href=#remote_user class=anchor aria-hidden=true>#</a></h2><p>This variable holds the username of the authenticated user. If there are no password access controls in place (Basic or Digest authentication), then this variable will be empty.</p><pre><code>SecRule REMOTE_USER &quot;@streq admin&quot; &quot;id:38&quot;
</code></pre><p><strong>Note :</strong> In a reverse-proxy deployment, this information will not be available if the authentication is handled in the backend web server.</p><h2 id=reqbody_error>REQBODY_ERROR <a href=#reqbody_error class=anchor aria-hidden=true>#</a></h2><p>Contains the status of the request body processor used for request body parsing. The values can be 0 (no error) or 1 (error). This variable will be set by request body processors (typically the multipart/request-data parser, JSON or the XML parser) when they fail to do their work.</p><pre><code>SecRule REQBODY_ERROR &quot;@eq 1&quot; deny,phase:2,id:39
</code></pre><p><strong>Note :</strong> Your policies must have a rule to check for request body processor errors at the very beginning of phase 2. Failure to do so will leave the door open for impedance mismatch attacks. It is possible, for example, that a payload that cannot be parsed by Coraza can be successfully parsed by more tolerant parser operating in the application. If your policy dictates blocking, then you should reject the request if error is detected. When operating in detection-only mode, your rule should alert with high severity when request body processing fails.</p><h2 id=reqbody_error_msg>REQBODY_ERROR_MSG <a href=#reqbody_error_msg class=anchor aria-hidden=true>#</a></h2><p>If thereâ€™s been an error during request body parsing, the variable will contain the following error message:</p><pre><code>SecRule REQBODY_ERROR_MSG &quot;failed to parse&quot; &quot;id:40&quot;
</code></pre><h2 id=reqbody_processor>REQBODY_PROCESSOR <a href=#reqbody_processor class=anchor aria-hidden=true>#</a></h2><p>Contains the name of the currently used request body processor. The possible values are URLENCODED, JSON, MULTIPART, and XML.</p><pre><code>SecRule REQBODY_PROCESSOR &quot;^XML$ chain,id:41 
  SecRule XML://* &quot;something&quot; &quot;id:123&quot;
</code></pre><h2 id=request_basename>REQUEST_BASENAME <a href=#request_basename class=anchor aria-hidden=true>#</a></h2><p>This variable holds just the filename part of REQUEST_FILENAME (e.g., index.php).</p><pre><code>SecRule REQUEST_BASENAME &quot;^login\.php$&quot; phase:2,id:42,t:none,t:lowercase
</code></pre><p><strong>Note :</strong> Please note that anti-evasion transformations are not applied to this variable by default. REQUEST_BASENAME will recognize both / and \ as path separators. You should understand that the value of this variable depends on what was provided in request, and that it does not have to correspond to the resource (on disk) that will be used by the web server.</p><h2 id=request_body>REQUEST_BODY <a href=#request_body class=anchor aria-hidden=true>#</a></h2><p>Holds the raw request body. This variable is available only if the URLENCODED request body processor was used, which will occur by default when the application/x-www-form-urlencoded content type is detected, or if the use of the URLENCODED request body parser was forced.</p><pre><code>SecRule REQUEST_BODY &quot;^username=\w{25,}\&amp;password=\w{25,}\&amp;Submit\=login$&quot; &quot;id:43&quot;
</code></pre><p>It is possible to force the presence of the REQUEST_BODY variable, but only when there is no request body processor defined using the <code>ctl:forceRequestBodyVariable</code> option in the REQUEST_HEADERS phase.</p><h2 id=request_body_length>REQUEST_BODY_LENGTH <a href=#request_body_length class=anchor aria-hidden=true>#</a></h2><p>Contains the number of bytes read from a request body.</p><h2 id=request_cookies>REQUEST_COOKIES <a href=#request_cookies class=anchor aria-hidden=true>#</a></h2><p>This variable is a collection of all of request cookies (values only). Example: the following example is using the Ampersand special operator to count how many variables are in the collection. In this rule, it would trigger if the request does not include any Cookie headers.</p><pre><code>SecRule &amp;REQUEST_COOKIES &quot;@eq 0&quot; &quot;id:44&quot;
</code></pre><h2 id=request_cookies_names>REQUEST_COOKIES_NAMES <a href=#request_cookies_names class=anchor aria-hidden=true>#</a></h2><p>This variable is a collection of the names of all request cookies. For example, the following rule will trigger if the JSESSIONID cookie is not present:</p><pre><code>SecRule &amp;REQUEST_COOKIES_NAMES:JSESSIONID &quot;@eq 0&quot; &quot;id:45&quot;
</code></pre><h2 id=request_filename>REQUEST_FILENAME <a href=#request_filename class=anchor aria-hidden=true>#</a></h2><p>This variable holds the relative request URL without the query string part (e.g., /index.php).</p><pre><code>SecRule REQUEST_FILENAME &quot;^/cgi-bin/login\.php$&quot; phase:2,id:46,t:none,t:normalizePath
</code></pre><p><strong>Note :</strong> Please note that anti-evasion transformations are not used on REQUEST_FILENAME, which means that you will have to specify them in the rules that use this variable.</p><h2 id=request_headers>REQUEST_HEADERS <a href=#request_headers class=anchor aria-hidden=true>#</a></h2><p>This variable can be used as either a collection of all of the request headers or can be used to inspect selected headers (by using the REQUEST_HEADERS:Header-Name syntax).</p><pre><code>SecRule REQUEST_HEADERS:Host &quot;^[\d\.]+$&quot; &quot;deny,id:47,log,status:400,msg:'Host header is a numeric IP address'&quot;
</code></pre><p><strong>Note:</strong> Coraza will treat multiple headers that have identical names as a &ldquo;list&rdquo;, processing each single value.</p><h2 id=request_headers_names>REQUEST_HEADERS_NAMES <a href=#request_headers_names class=anchor aria-hidden=true>#</a></h2><p>This variable is a collection of the names of all of the request headers.</p><pre><code>SecRule REQUEST_HEADERS_NAMES &quot;^x-forwarded-for&quot; &quot;log,deny,id:48,status:403,t:lowercase,msg:'Proxy Server Used'&quot;
</code></pre><h2 id=request_line>REQUEST_LINE <a href=#request_line class=anchor aria-hidden=true>#</a></h2><p>This variable holds the complete request line sent to the server (including the request method and HTTP version information).</p><pre><code># Allow only POST, GET and HEAD request methods, as well as only
# the valid protocol versions 
SecRule REQUEST_LINE &quot;!(^((?:(?:POS|GE)T|HEAD))|HTTP/(0\.9|1\.0|1\.1)$)&quot; &quot;phase:1,id:49,log,block,t:none&quot;
</code></pre><h2 id=request_method>REQUEST_METHOD <a href=#request_method class=anchor aria-hidden=true>#</a></h2><p>This variable holds the request method used in the transaction.</p><pre><code>SecRule REQUEST_METHOD &quot;^(?:CONNECT|TRACE)$&quot; &quot;id:50,t:none&quot;
</code></pre><h2 id=request_protocol>REQUEST_PROTOCOL <a href=#request_protocol class=anchor aria-hidden=true>#</a></h2><p>This variable holds the request protocol version information.</p><pre><code>SecRule REQUEST_PROTOCOL &quot;!^HTTP/(0\.9|1\.0|1\.1)$&quot; &quot;id:51&quot;
</code></pre><p>##Â REQUEST_URI</p><p>This variable holds the full request URL including the query string data (e.g., /index.php? p=X). However, it will never contain a domain name, even if it was provided on the request line.</p><pre><code>SecRule REQUEST_URI &quot;attack&quot; &quot;phase:1,id:52,t:none,t:urlDecode,t:lowercase,t:normalizePath&quot;
</code></pre><p><strong>Note :</strong> Please note that anti-evasion transformations are not used on REQUEST_URI, which means that you will have to specify them in the rules that use this variable.</p><h2 id=request_uri_raw>REQUEST_URI_RAW <a href=#request_uri_raw class=anchor aria-hidden=true>#</a></h2><p>Same as REQUEST_URI but will contain the domain name if it was provided on the request line (e.g., http://www.example.com/index.php?p=X).</p><pre><code>SecRule REQUEST_URI_RAW &quot;http:/&quot; &quot;phase:1,id:53,t:none,t:urlDecode,t:lowercase,t:normalizePath&quot;
</code></pre><p><strong>Note :</strong> Please note that anti-evasion transformations are not used on REQUEST_URI_RAW, which means that you will have to specify them in the rules that use this variable.</p><h2 id=response_body>RESPONSE_BODY <a href=#response_body class=anchor aria-hidden=true>#</a></h2><p>This variable holds the data for the response body, but only when response body buffering is enabled.</p><pre><code>SecRule RESPONSE_BODY &quot;ODBC Error Code&quot; &quot;phase:4,id:54,t:none&quot;
</code></pre><h2 id=response_content_length>RESPONSE_CONTENT_LENGTH <a href=#response_content_length class=anchor aria-hidden=true>#</a></h2><p>Response body length in bytes. Can be available starting with phase 3, but it does not have to be (as the length of response body is not always known in advance). If the size is not known, this variable will contain a zero. If RESPONSE_CONTENT_LENGTH contains a zero in phase 5 that means the actual size of the response body was 0. The value of this variable can change between phases if the body is modified. For example, in embedded mode, mod_deflate can compress the response body between phases 4 and 5.</p><h2 id=response_content_type>RESPONSE_CONTENT_TYPE <a href=#response_content_type class=anchor aria-hidden=true>#</a></h2><p>Response content type. Available only starting with phase 3. The value available in this variable is taken directly from the internal structures of Apache, which means that it may contain the information that is not yet available in response headers. In embedded deployments, you should always refer to this variable, rather than to RESPONSE_HEADERS:Content-Type.</p><h2 id=response_headers>RESPONSE_HEADERS <a href=#response_headers class=anchor aria-hidden=true>#</a></h2><p>This variable refers to response headers, in the same way as REQUEST_HEADERS does to request headers.</p><pre><code>SecRule RESPONSE_HEADERS:X-Cache &quot;MISS&quot; &quot;id:55&quot;
</code></pre><p>This variable may not have access to some headers when running in embedded mode. Headers such as Server, Date, Connection, and Content-Type could be added just prior to sending the data to the client. This data should be available in phase 5 or when deployed in proxy mode.</p><h2 id=response_headers_names>RESPONSE_HEADERS_NAMES <a href=#response_headers_names class=anchor aria-hidden=true>#</a></h2><p>This variable is a collection of the response header names.</p><pre><code>SecRule RESPONSE_HEADERS_NAMES &quot;Set-Cookie&quot; &quot;phase:3,id:56,t:none&quot;
</code></pre><p>The same limitations apply as the ones discussed in RESPONSE_HEADERS.</p><h2 id=response_protocol>RESPONSE_PROTOCOL <a href=#response_protocol class=anchor aria-hidden=true>#</a></h2><p>This variable holds the HTTP response protocol information.</p><pre><code>SecRule RESPONSE_PROTOCOL &quot;^HTTP\/0\.9&quot; &quot;phase:3,id:57,t:none&quot;
</code></pre><h2 id=response_status>RESPONSE_STATUS <a href=#response_status class=anchor aria-hidden=true>#</a></h2><p>This variable holds the HTTP response status code:</p><pre><code>SecRule RESPONSE_STATUS &quot;^[45]&quot; &quot;phase:3,id:58,t:none&quot;
</code></pre><p>This variable may not work as expected, as some implementations might change the status before releasing the output buffers.</p><h2 id=rule>RULE <a href=#rule class=anchor aria-hidden=true>#</a></h2><p>This is a special collection that provides access to the id, rev, severity, logdata, and msg fields of the rule that triggered the action. It can be used to refer to only the same rule in which it resides.</p><pre><code>SecRule &amp;REQUEST_HEADERS:Host &quot;@eq 0&quot; &quot;log,deny,id:59,setvar:tx.varname=%{RULE.id}&quot;
</code></pre><h2 id=server_addr>SERVER_ADDR <a href=#server_addr class=anchor aria-hidden=true>#</a></h2><p>This variable contains the IP address of the server.</p><pre><code>SecRule SERVER_ADDR &quot;@ipMatch 192.168.1.100&quot; &quot;id:67&quot;
</code></pre><h2 id=server_name>SERVER_NAME <a href=#server_name class=anchor aria-hidden=true>#</a></h2><p>This variable contains the transactionâ€™s hostname or IP address, taken from the request itself (which means that, in principle, it should not be trusted).</p><pre><code>SecRule SERVER_NAME &quot;hostname\.com$&quot; &quot;id:68&quot;
</code></pre><h2 id=server_port>SERVER_PORT <a href=#server_port class=anchor aria-hidden=true>#</a></h2><p>This variable contains the local port that the web server (or reverse proxy) is listening on.</p><pre><code>SecRule SERVER_PORT &quot;^80$&quot; &quot;id:69&quot;
</code></pre><h2 id=session>SESSION <a href=#session class=anchor aria-hidden=true>#</a></h2><p>This variable is a collection that contains session information. It becomes available only after setsid is executed.</p><p>The following example shows how to initialize SESSION using setsid, how to use setvar to increase the SESSION.score values, how to set the SESSION.blocked variable, and finally, how to deny the connection based on the SESSION:blocked value:</p><pre><code># Initialize session storage 
SecRule REQUEST_COOKIES:PHPSESSID !^$ &quot;phase:2,id:70,nolog,pass,setsid:%{REQUEST_COOKIES.PHPSESSID}&quot;

# Increment session score on attack 
SecRule REQUEST_URI &quot;^/cgi-bin/finger$&quot; &quot;phase:2,id:71,t:none,t:lowercase,t:normalizePath,pass,setvar:SESSION.score=+10&quot; 

# Detect too many attacks in a session
SecRule SESSION:score &quot;@gt 50&quot; &quot;phase:2,id:72,pass,setvar:SESSION.blocked=1&quot;

# Enforce session block 
SecRule SESSION:blocked &quot;@eq 1&quot; &quot;phase:2,id:73,deny,status:403&quot;
</code></pre><h2 id=sessionid>SESSIONID <a href=#sessionid class=anchor aria-hidden=true>#</a></h2><p>This variable contains the value set with setsid. See SESSION (above) for a complete example.</p><h2 id=status_line>STATUS_LINE <a href=#status_line class=anchor aria-hidden=true>#</a></h2><p>This variable holds the full status line sent by the server (including the request method and HTTP version information).</p><pre><code># Generate an alert when the application generates 500 errors.
SecRule STATUS_LINE &quot;@contains 500&quot; &quot;phase:3,id:49,log,pass,logdata:'Application error detected!,t:none&quot;
Version: 2.x
</code></pre><p><strong>Supported on Coraza:</strong> TBI</p><h2 id=time>TIME <a href=#time class=anchor aria-hidden=true>#</a></h2><p>This variable holds a formatted string representing the time (hour:minute:second).</p><pre><code>SecRule TIME &quot;^(([1](8|9))|([2](0|1|2|3))):\d{2}:\d{2}$&quot; &quot;id:74&quot;
</code></pre><h2 id=time_day>TIME_DAY <a href=#time_day class=anchor aria-hidden=true>#</a></h2><p>This variable holds the current date (1â€“31). The following rule triggers on a transaction thatâ€™s happening anytime between the 10th and 20th in a month:</p><pre><code>SecRule TIME_DAY &quot;^(([1](0|1|2|3|4|5|6|7|8|9))|20)$&quot; &quot;id:75&quot;
</code></pre><h2 id=time_epoch>TIME_EPOCH <a href=#time_epoch class=anchor aria-hidden=true>#</a></h2><p>This variable holds the time in seconds since 1970.</p><h2 id=time_hour>TIME_HOUR <a href=#time_hour class=anchor aria-hidden=true>#</a></h2><p>This variable holds the current hour value (0â€“23). The following rule triggers when a request is made â€œoff hoursâ€:</p><pre><code>SecRule TIME_HOUR &quot;^(0|1|2|3|4|5|6|[1](8|9)|[2](0|1|2|3))$&quot; &quot;id:76&quot;
</code></pre><h2 id=time_min>TIME_MIN <a href=#time_min class=anchor aria-hidden=true>#</a></h2><p>This variable holds the current minute value (0â€“59). The following rule triggers during the last half hour of every hour:</p><pre><code>SecRule TIME_MIN &quot;^(3|4|5)&quot; &quot;id:77&quot;
</code></pre><h2 id=time_mon>TIME_MON <a href=#time_mon class=anchor aria-hidden=true>#</a></h2><p>This variable holds the current month value (0â€“11). The following rule matches if the month is either November (value 10) or December (value 11):</p><pre><code>SecRule TIME_MON &quot;^1&quot; &quot;id:78&quot;
</code></pre><h2 id=time_sec>TIME_SEC <a href=#time_sec class=anchor aria-hidden=true>#</a></h2><p>This variable holds the current second value (0â€“59).</p><p><strong>Supported:</strong> TBI</p><pre><code>SecRule TIME_SEC &quot;@gt 30&quot; &quot;id:79&quot;
</code></pre><h2 id=time_wday>TIME_WDAY <a href=#time_wday class=anchor aria-hidden=true>#</a></h2><p>This variable holds the current weekday value (0â€“6). The following rule triggers only on Satur- day and Sunday:</p><p><strong>Supported:</strong> TBI</p><pre><code>SecRule TIME_WDAY &quot;^(0|6)$&quot; &quot;id:80&quot;
</code></pre><h2 id=time_year>TIME_YEAR <a href=#time_year class=anchor aria-hidden=true>#</a></h2><p>This variable holds the current four-digit year value.</p><p><strong>Supported:</strong> TBI</p><pre><code>SecRule TIME_YEAR &quot;^2006$&quot; &quot;id:81&quot;
</code></pre><h2 id=tx>TX <a href=#tx class=anchor aria-hidden=true>#</a></h2><p>This is the transient transaction collection, which is used to store pieces of data, create a transaction anomaly score, and so on. The variables placed into this collection are available only until the transaction is complete.</p><pre><code># Increment transaction attack score on attack 
SecRule ARGS attack &quot;phase:2,id:82,nolog,pass,setvar:TX.score=+5&quot;

# Block the transactions whose scores are too high 
SecRule TX:SCORE &quot;@gt 20&quot; &quot;phase:2,id:83,log,deny&quot;
</code></pre><p>Some variable names in the TX collection are reserved and cannot be used:</p><ul><li><strong>TX:0:</strong> the matching value when using the @rx or @pm operator with the capture action</li><li><strong>TX:1-TX:9:</strong> the captured subexpression value when using the @rx operator with capturing parens and the capture action</li></ul><h2 id=unique_id>UNIQUE_ID <a href=#unique_id class=anchor aria-hidden=true>#</a></h2><p>This variable holds the unique id for the transaction.</p><h2 id=urlencoded_error>URLENCODED_ERROR <a href=#urlencoded_error class=anchor aria-hidden=true>#</a></h2><p>This variable is created when an invalid URL encoding is encountered during the parsing of a query string (on every request) or during the parsing of an application/x-www-form-urlencoded request body (only on the requests that use the URLENCODED request body processor).</p><h2 id=userid>USERID <a href=#userid class=anchor aria-hidden=true>#</a></h2><p>This variable contains the value set with setuid.</p><p><strong>Supported:</strong> TBI</p><pre><code># Initialize user tracking
SecAction &quot;nolog,id:84,pass,setuid:%{REMOTE_USER}&quot; 

# Is the current user the administrator?
SecRule USERID &quot;admin&quot; &quot;id:85&quot;
</code></pre><h2 id=webappid>WEBAPPID <a href=#webappid class=anchor aria-hidden=true>#</a></h2><p>This variable contains the current application name, which is set in configuration using SecWebAppId.</p><p><strong>Supported:</strong> TBI</p><h2 id=xml>XML <a href=#xml class=anchor aria-hidden=true>#</a></h2><p>Special collection used to interact with the XML parser. It must contain a valid XPath expression, which will then be evaluated against a previously parsed XML DOM tree.</p><pre><code>SecDefaultAction log,deny,status:403,phase:2,id:90
SecRule REQUEST_HEADERS:Content-Type ^text/xml$ &quot;phase:1,id:87,t:lowercase,nolog,pass,ctl:requestBodyProcessor=XML&quot;
SecRule REQBODY_PROCESSOR &quot;!^XML$&quot; skipAfter:12345,id:88
</code></pre><p>It would match against payload such as this one:</p><pre><code class=language-xml>&lt;employees&gt;
    &lt;employee&gt;
        &lt;name&gt;Fred Jones&lt;/name&gt;
        &lt;address location=&quot;home&quot;&gt;
            &lt;street&gt;900 Aurora Ave.&lt;/street&gt;
            &lt;city&gt;Seattle&lt;/city&gt;
            &lt;state&gt;WA&lt;/state&gt;
            &lt;zip&gt;98115&lt;/zip&gt;
        &lt;/address&gt;
        &lt;address location=&quot;work&quot;&gt;
            &lt;street&gt;2011 152nd Avenue NE&lt;/street&gt;
            &lt;city&gt;Redmond&lt;/city&gt;
            &lt;state&gt;WA&lt;/state&gt;
            &lt;zip&gt;98052&lt;/zip&gt;
        &lt;/address&gt;
        &lt;phone location=&quot;work&quot;&gt;(425)555-5665&lt;/phone&gt;
        &lt;phone location=&quot;home&quot;&gt;(206)555-5555&lt;/phone&gt;
        &lt;phone location=&quot;mobile&quot;&gt;(206)555-4321&lt;/phone&gt;
    &lt;/employee&gt;
&lt;/employees&gt;
</code></pre><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/seclang/variables.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/seclang/transformations/><div class="card my-1"><div class="card-body py-2">&larr; Transformations</div></div></a><a class=ms-auto href=https://coraza.io/docs/tutorials/quick-start/><div class="card my-1"><div class="card-body py-2">Quick Start &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love â¤ï¸ (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.44fc78ffe68ed681865871fdec9750ca44c6febe429bf0779d114896edde0f92b92891b983ef933484a02a2c7ceb3d1fa6392c39179350ad04197a153a2db970.js integrity="sha512-RPx4/+aO1oGGWHH97JdQykTG/r5Cm/B3nRFIlu3eD5K5KJG5g++TNISgKix86z0fpjksOReTUK0EGXoVOi25cA==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.c9d0abf1faee2c9fb9a4eaba4ddedf4610c75b2da5cc2790026b9c15153fc0568a6243ea859b5902d1be97cfa417007b0b45a2b2a2c81616fc5f6695e92486ec.js integrity="sha512-ydCr8fruLJ+5pOq6Td7fRhDHWy2lzCeQAmucFRU/wFaKYkPqhZtZAtG+l8+kFwB7C0WisqLIFhb8X2aV6SSG7A==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.f30a958e6d2d4cbc943428cc3c449d908f6fb4e6efedc9c8496db90722172b37b93864ed525147095926576dd5a53a8c0565d9e7bf9cf786e3676f0e90a2a353.js integrity="sha512-8wqVjm0tTLyUNCjMPESdkI9vtObv7cnISW25ByIXKze5OGTtUlFHCVkmV23VpTqMBWXZ57+c94bjZ28OkKKjUw==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.94c0d4b77cc139641b6184e39cfbcd36b6465fea56cdb4c62d4e1a989a940d289f28c09ba1ed1a47ef53cb9140f184f2e34fbf0c167aa65844f1b2beccb7288e.js integrity="sha512-lMDUt3zBOWQbYYTjnPvNNrZGX+pWzbTGLU4amJqUDSifKMCboe0aR+9Ty5FA8YTy40+/DBZ6plhE8bK+zLcojg==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>