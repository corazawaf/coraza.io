<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(e){/^global-alert-/.test(e)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://coraza.io/main.08040bc4f930cbd11ade8cde0f20f30f51874e67e12c205ee34b2bc8e27b935fc1403e5dc7e89fd73be9a140225ede53f8b469ee6bb84eebbc32c3bba1982c1f.css integrity="sha512-CAQLxPkwy9Ea3ozeDyDzD1GHTmfhLCBe40sryOJ7k1/BQD5dx+if1zvpoUAiXt5T+LRp7mu4Tuu8MsO7oZgsHw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Transformations - OWASP Coraza</title><meta name=description content="Transformation functions are used to alter input data before it is used in matching."><link rel=canonical href=https://coraza.io/docs/seclang/transformations/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Transformations"><meta property="og:description" content="Transformation functions are used to alter input data before it is used in matching."><meta property="og:url" content="https://coraza.io/docs/seclang/transformations/"><meta property="og:site_name" content="OWASP Coraza"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Transformations"><meta name=twitter:description content="Transformation functions are used to alter input data before it is used in matching."><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Transformations"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/transformations/","url":"https://coraza.io/docs/seclang/transformations/","name":"Transformations","description":"Transformation functions are used to alter input data before it is used in matching.","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/transformations/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/transformations/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/transformations/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/transformations/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/transformations/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Transformations","description":"Transformation functions are used to alter input data before it is used in matching.","isPartOf":{"@id":"https://coraza.io/docs/seclang/transformations/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/transformations/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/transformations/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso and Coraza contributors","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/transformations/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Transformations"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div id=announcement data-id=global-alert-c965de2304062d13ca89378ac0b47df7 class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>Coraza v3 <a class=alert-link href=https://github.com/corazawaf/coraza/releases>available here!</a>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#base64decode>base64Decode</a></li><li><a href=#base64decodeext>base64DecodeExt</a></li><li><a href=#base64encode>base64Encode</a></li><li><a href=#cmdline>cmdLine</a></li><li><a href=#compresswhitespace>compressWhitespace</a></li><li><a href=#cssdecode>cssDecode</a></li><li><a href=#escapeseqdecode>escapeSeqDecode</a></li><li><a href=#hexdecode>hexDecode</a></li><li><a href=#hexencode>hexEncode</a></li><li><a href=#htmlentitydecode>htmlEntityDecode</a></li><li><a href=#jsdecode>jsDecode</a></li><li><a href=#length>length</a></li><li><a href=#lowercase>lowercase</a></li><li><a href=#md5>md5</a></li><li><a href=#none>none</a></li><li><a href=#normalizepath>normalizePath</a></li><li><a href=#normalizepathwin>normalizePathWin</a></li><li><a href=#parityeven7bit>parityEven7bit</a></li><li><a href=#parityodd7bit>parityOdd7bit</a></li><li><a href=#parityzero7bit>parityZero7bit</a></li><li><a href=#removenulls>removeNulls</a></li><li><a href=#removewhitespace>removeWhitespace</a></li><li><a href=#replacecomments>replaceComments</a></li><li><a href=#removecommentschar>removeCommentsChar</a></li><li><a href=#removecomments>removeComments</a></li><li><a href=#replacenulls>replaceNulls</a></li><li><a href=#urldecode>urlDecode</a></li><li><a href=#uppercase>uppercase</a></li><li><a href=#urldecodeuni>urlDecodeUni</a></li><li><a href=#urlencode>urlEncode</a></li><li><a href=#utf8tounicode>utf8toUnicode</a></li><li><a href=#sha1>sha1</a></li><li><a href=#trimleft>trimLeft</a></li><li><a href=#trimright>trimRight</a></li><li><a href=#trim>trim</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#base64decode>base64Decode</a></li><li><a href=#base64decodeext>base64DecodeExt</a></li><li><a href=#base64encode>base64Encode</a></li><li><a href=#cmdline>cmdLine</a></li><li><a href=#compresswhitespace>compressWhitespace</a></li><li><a href=#cssdecode>cssDecode</a></li><li><a href=#escapeseqdecode>escapeSeqDecode</a></li><li><a href=#hexdecode>hexDecode</a></li><li><a href=#hexencode>hexEncode</a></li><li><a href=#htmlentitydecode>htmlEntityDecode</a></li><li><a href=#jsdecode>jsDecode</a></li><li><a href=#length>length</a></li><li><a href=#lowercase>lowercase</a></li><li><a href=#md5>md5</a></li><li><a href=#none>none</a></li><li><a href=#normalizepath>normalizePath</a></li><li><a href=#normalizepathwin>normalizePathWin</a></li><li><a href=#parityeven7bit>parityEven7bit</a></li><li><a href=#parityodd7bit>parityOdd7bit</a></li><li><a href=#parityzero7bit>parityZero7bit</a></li><li><a href=#removenulls>removeNulls</a></li><li><a href=#removewhitespace>removeWhitespace</a></li><li><a href=#replacecomments>replaceComments</a></li><li><a href=#removecommentschar>removeCommentsChar</a></li><li><a href=#removecomments>removeComments</a></li><li><a href=#replacenulls>replaceNulls</a></li><li><a href=#urldecode>urlDecode</a></li><li><a href=#uppercase>uppercase</a></li><li><a href=#urldecodeuni>urlDecodeUni</a></li><li><a href=#urlencode>urlEncode</a></li><li><a href=#utf8tounicode>utf8toUnicode</a></li><li><a href=#sha1>sha1</a></li><li><a href=#trimleft>trimLeft</a></li><li><a href=#trimright>trimRight</a></li><li><a href=#trim>trim</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Transformations</li></ol></nav><h1>Transformations</h1><p class=lead>Transformation functions are used to alter input data before it is used in matching (i.e., operator execution). The input data is never modified, actually—whenever you request a transformation function to be used, Coraza will create a copy of the data, transform it, and then run the operator against the result.</p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#base64decode>base64Decode</a></li><li><a href=#base64decodeext>base64DecodeExt</a></li><li><a href=#base64encode>base64Encode</a></li><li><a href=#cmdline>cmdLine</a></li><li><a href=#compresswhitespace>compressWhitespace</a></li><li><a href=#cssdecode>cssDecode</a></li><li><a href=#escapeseqdecode>escapeSeqDecode</a></li><li><a href=#hexdecode>hexDecode</a></li><li><a href=#hexencode>hexEncode</a></li><li><a href=#htmlentitydecode>htmlEntityDecode</a></li><li><a href=#jsdecode>jsDecode</a></li><li><a href=#length>length</a></li><li><a href=#lowercase>lowercase</a></li><li><a href=#md5>md5</a></li><li><a href=#none>none</a></li><li><a href=#normalizepath>normalizePath</a></li><li><a href=#normalizepathwin>normalizePathWin</a></li><li><a href=#parityeven7bit>parityEven7bit</a></li><li><a href=#parityodd7bit>parityOdd7bit</a></li><li><a href=#parityzero7bit>parityZero7bit</a></li><li><a href=#removenulls>removeNulls</a></li><li><a href=#removewhitespace>removeWhitespace</a></li><li><a href=#replacecomments>replaceComments</a></li><li><a href=#removecommentschar>removeCommentsChar</a></li><li><a href=#removecomments>removeComments</a></li><li><a href=#replacenulls>replaceNulls</a></li><li><a href=#urldecode>urlDecode</a></li><li><a href=#uppercase>uppercase</a></li><li><a href=#urldecodeuni>urlDecodeUni</a></li><li><a href=#urlencode>urlEncode</a></li><li><a href=#utf8tounicode>utf8toUnicode</a></li><li><a href=#sha1>sha1</a></li><li><a href=#trimleft>trimLeft</a></li><li><a href=#trimright>trimRight</a></li><li><a href=#trim>trim</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#base64decode>base64Decode</a></li><li><a href=#base64decodeext>base64DecodeExt</a></li><li><a href=#base64encode>base64Encode</a></li><li><a href=#cmdline>cmdLine</a></li><li><a href=#compresswhitespace>compressWhitespace</a></li><li><a href=#cssdecode>cssDecode</a></li><li><a href=#escapeseqdecode>escapeSeqDecode</a></li><li><a href=#hexdecode>hexDecode</a></li><li><a href=#hexencode>hexEncode</a></li><li><a href=#htmlentitydecode>htmlEntityDecode</a></li><li><a href=#jsdecode>jsDecode</a></li><li><a href=#length>length</a></li><li><a href=#lowercase>lowercase</a></li><li><a href=#md5>md5</a></li><li><a href=#none>none</a></li><li><a href=#normalizepath>normalizePath</a></li><li><a href=#normalizepathwin>normalizePathWin</a></li><li><a href=#parityeven7bit>parityEven7bit</a></li><li><a href=#parityodd7bit>parityOdd7bit</a></li><li><a href=#parityzero7bit>parityZero7bit</a></li><li><a href=#removenulls>removeNulls</a></li><li><a href=#removewhitespace>removeWhitespace</a></li><li><a href=#replacecomments>replaceComments</a></li><li><a href=#removecommentschar>removeCommentsChar</a></li><li><a href=#removecomments>removeComments</a></li><li><a href=#replacenulls>replaceNulls</a></li><li><a href=#urldecode>urlDecode</a></li><li><a href=#uppercase>uppercase</a></li><li><a href=#urldecodeuni>urlDecodeUni</a></li><li><a href=#urlencode>urlEncode</a></li><li><a href=#utf8tounicode>utf8toUnicode</a></li><li><a href=#sha1>sha1</a></li><li><a href=#trimleft>trimLeft</a></li><li><a href=#trimright>trimRight</a></li><li><a href=#trim>trim</a></li></ul></nav></div></nav><p>In the following example, the request parameter values are converted to lowercase before matching:</p><pre><code>SecRule ARGS &quot;xp_cmdshell&quot; &quot;t:lowercase,id:91&quot;
</code></pre><p>Multiple transformation actions can be used in the same rule, forming a transformation pipeline. The transformations will be performed in the order in which they appear in the rule.</p><p>In most cases, the order in which transformations are performed is very important. In the following example, a series of transformation functions is performed to counter evasion. Performing the transformations in any other order would allow a skillful attacker to evade detection:</p><pre><code>SecRule ARGS &quot;(asfunction|javascript|vbscript|data|mocha|livescript):&quot; &quot;id:92,t:none,t:htmlEntityDecode,t:lowercase,t:removeNulls,t:removeWhitespace&quot;
</code></pre><p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">👉</div><div class=w-100>Warning : It is currently possible to use SecDefaultAction to specify a default list of transformation functions, which will be applied to all rules that follow the SecDefaultAction directive. However, this practice is not recommended, because it means that mistakes are very easy to make. It is recommended that you always specify the transformation functions that are needed by a particular rule, starting the list with t:none (which clears the possibly inherited transformation functions).</div></div>The remainder of this section documents the transformation functions currently available in Coraza.</p><h2 id=base64decode>base64Decode <a href=#base64decode class=anchor aria-hidden=true>#</a></h2><p>Decodes a Base64-encoded string.</p><pre><code>SecRule REQUEST_HEADERS:Authorization &quot;^Basic ([a-zA-Z0-9]+=*)$&quot; &quot;phase:1,id:93,capture,chain,logdata:%{TX.1}&quot;
  SecRule TX:1 ^(\w+): t:base64Decode,capture,chain
    SecRule TX:1 ^(admin|root|backup)$ 
</code></pre><p>Note : Be careful when applying base64Decode with other transformations. The order of your transformation matters in this case as certain transformations may change or invalidate the base64 encoded string prior to being decoded (i.e t:lowercase, etc). This of course means that it is also very difficult to write a single rule that checks for a base64decoded value OR an unencoded value with transformations, it is best to write two rules in this situation.
sqlHexDecode
Decode sql hex data. Example (0x414243) will be decoded to (ABC).</p><h2 id=base64decodeext>base64DecodeExt <a href=#base64decodeext class=anchor aria-hidden=true>#</a></h2><p>Decodes a Base64-encoded string. Unlike base64Decode, this version uses a forgiving implementation, which ignores invalid characters.</p><p>See blog post on Base64Decoding evasion issues on PHP sites - http://blog.spiderlabs.com/2010/04/impedance-mismatch-and-base64.html</p><h2 id=base64encode>base64Encode <a href=#base64encode class=anchor aria-hidden=true>#</a></h2><p>Encodes input string using Base64 encoding.</p><h2 id=cmdline>cmdLine <a href=#cmdline class=anchor aria-hidden=true>#</a></h2><p>In Windows and Unix, commands may be escaped by different means, such as:</p><ul><li>c^ommand /c &mldr;</li><li>&ldquo;command&rdquo; /c &mldr;</li><li>command,/c &mldr;</li><li>backslash in the middle of a Unix command</li></ul><p>The cmdLine transformation function avoids this problem by manipulating the variable contend in the following ways:</p><ul><li>deleting all backslashes []</li><li>deleting all double quotes ["]</li><li>deleting all single quotes [']</li><li>deleting all carets [^]</li><li>deleting spaces before a slash /</li><li>deleting spaces before an open parentesis [(]</li><li>replacing all commas [,] and semicolon [;] into a space</li><li>replacing all multiple spaces (including tab, newline, etc.) into one space</li><li>transform all characters to lowercase</li></ul><p><strong>Example Usage:</strong></p><pre><code>SecRule ARGS &quot;(?:command(?:.com)?|cmd(?:.exe)?)(?:/.*)?/[ck]&quot; &quot;phase:2,id:94,t:none, t:cmdLine&quot;
</code></pre><h2 id=compresswhitespace>compressWhitespace <a href=#compresswhitespace class=anchor aria-hidden=true>#</a></h2><p>Converts any of the whitespace characters (0x20, \f, \t, \n, \r, \v, 0xa0) to spaces (ASCII 0x20), compressing multiple consecutive space characters into one.</p><h2 id=cssdecode>cssDecode <a href=#cssdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes characters encoded using the CSS 2.x escape rules syndata.html#characters. This function uses only up to two bytes in the decoding process, meaning that it is useful to uncover ASCII characters encoded using CSS encoding (that wouldn’t normally be encoded), or to counter evasion, which is a combination of a backslash and non-hexadecimal characters (e.g., ja\vascript is equivalent to javascript).</p><h2 id=escapeseqdecode>escapeSeqDecode <a href=#escapeseqdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes ANSI C escape sequences: \a, \b, \f, \n, \r, \t, \v, \, ?, ', ", \xHH (hexadecimal), \0OOO (octal). Invalid encodings are left in the output.</p><h2 id=hexdecode>hexDecode <a href=#hexdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes a string that has been encoded using the same algorithm as the one used in hexEncode (see following entry).</p><h2 id=hexencode>hexEncode <a href=#hexencode class=anchor aria-hidden=true>#</a></h2><p>Encodes string (possibly containing binary characters) by replacing each input byte with two hexadecimal characters. For example, xyz is encoded as 78797a.</p><h2 id=htmlentitydecode>htmlEntityDecode <a href=#htmlentitydecode class=anchor aria-hidden=true>#</a></h2><p>Decodes the characters encoded as HTML entities. The following variants are supported:</p><ul><li>HH and HH; (where H is any hexadecimal number)</li><li>DDD and DDD; (where D is any decimal number)</li><li>&amp;quotand"</li><li>&amp;nbspand</li><li>&amp;ltand&lt;</li><li>&amp;gtand></li></ul><p>This function always converts one HTML entity into one byte, possibly resulting in a loss of information (if the entity refers to a character that cannot be represented with the single byte). It is thus useful to uncover bytes that would otherwise not need to be encoded, but it cannot do anything meaningful with the characters from the range above 0xff.</p><h2 id=jsdecode>jsDecode <a href=#jsdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes JavaScript escape sequences. If a \uHHHH code is in the range of FF01-FF5E (the full width ASCII codes), then the higher byte is used to detect and adjust the lower byte. Otherwise, only the lower byte will be used and the higher byte zeroed (leading to possible loss of information).</p><h2 id=length>length <a href=#length class=anchor aria-hidden=true>#</a></h2><p>Looks up the length of the input string in bytes, placing it (as string) in output. For example, if it gets ABCDE on input, this transformation function will return 5 on output.</p><h2 id=lowercase>lowercase <a href=#lowercase class=anchor aria-hidden=true>#</a></h2><p>Converts all characters to lowercase using the current C locale.</p><h2 id=md5>md5 <a href=#md5 class=anchor aria-hidden=true>#</a></h2><p>Calculates an MD5 hash from the data in input. The computed hash is in a raw binary form and may need encoded into text to be printed (or logged). Hash functions are commonly used in combination with hexEncode (for example: t:md5,t:hexEncode).</p><h2 id=none>none <a href=#none class=anchor aria-hidden=true>#</a></h2><p>Not an actual transformation function, but an instruction to Coraza to remove all transformation functions associated with the current rule.</p><h2 id=normalizepath>normalizePath <a href=#normalizepath class=anchor aria-hidden=true>#</a></h2><p>Removes multiple slashes, directory self-references, and directory back-references (except when at the beginning of the input) from input string.</p><h2 id=normalizepathwin>normalizePathWin <a href=#normalizepathwin class=anchor aria-hidden=true>#</a></h2><p>Same as normalizePath, but first converts backslash characters to forward slashes.</p><h2 id=parityeven7bit>parityEven7bit <a href=#parityeven7bit class=anchor aria-hidden=true>#</a></h2><p>Calculates even parity of 7-bit data replacing the 8th bit of each target byte with the calculated parity bit.</p><h2 id=parityodd7bit>parityOdd7bit <a href=#parityodd7bit class=anchor aria-hidden=true>#</a></h2><p>Calculates odd parity of 7-bit data replacing the 8th bit of each target byte with the calculated parity bit.</p><h2 id=parityzero7bit>parityZero7bit <a href=#parityzero7bit class=anchor aria-hidden=true>#</a></h2><p>Calculates zero parity of 7-bit data replacing the 8th bit of each target byte with a zero-parity bit, which allows inspection of even/odd parity 7-bit data as ASCII7 data.</p><h2 id=removenulls>removeNulls <a href=#removenulls class=anchor aria-hidden=true>#</a></h2><p>Removes all NUL bytes from input.</p><h2 id=removewhitespace>removeWhitespace <a href=#removewhitespace class=anchor aria-hidden=true>#</a></h2><p>Removes all whitespace characters from input.</p><h2 id=replacecomments>replaceComments <a href=#replacecomments class=anchor aria-hidden=true>#</a></h2><p>Replaces each occurrence of a C-style comment (/<em>&mldr;</em>/) with a single space (multiple consecutive occurrences of which will not be compressed). Unterminated comments will also be replaced with a space (ASCII 0x20). However, a standalone termination of a comment (*/) will not be acted upon.</p><h2 id=removecommentschar>removeCommentsChar <a href=#removecommentschar class=anchor aria-hidden=true>#</a></h2><p>Removes common comments chars (/<em>,</em>/, &ndash;, #).</p><h2 id=removecomments>removeComments <a href=#removecomments class=anchor aria-hidden=true>#</a></h2><p>Removes each occurrence of comment (/<em>&mldr;</em>/, &ndash;, #). Multiple consecutive occurrences of which will not be compressed.</p><p>Note : This transformation is known to be unreliable, might cause some unexpected behaviour and could be deprecated soon in a future release. Refer to issue #1207 for further information..</p><h2 id=replacenulls>replaceNulls <a href=#replacenulls class=anchor aria-hidden=true>#</a></h2><p>Replaces NUL bytes in input with space characters (ASCII 0x20).</p><h2 id=urldecode>urlDecode <a href=#urldecode class=anchor aria-hidden=true>#</a></h2><p>Decodes a URL-encoded input string. Invalid encodings (i.e., the ones that use non-hexadecimal characters, or the ones that are at the end of string and have one or two bytes missing) are not converted, but no error is raised. To detect invalid encodings, use the @validateUrlEncoding operator on the input data first. The transformation function should not be used against variables that have already been URL-decoded (such as request parameters) unless it is your intention to perform URL decoding twice!</p><h2 id=uppercase>uppercase <a href=#uppercase class=anchor aria-hidden=true>#</a></h2><p>Converts all characters to uppercase using the current C locale.</p><h2 id=urldecodeuni>urlDecodeUni <a href=#urldecodeuni class=anchor aria-hidden=true>#</a></h2><p>Like urlDecode, but with support for the Microsoft-specific %u encoding. If the code is in the range of FF01-FF5E (the full-width ASCII codes), then the higher byte is used to detect and adjust the lower byte. Otherwise, only the lower byte will be used and the higher byte zeroed.</p><h2 id=urlencode>urlEncode <a href=#urlencode class=anchor aria-hidden=true>#</a></h2><p>Encodes input string using URL encoding.</p><h2 id=utf8tounicode>utf8toUnicode <a href=#utf8tounicode class=anchor aria-hidden=true>#</a></h2><p>Converts all UTF-8 characters sequences to Unicode. This help input normalization specially for non-english languages minimizing false-positives and false-negatives.</p><h2 id=sha1>sha1 <a href=#sha1 class=anchor aria-hidden=true>#</a></h2><p>Calculates a SHA1 hash from the input string. The computed hash is in a raw binary form and may need encoded into text to be printed (or logged). Hash functions are commonly used in combination with hexEncode (for example, t:sha1,t:hexEncode).</p><h2 id=trimleft>trimLeft <a href=#trimleft class=anchor aria-hidden=true>#</a></h2><p>Removes whitespace from the left side of the input string.</p><h2 id=trimright>trimRight <a href=#trimright class=anchor aria-hidden=true>#</a></h2><p>Removes whitespace from the right side of the input string.</p><h2 id=trim>trim <a href=#trim class=anchor aria-hidden=true>#</a></h2><p>Removes whitespace from both the left and right sides of the input string.</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/seclang/transformations.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/seclang/operators/><div class="card my-1"><div class="card-body py-2">&larr; Operators</div></div></a><a class=ms-auto href=https://coraza.io/docs/seclang/variables/><div class="card my-1"><div class="card-body py-2">Variables &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ❤️ (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.f06fe6dc0efc9ee1e806021a0c338278256ecf163b547e8e8769fe60b0a1c0d505782852616ca4e1ff6a719eb8fc954e1d26031b8ab3ca71fb9d9998081b319e.js integrity="sha512-8G/m3A78nuHoBgIaDDOCeCVuzxY7VH6Oh2n+YLChwNUFeChSYWyk4f9qcZ64/JVOHSYDG4qzynH7nZmYCBsxng==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.5c42765ed4daf59624a6e775bdc4bc68bba6664f4d678ecbc55390f986b6852e562c726fb5fd57b078713aa5aef95ebac205fe24f3d998ab84e10b6b28c413ee.js integrity="sha512-XEJ2XtTa9ZYkpud1vcS8aLumZk9NZ47LxVOQ+Ya2hS5WLHJvtf1XsHhxOqWu+V66wgX+JPPZmKuE4QtrKMQT7g==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.3bb8f119f63c6e06aa99acc71b7037b0c5461db421d5a169df0b668ca079081263bcc72dccff7584205495b398338b1da5ab6051c7fd7d0dc8a29c73e0a86c97.js integrity="sha512-O7jxGfY8bgaqmazHG3A3sMVGHbQh1aFp3wtmjKB5CBJjvMctzP91hCBUlbOYM4sdpatgUcf9fQ3Iopxz4Khslw==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.cdbb8d22808922eaf383e333a9859ee124264202d94d624a8f4632d420a8e467174a8f7ffa7c2d5926065063a5ac4b71e8f60e8f5100ed42245ba7efd885eb82.js integrity="sha512-zbuNIoCJIurzg+MzqYWe4SQmQgLZTWJKj0Yy1CCo5GcXSo9/+nwtWSYGUGOlrEtx6PYOj1EA7UIkW6fv2IXrgg==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>