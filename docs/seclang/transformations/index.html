<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=https://coraza.io/main.c3725bcbcd2ff51ecac15f4d1500ceadd090464fa263927131acf5df644ea286bcb8cf3a6d9ad4c8f43be7247c1ffa871107cf9dd6dfe37546a9527fd5e2aa8d.css integrity="sha512-w3Jby80v9R7KwV9NFQDOrdCQRk+iY5JxMaz132ROooa8uM86bZrUyPQ75yR8H/qHEQfPndbf43VGqVJ/1eKqjQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Transformations - OWASP Coraza WAF</title><meta name=description content="Transformation functions are used to alter input data before it is used in matching."><link rel=canonical href=https://coraza.io/docs/seclang/transformations/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Transformations"><meta property="og:description" content="Transformation functions are used to alter input data before it is used in matching."><meta property="og:url" content="https://coraza.io/docs/seclang/transformations/"><meta property="og:site_name" content="OWASP Coraza WAF"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza WAF"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Transformations"><meta name=twitter:description content="Transformation functions are used to alter input data before it is used in matching."><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Transformations"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP oraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP oraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza WAF","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/transformations/","url":"https://coraza.io/docs/seclang/transformations/","name":"Transformations","description":"Transformation functions are used to alter input data before it is used in matching.","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/transformations/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/transformations/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/transformations/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/transformations/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/transformations/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Transformations","description":"Transformation functions are used to alter input data before it is used in matching.","isPartOf":{"@id":"https://coraza.io/docs/seclang/transformations/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/transformations/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/transformations/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/transformations/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Transformations"}]}]}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-1J0TK2GV0R"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-1J0TK2GV0R")</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body class="docs single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label>
<a class="navbar-brand order-1 order-md-0 me-auto" href=https://coraza.io/>OWASP Coraza WAF</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><ul class="navbar-nav social-nav order-3 order-md-5"><li class=nav-item><a class=nav-link href=https://twitter.com/jptosso><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><span class="ms-2 visually-hidden">Twitter</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/jptosso/coraza-waf><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li></ul><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class="nav-item active"><a class=nav-link href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class=nav-link href=https://www.tosso.io/>Blog</a></li><li class=nav-item><a class=nav-link href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class=nav-link href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class=nav-link href=https://playground.coraza.io/>Playground</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li></ul><h3>Integrations</h3><h3>Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3>Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/logging/>Logging</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/roadmap/>Roadmap</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#base64decode>base64Decode</a></li><li><a href=#base64decodeext>base64DecodeExt</a></li><li><a href=#base64encode>base64Encode</a></li><li><a href=#cmdline>cmdLine</a></li><li><a href=#compresswhitespace>compressWhitespace</a></li><li><a href=#cssdecode>cssDecode</a></li><li><a href=#escapeseqdecode>escapeSeqDecode</a></li><li><a href=#hexdecode>hexDecode</a></li><li><a href=#hexencode>hexEncode</a></li><li><a href=#htmlentitydecode>htmlEntityDecode</a></li><li><a href=#jsdecode>jsDecode</a></li><li><a href=#length>length</a></li><li><a href=#lowercase>lowercase</a></li><li><a href=#md5>md5</a></li><li><a href=#none>none</a></li><li><a href=#normalizepath>normalizePath</a></li><li><a href=#normalizepathwin>normalizePathWin</a></li><li><a href=#parityeven7bit>parityEven7bit</a></li><li><a href=#parityodd7bit>parityOdd7bit</a></li><li><a href=#parityzero7bit>parityZero7bit</a></li><li><a href=#removenulls>removeNulls</a></li><li><a href=#removewhitespace>removeWhitespace</a></li><li><a href=#replacecomments>replaceComments</a></li><li><a href=#removecommentschar>removeCommentsChar</a></li><li><a href=#removecomments>removeComments</a></li><li><a href=#replacenulls>replaceNulls</a></li><li><a href=#urldecode>urlDecode</a></li><li><a href=#uppercase>uppercase</a></li><li><a href=#urldecodeuni>urlDecodeUni</a></li><li><a href=#urlencode>urlEncode</a></li><li><a href=#utf8tounicode>utf8toUnicode</a></li><li><a href=#sha1>sha1</a></li><li><a href=#trimleft>trimLeft</a></li><li><a href=#trimright>trimRight</a></li><li><a href=#trim>trim</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Use Cases</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Transformations</li></ol></nav><h1>Transformations</h1><p class=lead>Transformation functions are used to alter input data before it is used in matching (i.e., operator execution). The input data is never modified, actually‚Äîwhenever you request a transformation function to be used, Coraza will create a copy of the data, transform it, and then run the operator against the result.</p><p>In the following example, the request parameter values are converted to lowercase before matching:</p><pre><code>SecRule ARGS &quot;xp_cmdshell&quot; &quot;t:lowercase,id:91&quot;
</code></pre><p>Multiple transformation actions can be used in the same rule, forming a transformation pipeline. The transformations will be performed in the order in which they appear in the rule.</p><p>In most cases, the order in which transformations are performed is very important. In the following example, a series of transformation functions is performed to counter evasion. Performing the transformations in any other order would allow a skillful attacker to evade detection:</p><pre><code>SecRule ARGS &quot;(asfunction|javascript|vbscript|data|mocha|livescript):&quot; &quot;id:92,t:none,t:htmlEntityDecode,t:lowercase,t:removeNulls,t:removeWhitespace&quot;
</code></pre><p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">üëâ</div><div class=w-100>Warning : It is currently possible to use SecDefaultAction to specify a default list of transformation functions, which will be applied to all rules that follow the SecDefaultAction directive. However, this practice is not recommended, because it means that mistakes are very easy to make. It is recommended that you always specify the transformation functions that are needed by a particular rule, starting the list with t:none (which clears the possibly inherited transformation functions).</div></div>The remainder of this section documents the transformation functions currently available in Coraza.</p><h2 id=base64decode>base64Decode<a href=#base64decode class=anchor aria-hidden=true>#</a></h2><p>Decodes a Base64-encoded string.</p><pre><code>SecRule REQUEST_HEADERS:Authorization &quot;^Basic ([a-zA-Z0-9]+=*)$&quot; &quot;phase:1,id:93,capture,chain,logdata:%{TX.1}&quot;
  SecRule TX:1 ^(\w+): t:base64Decode,capture,chain
    SecRule TX:1 ^(admin|root|backup)$ 
</code></pre><p>Note : Be careful when applying base64Decode with other transformations. The order of your transformation matters in this case as certain transformations may change or invalidate the base64 encoded string prior to being decoded (i.e t:lowercase, etc). This of course means that it is also very difficult to write a single rule that checks for a base64decoded value OR an unencoded value with transformations, it is best to write two rules in this situation.
sqlHexDecode
Decode sql hex data. Example (0x414243) will be decoded to (ABC).</p><h2 id=base64decodeext>base64DecodeExt<a href=#base64decodeext class=anchor aria-hidden=true>#</a></h2><p>Decodes a Base64-encoded string. Unlike base64Decode, this version uses a forgiving implementation, which ignores invalid characters.</p><p>See blog post on Base64Decoding evasion issues on PHP sites - http://blog.spiderlabs.com/2010/04/impedance-mismatch-and-base64.html</p><h2 id=base64encode>base64Encode<a href=#base64encode class=anchor aria-hidden=true>#</a></h2><p>Encodes input string using Base64 encoding.</p><h2 id=cmdline>cmdLine<a href=#cmdline class=anchor aria-hidden=true>#</a></h2><p>In Windows and Unix, commands may be escaped by different means, such as:</p><ul><li>c^ommand /c &mldr;</li><li>&ldquo;command&rdquo; /c &mldr;</li><li>command,/c &mldr;</li><li>backslash in the middle of a Unix command</li></ul><p>The cmdLine transformation function avoids this problem by manipulating the variable contend in the following ways:</p><ul><li>deleting all backslashes []</li><li>deleting all double quotes ["]</li><li>deleting all single quotes [']</li><li>deleting all carets [^]</li><li>deleting spaces before a slash /</li><li>deleting spaces before an open parentesis [(]</li><li>replacing all commas [,] and semicolon [;] into a space</li><li>replacing all multiple spaces (including tab, newline, etc.) into one space</li><li>transform all characters to lowercase</li></ul><p><strong>Example Usage:</strong></p><pre><code>SecRule ARGS &quot;(?:command(?:.com)?|cmd(?:.exe)?)(?:/.*)?/[ck]&quot; &quot;phase:2,id:94,t:none, t:cmdLine&quot;
</code></pre><h2 id=compresswhitespace>compressWhitespace<a href=#compresswhitespace class=anchor aria-hidden=true>#</a></h2><p>Converts any of the whitespace characters (0x20, \f, \t, \n, \r, \v, 0xa0) to spaces (ASCII 0x20), compressing multiple consecutive space characters into one.</p><h2 id=cssdecode>cssDecode<a href=#cssdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes characters encoded using the CSS 2.x escape rules syndata.html#characters. This function uses only up to two bytes in the decoding process, meaning that it is useful to uncover ASCII characters encoded using CSS encoding (that wouldn‚Äôt normally be encoded), or to counter evasion, which is a combination of a backslash and non-hexadecimal characters (e.g., ja\vascript is equivalent to javascript).</p><h2 id=escapeseqdecode>escapeSeqDecode<a href=#escapeseqdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes ANSI C escape sequences: \a, \b, \f, \n, \r, \t, \v, \, ?, ', ", \xHH (hexadecimal), \0OOO (octal). Invalid encodings are left in the output.</p><h2 id=hexdecode>hexDecode<a href=#hexdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes a string that has been encoded using the same algorithm as the one used in hexEncode (see following entry).</p><h2 id=hexencode>hexEncode<a href=#hexencode class=anchor aria-hidden=true>#</a></h2><p>Encodes string (possibly containing binary characters) by replacing each input byte with two hexadecimal characters. For example, xyz is encoded as 78797a.</p><h2 id=htmlentitydecode>htmlEntityDecode<a href=#htmlentitydecode class=anchor aria-hidden=true>#</a></h2><p>Decodes the characters encoded as HTML entities. The following variants are supported:</p><ul><li>HH and HH; (where H is any hexadecimal number)</li><li>DDD and DDD; (where D is any decimal number)</li><li>&quotand"</li><li>&nbspand</li><li>&ltand&lt;</li><li>&gtand></li></ul><p>This function always converts one HTML entity into one byte, possibly resulting in a loss of information (if the entity refers to a character that cannot be represented with the single byte). It is thus useful to uncover bytes that would otherwise not need to be encoded, but it cannot do anything meaningful with the characters from the range above 0xff.</p><h2 id=jsdecode>jsDecode<a href=#jsdecode class=anchor aria-hidden=true>#</a></h2><p>Decodes JavaScript escape sequences. If a \uHHHH code is in the range of FF01-FF5E (the full width ASCII codes), then the higher byte is used to detect and adjust the lower byte. Otherwise, only the lower byte will be used and the higher byte zeroed (leading to possible loss of information).</p><h2 id=length>length<a href=#length class=anchor aria-hidden=true>#</a></h2><p>Looks up the length of the input string in bytes, placing it (as string) in output. For example, if it gets ABCDE on input, this transformation function will return 5 on output.</p><h2 id=lowercase>lowercase<a href=#lowercase class=anchor aria-hidden=true>#</a></h2><p>Converts all characters to lowercase using the current C locale.</p><h2 id=md5>md5<a href=#md5 class=anchor aria-hidden=true>#</a></h2><p>Calculates an MD5 hash from the data in input. The computed hash is in a raw binary form and may need encoded into text to be printed (or logged). Hash functions are commonly used in combination with hexEncode (for example: t:md5,t:hexEncode).</p><h2 id=none>none<a href=#none class=anchor aria-hidden=true>#</a></h2><p>Not an actual transformation function, but an instruction to Coraza to remove all transformation functions associated with the current rule.</p><h2 id=normalizepath>normalizePath<a href=#normalizepath class=anchor aria-hidden=true>#</a></h2><p>Removes multiple slashes, directory self-references, and directory back-references (except when at the beginning of the input) from input string.</p><h2 id=normalizepathwin>normalizePathWin<a href=#normalizepathwin class=anchor aria-hidden=true>#</a></h2><p>Same as normalizePath, but first converts backslash characters to forward slashes.</p><h2 id=parityeven7bit>parityEven7bit<a href=#parityeven7bit class=anchor aria-hidden=true>#</a></h2><p>Calculates even parity of 7-bit data replacing the 8th bit of each target byte with the calculated parity bit.</p><h2 id=parityodd7bit>parityOdd7bit<a href=#parityodd7bit class=anchor aria-hidden=true>#</a></h2><p>Calculates odd parity of 7-bit data replacing the 8th bit of each target byte with the calculated parity bit.</p><h2 id=parityzero7bit>parityZero7bit<a href=#parityzero7bit class=anchor aria-hidden=true>#</a></h2><p>Calculates zero parity of 7-bit data replacing the 8th bit of each target byte with a zero-parity bit, which allows inspection of even/odd parity 7-bit data as ASCII7 data.</p><h2 id=removenulls>removeNulls<a href=#removenulls class=anchor aria-hidden=true>#</a></h2><p>Removes all NUL bytes from input.</p><h2 id=removewhitespace>removeWhitespace<a href=#removewhitespace class=anchor aria-hidden=true>#</a></h2><p>Removes all whitespace characters from input.</p><h2 id=replacecomments>replaceComments<a href=#replacecomments class=anchor aria-hidden=true>#</a></h2><p>Replaces each occurrence of a C-style comment (/* &mldr; <em>/) with a single space (multiple consecutive occurrences of which will not be compressed). Unterminated comments will also be replaced with a space (ASCII 0x20). However, a standalone termination of a comment (</em>/) will not be acted upon.</p><h2 id=removecommentschar>removeCommentsChar<a href=#removecommentschar class=anchor aria-hidden=true>#</a></h2><p>Removes common comments chars (/*, */, &ndash;, #).</p><h2 id=removecomments>removeComments<a href=#removecomments class=anchor aria-hidden=true>#</a></h2><p>Removes each occurrence of comment (/* &mldr; */, &ndash;, #). Multiple consecutive occurrences of which will not be compressed.</p><p>Note : This transformation is known to be unreliable, might cause some unexpected behaviour and could be deprecated soon in a future release. Refer to issue #1207 for further information..</p><h2 id=replacenulls>replaceNulls<a href=#replacenulls class=anchor aria-hidden=true>#</a></h2><p>Replaces NUL bytes in input with space characters (ASCII 0x20).</p><h2 id=urldecode>urlDecode<a href=#urldecode class=anchor aria-hidden=true>#</a></h2><p>Decodes a URL-encoded input string. Invalid encodings (i.e., the ones that use non-hexadecimal characters, or the ones that are at the end of string and have one or two bytes missing) are not converted, but no error is raised. To detect invalid encodings, use the @validateUrlEncoding operator on the input data first. The transformation function should not be used against variables that have already been URL-decoded (such as request parameters) unless it is your intention to perform URL decoding twice!</p><h2 id=uppercase>uppercase<a href=#uppercase class=anchor aria-hidden=true>#</a></h2><p>Converts all characters to uppercase using the current C locale.</p><h2 id=urldecodeuni>urlDecodeUni<a href=#urldecodeuni class=anchor aria-hidden=true>#</a></h2><p>Like urlDecode, but with support for the Microsoft-specific %u encoding. If the code is in the range of FF01-FF5E (the full-width ASCII codes), then the higher byte is used to detect and adjust the lower byte. Otherwise, only the lower byte will be used and the higher byte zeroed.</p><h2 id=urlencode>urlEncode<a href=#urlencode class=anchor aria-hidden=true>#</a></h2><p>Encodes input string using URL encoding.</p><h2 id=utf8tounicode>utf8toUnicode<a href=#utf8tounicode class=anchor aria-hidden=true>#</a></h2><p>Converts all UTF-8 characters sequences to Unicode. This help input normalization specially for non-english languages minimizing false-positives and false-negatives.</p><h2 id=sha1>sha1<a href=#sha1 class=anchor aria-hidden=true>#</a></h2><p>Calculates a SHA1 hash from the input string. The computed hash is in a raw binary form and may need encoded into text to be printed (or logged). Hash functions are commonly used in combination with hexEncode (for example, t:sha1,t:hexEncode).</p><h2 id=trimleft>trimLeft<a href=#trimleft class=anchor aria-hidden=true>#</a></h2><p>Removes whitespace from the left side of the input string.</p><h2 id=trimright>trimRight<a href=#trimright class=anchor aria-hidden=true>#</a></h2><p>Removes whitespace from the right side of the input string.</p><h2 id=trim>trim<a href=#trim class=anchor aria-hidden=true>#</a></h2><p>Removes whitespace from both the left and right sides of the input string.</p><p class=edit-page><a href=https://github.com/jptosso/coraza.io/blob/master/content/docs/seclang/transformations.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/seclang/syntax/><div class="card my-1"><div class="card-body py-2">&larr; Syntax</div></div></a><a class=ms-auto href=https://coraza.io/docs/seclang/variables/><div class="card my-1"><div class="card-body py-2">Variables &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ‚ù§Ô∏è (and code) - By Juan Pablo Tosso</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.0a3cc8e06de47abf2e91a48ebb20ad66756a97a290b5bfc41e312d89ba5dd12dcb3f0c463c7494b150ac6ff7a1f96648401f878e623712f908d8eab59c1dcad0.js integrity="sha512-CjzI4G3ker8ukaSOuyCtZnVql6KQtb/EHjEtibpd0S3LPwxGPHSUsVCsb/eh+WZIQB+HjmI3EvkI2Oq1nB3K0A==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.c77e1b000b036cae87dc49b64980b70a0e9320481bf597230c90c928d7b6758928152b67a257ff0f650da477f7a00670f32ec016a18e6bc762d2eafb1eabb54e.js integrity="sha512-x34bAAsDbK6H3Em2SYC3Cg6TIEgb9ZcjDJDJKNe2dYkoFStnolf/D2UNpHf3oAZw8y7AFqGOa8di0ur7Hqu1Tg==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.ed66790ef063177366c6f4a5498e8df6442cc0a4be023a326441d5ff02a8569375f2b1348e8e8ae3b0ae5a4da47ab1f867bebef09159310cbc937994ac7e5efc.js integrity="sha512-7WZ5DvBjF3NmxvSlSY6N9kQswKS+AjoyZEHV/wKoVpN18rE0jo6K47CuWk2kerH4Z76+8JFZMQy8k3mUrH5e/A==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.bf56f9b179aed6660741c4032b9a9e1c001d08087dc325ece34a6c8edbf84fc832bfc0d8bbfd08a4e94ac63db55d795d1e020e2319132fa275dde3137792ed36.js integrity="sha512-v1b5sXmu1mYHQcQDK5qeHAAdCAh9wyXs40psjtv4T8gyv8DYu/0IpOlKxj21XXldHgIOIxkTL6J13eMTd5LtNg==" crossorigin=anonymous defer></script></body></html>