<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(e){/^global-alert-/.test(e)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://coraza.io/main.08040bc4f930cbd11ade8cde0f20f30f51874e67e12c205ee34b2bc8e27b935fc1403e5dc7e89fd73be9a140225ede53f8b469ee6bb84eebbc32c3bba1982c1f.css integrity="sha512-CAQLxPkwy9Ea3ozeDyDzD1GHTmfhLCBe40sryOJ7k1/BQD5dx+if1zvpoUAiXt5T+LRp7mu4Tuu8MsO7oZgsHw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Syntax - OWASP Coraza</title><meta name=description content="The original language for configuring the ModSecurity Apache module was a set of extension directives to the Apache config language. This extension allows you to generate your Security Policy where you take an access control decision based on a set of parameters. Directives can be used to configure the engine itself, but also to send directives to the engine for access control. Directives look like the examples below:
SecDirective1 some options SecDirective2 &amp;quot;some option between brackets \&amp;quot; and escaped&amp;quot; SecSampleDirective this \ directive \ is splitted \ in lines Rule syntax # Rules are a special directive that must contain variables, operator and actions: SecRule VARIABLES &amp;quot;@OPERATOR OPERATOR_ARGUMENTS&amp;quot; &amp;quot;ACTIONS&amp;quot;."><link rel=canonical href=https://coraza.io/docs/seclang/syntax/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Syntax"><meta property="og:description" content="The original language for configuring the ModSecurity Apache module was a set of extension directives to the Apache config language. This extension allows you to generate your Security Policy where you take an access control decision based on a set of parameters. Directives can be used to configure the engine itself, but also to send directives to the engine for access control. Directives look like the examples below:
SecDirective1 some options SecDirective2 &#34;some option between brackets \&#34; and escaped&#34; SecSampleDirective this \ directive \ is splitted \ in lines Rule syntax # Rules are a special directive that must contain variables, operator and actions: SecRule VARIABLES &#34;@OPERATOR OPERATOR_ARGUMENTS&#34; &#34;ACTIONS&#34;."><meta property="og:url" content="https://coraza.io/docs/seclang/syntax/"><meta property="og:site_name" content="OWASP Coraza"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Syntax"><meta name=twitter:description content><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Syntax"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/syntax/","url":"https://coraza.io/docs/seclang/syntax/","name":"Syntax","description":"","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/syntax/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/syntax/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/syntax/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/syntax/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/syntax/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Syntax","description":"","isPartOf":{"@id":"https://coraza.io/docs/seclang/syntax/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/syntax/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/syntax/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso and Coraza contributors","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/syntax/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Syntax"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div id=announcement data-id=global-alert-c965de2304062d13ca89378ac0b47df7 class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>Coraza v3 <a class=alert-link href=https://github.com/corazawaf/coraza/releases>available here!</a>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#rule-syntax>Rule syntax</a><ul><li><a href=#variables>Variables</a></li><li><a href=#operators>Operators</a></li><li><a href=#actions>Actions</a></li><li><a href=#default-actions>Default Actions</a></li><li><a href=#secaction>SecAction</a></li></ul></li><li><a href=#macro-expansion>Macro Expansion</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#rule-syntax>Rule syntax</a><ul><li><a href=#variables>Variables</a></li><li><a href=#operators>Operators</a></li><li><a href=#actions>Actions</a></li><li><a href=#default-actions>Default Actions</a></li><li><a href=#secaction>SecAction</a></li></ul></li><li><a href=#macro-expansion>Macro Expansion</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Syntax</li></ol></nav><h1>Syntax</h1><p class=lead></p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#rule-syntax>Rule syntax</a><ul><li><a href=#variables>Variables</a></li><li><a href=#operators>Operators</a></li><li><a href=#actions>Actions</a></li><li><a href=#default-actions>Default Actions</a></li><li><a href=#secaction>SecAction</a></li></ul></li><li><a href=#macro-expansion>Macro Expansion</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#rule-syntax>Rule syntax</a><ul><li><a href=#variables>Variables</a></li><li><a href=#operators>Operators</a></li><li><a href=#actions>Actions</a></li><li><a href=#default-actions>Default Actions</a></li><li><a href=#secaction>SecAction</a></li></ul></li><li><a href=#macro-expansion>Macro Expansion</a></li></ul></nav></div></nav><p>The original language for configuring the ModSecurity Apache module was a set of extension directives to the Apache config language. This extension allows you to generate your Security Policy where you take an access control decision based on a set of parameters. Directives can be used to configure the engine itself, but also to send directives to the engine for access control. Directives look like the examples below:</p><pre><code class=language-modsecurity>SecDirective1 some options
SecDirective2 &quot;some option between brackets \&quot; and escaped&quot;
</code></pre><pre><code>SecSampleDirective this \
    directive \
    is splitted \
    in lines

</code></pre><h2 id=rule-syntax>Rule syntax <a href=#rule-syntax class=anchor aria-hidden=true>#</a></h2><p>Rules are a special directive that must contain variables, operator and actions: <code>SecRule VARIABLES "@OPERATOR OPERATOR_ARGUMENTS" "ACTIONS"</code>.</p><ul><li>All rules <strong>must</strong> have a unique ID action, for example <code>"id:1"</code>.</li><li>If there is no <strong>phase</strong> action, the phase will default to 2 (request body).</li><li>Rules can contain only one disruptive action</li><li>More default actions can be set with <a href=https://coraza.io/docs/seclang/directives/#SecDefaultAction>SecDefaultAction</a></li></ul><pre><code>SecRule REMOTE_ADDR &quot;127.0.0.1&quot; &quot;id:1, phase:1, pass, log, logdata:'Request from localhost'&quot;
</code></pre><h3 id=variables>Variables <a href=#variables class=anchor aria-hidden=true>#</a></h3><p>Variables are a structure of KEY:VALUE(S), some variables are mapped objects that contains <code>KEY:[VALUE1,VALUE2,VALUE3]</code>, while other are just <code>KEY:VALUE</code>. If you request a variable without any parameter, it will return all of values for each key, if it is a <code>KEY:VALUE</code> variable it will just return a single value. Variable parameters use the syntax <code>VARIABLE:PARAMETER</code>.</p><p><strong>Variable key</strong></p><p>Variables can be queried for a specific case insesitive key, for example:</p><pre><code>SecRule REQUEST_HEADERS:user-agent &quot;@contains firefox&quot; &quot;id:1, pass, log, logdata:'someone used firefox to access'&quot;
</code></pre><p><strong>Variable with regex</strong></p><p>(v2 Only): PCRE compatible regex can be used to query a mapped VARIABLE like ARGS, the following example will match all parameters (get and post) where the key begins with <code>param</code> and the value of this argument is <code>someval</code>.</p><pre><code>SecRule ARGS:/^param.*$/ &quot;someval&quot; &quot;id:1&quot;
</code></pre><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">👉</div><div class=w-100>Only RE2 will be supported in v3.</div></div><p><strong>Variable count</strong></p><p>You can count the number of values available for a collection using the <strong>&</strong> prefix, for example:</p><pre><code># You want to block requests without host header
SecRule &amp;REQUEST_HEADERS:host &quot;@eq 0&quot; &quot;id:1, deny, status:403&quot;
</code></pre><p><strong>Variable exceptions</strong></p><p>You can remove specific target keys from the variables list using the <strong>!</strong> prefix, for example:</p><pre><code># We want to apply some Sql Injection validations against the REQUEST_HEADERS
SecRule REQUEST_HEADERS &quot;@detectSQLi&quot; &quot;id:1,deny,status:403&quot;

# There is a false positive for some User-Agents so we want to ignore the 
# User-Agent header:
SecRule REQUEST_HEADERS|!REQUEST_HEADERS:User-Agent &quot;@detectSQLi&quot; &quot;id:2,deny,status:403&quot;

## The second rule will be evaluated for each request header except User-Agent.
</code></pre><p><strong>Multiple Variables</strong></p><p>You may evaluate multiple variables by separating them win pipe (|), for example:</p><pre><code>SecRule VARIABLE1|VARIABLE2|VARIABLE3:/some-regex/|!VARIABLE3:id &quot;!@rx \w+&quot; &quot;id:1,pass&quot;
</code></pre><h4 id=xpath-variables>XPATH variables <a href=#xpath-variables class=anchor aria-hidden=true>#</a></h4><p>If the body processor is set to process JSON or XML, you may use the special variables <strong>XML</strong> and <strong>JSON</strong>, for example:</p><pre><code>SecAction &quot;id:1, phase:1,ctl:setRequestBodyProcessor=XML,pass,nolog&quot;
# We are denying a book because we don't like it
SecRule XML:/bookstore/book[last()] &quot;name of the book&quot; &quot;id:2,phase:2,log,logdata:'We don´t like this book!',deny,status:403&quot;
</code></pre><p>See <a href=https://github.com/antchfx/xpath>https://github.com/antchfx/xpath</a> for more information about XPATH support.</p><h3 id=operators>Operators <a href=#operators class=anchor aria-hidden=true>#</a></h3><p>Operators are functions that returns true or false. Only one operator can be used per rule, unless you use chains. The syntax for an operator is: <code>"@OPERATOR ARGUMENTS"</code>, you can negate the result using <code>"!@OPERATOR ARGUMENTS"</code>.</p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">👉</div><div class=w-100><ul><li><p>If you don&rsquo;t indicate any operator, the default used operator will be <code>@rx</code>.</p></li><li><p>Operators must begin with <strong>@</strong>.</p></li></ul></div></div><h3 id=actions>Actions <a href=#actions class=anchor aria-hidden=true>#</a></h3><p>Actions are key-value instructions for the rule that will be triggered per compilation, interruption or transaction depending on the action type.</p><p>Actions values are optional, the key-value syntax is <code>key:value</code> and some actions can be reused as much as you want, like <strong>t</strong>.</p><p><strong>Action types:</strong></p><ul><li><strong>Non-disruptive actions</strong> - Do something, but that something does not and cannot affect the rule processing flow. Setting a variable, or changing its value is an example of a non-disruptive action. Non-disruptive action can appear in any rule, including each rule belonging to a chain.</li><li><strong>Flow actions</strong> - These actions affect the rule flow (for example skip or skipAfter).</li><li><strong>Meta-data actions</strong> - Meta-data actions are used to provide more information about rules. Examples include id, rev, severity and msg.</li><li><strong>Data actions</strong> - Not really actions, these are mere containers that hold data used by other actions. For example, the status action holds the status that will be used for blocking (if it takes place).</li></ul><h3 id=default-actions>Default Actions <a href=#default-actions class=anchor aria-hidden=true>#</a></h3><p><code>SecDefaultAction</code> is used to define a default list of actions per phase. The default phases will be added to each rule and can be overwritten by using the specified action again.</p><p>If you define default actions, you are forced to indicate a <strong>phase</strong> and a <strong>disruptive action</strong>.</p><pre><code>SecDefaultAction &quot;phase:1, deny, status:403&quot;

# This rule will deny the request with status 403 because of the default actions
SecAction &quot;id:2, phase:1&quot;

# This rule will be triggered but it will pas instead of deny
SecAction &quot;id:3, phase:1, pass&quot;
</code></pre><h3 id=secaction>SecAction <a href=#secaction class=anchor aria-hidden=true>#</a></h3><p>SecActions are used to create rules that will always match, they don´t contain operator nor variables.</p><h2 id=macro-expansion>Macro Expansion <a href=#macro-expansion class=anchor aria-hidden=true>#</a></h2><p>Macro expansions are special messages that can be transformed into it&rsquo;s evaluated value, the syntax is: <code>%{VARIABLE.KEY}</code>, for example <code>%{REQUEST_HEADERS.host}</code> will return the content of the request header &ldquo;Host&rdquo;.</p><pre><code>SecAction &quot;id:1, log, logdata:'Transaction %{unique_id}'&quot;

# we assign a variable to tx.argcount
SecRule &amp;ARGS &quot;!@eq 0&quot; &quot;id:2, setvar:'tx.argcount=%{MATCHED_VAR}', pass&quot;
# we print the args count to the log
SecAction &quot;id:3, log, logdata:'%{tx.argcount} arguments found.'&quot;
</code></pre><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/seclang/syntax.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/seclang/directives/><div class="card my-1"><div class="card-body py-2">&larr; Directives</div></div></a><a class=ms-auto href=https://coraza.io/docs/seclang/actions/><div class="card my-1"><div class="card-body py-2">Actions &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ❤️ (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.f06fe6dc0efc9ee1e806021a0c338278256ecf163b547e8e8769fe60b0a1c0d505782852616ca4e1ff6a719eb8fc954e1d26031b8ab3ca71fb9d9998081b319e.js integrity="sha512-8G/m3A78nuHoBgIaDDOCeCVuzxY7VH6Oh2n+YLChwNUFeChSYWyk4f9qcZ64/JVOHSYDG4qzynH7nZmYCBsxng==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.5c42765ed4daf59624a6e775bdc4bc68bba6664f4d678ecbc55390f986b6852e562c726fb5fd57b078713aa5aef95ebac205fe24f3d998ab84e10b6b28c413ee.js integrity="sha512-XEJ2XtTa9ZYkpud1vcS8aLumZk9NZ47LxVOQ+Ya2hS5WLHJvtf1XsHhxOqWu+V66wgX+JPPZmKuE4QtrKMQT7g==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.3bb8f119f63c6e06aa99acc71b7037b0c5461db421d5a169df0b668ca079081263bcc72dccff7584205495b398338b1da5ab6051c7fd7d0dc8a29c73e0a86c97.js integrity="sha512-O7jxGfY8bgaqmazHG3A3sMVGHbQh1aFp3wtmjKB5CBJjvMctzP91hCBUlbOYM4sdpatgUcf9fQ3Iopxz4Khslw==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.cdbb8d22808922eaf383e333a9859ee124264202d94d624a8f4632d420a8e467174a8f7ffa7c2d5926065063a5ac4b71e8f60e8f5100ed42245ba7efd885eb82.js integrity="sha512-zbuNIoCJIurzg+MzqYWe4SQmQgLZTWJKj0Yy1CCo5GcXSo9/+nwtWSYGUGOlrEtx6PYOj1EA7UIkW6fv2IXrgg==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>