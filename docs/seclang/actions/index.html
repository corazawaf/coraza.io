<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(e){/^global-alert-/.test(e)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://coraza.io/main.08040bc4f930cbd11ade8cde0f20f30f51874e67e12c205ee34b2bc8e27b935fc1403e5dc7e89fd73be9a140225ede53f8b469ee6bb84eebbc32c3bba1982c1f.css integrity="sha512-CAQLxPkwy9Ea3ozeDyDzD1GHTmfhLCBe40sryOJ7k1/BQD5dx+if1zvpoUAiXt5T+LRp7mu4Tuu8MsO7oZgsHw==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Actions - OWASP Coraza</title><meta name=description content="Actions available in Coraza"><link rel=canonical href=https://coraza.io/docs/seclang/actions/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Actions"><meta property="og:description" content="Actions available in Coraza"><meta property="og:url" content="https://coraza.io/docs/seclang/actions/"><meta property="og:site_name" content="OWASP Coraza"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Actions"><meta name=twitter:description content="Actions available in Coraza"><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Actions"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/actions/","url":"https://coraza.io/docs/seclang/actions/","name":"Actions","description":"Actions available in Coraza","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/actions/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/actions/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/actions/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/actions/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/actions/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Actions","description":"Actions available in Coraza","isPartOf":{"@id":"https://coraza.io/docs/seclang/actions/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/actions/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/actions/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso and Coraza contributors","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/actions/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Actions"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div id=announcement data-id=global-alert-c965de2304062d13ca89378ac0b47df7 class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>Coraza v3 <a class=alert-link href=https://github.com/corazawaf/coraza/releases>available here!</a>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 🆕</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#accuracy>accuracy</a></li><li><a href=#allow>allow</a></li><li><a href=#append>append</a></li><li><a href=#auditlog>auditlog</a></li><li><a href=#block>block</a></li><li><a href=#capture>capture</a></li><li><a href=#chain>chain</a></li><li><a href=#ctl>ctl</a></li><li><a href=#deny>deny</a></li><li><a href=#drop>drop</a></li><li><a href=#exec>exec</a></li><li><a href=#expirevar>expirevar</a></li><li><a href=#id>id</a></li><li><a href=#initcol>initcol</a></li><li><a href=#log>log</a></li><li><a href=#logdata>logdata</a></li><li><a href=#maturity>maturity</a></li><li><a href=#msg>msg</a></li><li><a href=#multimatch>multiMatch</a></li><li><a href=#noauditlog>noauditlog</a></li><li><a href=#nolog>nolog</a></li><li><a href=#pass>pass</a></li><li><a href=#pause>pause</a></li><li><a href=#phase>phase</a></li><li><a href=#prepend>prepend</a></li><li><a href=#proxy>proxy</a></li><li><a href=#redirect>redirect</a></li><li><a href=#rev>rev</a></li><li><a href=#sanitisearg>sanitiseArg</a></li><li><a href=#sanitisematched>sanitiseMatched</a></li><li><a href=#sanitisematchedbytes>sanitiseMatchedBytes</a></li><li><a href=#sanitiserequestheader>sanitiseRequestHeader</a></li><li><a href=#sanitiseresponseheader>sanitiseResponseHeader</a></li><li><a href=#severity>severity</a></li><li><a href=#setuid>setuid</a></li><li><a href=#setrsc>setrsc</a></li><li><a href=#setsid>setsid</a></li><li><a href=#setenv>setenv</a></li><li><a href=#setvar>setvar</a></li><li><a href=#skip>skip</a></li><li><a href=#skipafter>skipAfter</a></li><li><a href=#status>status</a></li><li><a href=#t>t</a></li><li><a href=#tag>tag</a></li><li><a href=#ver>ver</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#accuracy>accuracy</a></li><li><a href=#allow>allow</a></li><li><a href=#append>append</a></li><li><a href=#auditlog>auditlog</a></li><li><a href=#block>block</a></li><li><a href=#capture>capture</a></li><li><a href=#chain>chain</a></li><li><a href=#ctl>ctl</a></li><li><a href=#deny>deny</a></li><li><a href=#drop>drop</a></li><li><a href=#exec>exec</a></li><li><a href=#expirevar>expirevar</a></li><li><a href=#id>id</a></li><li><a href=#initcol>initcol</a></li><li><a href=#log>log</a></li><li><a href=#logdata>logdata</a></li><li><a href=#maturity>maturity</a></li><li><a href=#msg>msg</a></li><li><a href=#multimatch>multiMatch</a></li><li><a href=#noauditlog>noauditlog</a></li><li><a href=#nolog>nolog</a></li><li><a href=#pass>pass</a></li><li><a href=#pause>pause</a></li><li><a href=#phase>phase</a></li><li><a href=#prepend>prepend</a></li><li><a href=#proxy>proxy</a></li><li><a href=#redirect>redirect</a></li><li><a href=#rev>rev</a></li><li><a href=#sanitisearg>sanitiseArg</a></li><li><a href=#sanitisematched>sanitiseMatched</a></li><li><a href=#sanitisematchedbytes>sanitiseMatchedBytes</a></li><li><a href=#sanitiserequestheader>sanitiseRequestHeader</a></li><li><a href=#sanitiseresponseheader>sanitiseResponseHeader</a></li><li><a href=#severity>severity</a></li><li><a href=#setuid>setuid</a></li><li><a href=#setrsc>setrsc</a></li><li><a href=#setsid>setsid</a></li><li><a href=#setenv>setenv</a></li><li><a href=#setvar>setvar</a></li><li><a href=#skip>skip</a></li><li><a href=#skipafter>skipAfter</a></li><li><a href=#status>status</a></li><li><a href=#t>t</a></li><li><a href=#tag>tag</a></li><li><a href=#ver>ver</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Actions</li></ol></nav><h1>Actions</h1><p class=lead>The action of a rule defines how to handle HTTP requests that have matched one or more rule conditions.</p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#accuracy>accuracy</a></li><li><a href=#allow>allow</a></li><li><a href=#append>append</a></li><li><a href=#auditlog>auditlog</a></li><li><a href=#block>block</a></li><li><a href=#capture>capture</a></li><li><a href=#chain>chain</a></li><li><a href=#ctl>ctl</a></li><li><a href=#deny>deny</a></li><li><a href=#drop>drop</a></li><li><a href=#exec>exec</a></li><li><a href=#expirevar>expirevar</a></li><li><a href=#id>id</a></li><li><a href=#initcol>initcol</a></li><li><a href=#log>log</a></li><li><a href=#logdata>logdata</a></li><li><a href=#maturity>maturity</a></li><li><a href=#msg>msg</a></li><li><a href=#multimatch>multiMatch</a></li><li><a href=#noauditlog>noauditlog</a></li><li><a href=#nolog>nolog</a></li><li><a href=#pass>pass</a></li><li><a href=#pause>pause</a></li><li><a href=#phase>phase</a></li><li><a href=#prepend>prepend</a></li><li><a href=#proxy>proxy</a></li><li><a href=#redirect>redirect</a></li><li><a href=#rev>rev</a></li><li><a href=#sanitisearg>sanitiseArg</a></li><li><a href=#sanitisematched>sanitiseMatched</a></li><li><a href=#sanitisematchedbytes>sanitiseMatchedBytes</a></li><li><a href=#sanitiserequestheader>sanitiseRequestHeader</a></li><li><a href=#sanitiseresponseheader>sanitiseResponseHeader</a></li><li><a href=#severity>severity</a></li><li><a href=#setuid>setuid</a></li><li><a href=#setrsc>setrsc</a></li><li><a href=#setsid>setsid</a></li><li><a href=#setenv>setenv</a></li><li><a href=#setvar>setvar</a></li><li><a href=#skip>skip</a></li><li><a href=#skipafter>skipAfter</a></li><li><a href=#status>status</a></li><li><a href=#t>t</a></li><li><a href=#tag>tag</a></li><li><a href=#ver>ver</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#accuracy>accuracy</a></li><li><a href=#allow>allow</a></li><li><a href=#append>append</a></li><li><a href=#auditlog>auditlog</a></li><li><a href=#block>block</a></li><li><a href=#capture>capture</a></li><li><a href=#chain>chain</a></li><li><a href=#ctl>ctl</a></li><li><a href=#deny>deny</a></li><li><a href=#drop>drop</a></li><li><a href=#exec>exec</a></li><li><a href=#expirevar>expirevar</a></li><li><a href=#id>id</a></li><li><a href=#initcol>initcol</a></li><li><a href=#log>log</a></li><li><a href=#logdata>logdata</a></li><li><a href=#maturity>maturity</a></li><li><a href=#msg>msg</a></li><li><a href=#multimatch>multiMatch</a></li><li><a href=#noauditlog>noauditlog</a></li><li><a href=#nolog>nolog</a></li><li><a href=#pass>pass</a></li><li><a href=#pause>pause</a></li><li><a href=#phase>phase</a></li><li><a href=#prepend>prepend</a></li><li><a href=#proxy>proxy</a></li><li><a href=#redirect>redirect</a></li><li><a href=#rev>rev</a></li><li><a href=#sanitisearg>sanitiseArg</a></li><li><a href=#sanitisematched>sanitiseMatched</a></li><li><a href=#sanitisematchedbytes>sanitiseMatchedBytes</a></li><li><a href=#sanitiserequestheader>sanitiseRequestHeader</a></li><li><a href=#sanitiseresponseheader>sanitiseResponseHeader</a></li><li><a href=#severity>severity</a></li><li><a href=#setuid>setuid</a></li><li><a href=#setrsc>setrsc</a></li><li><a href=#setsid>setsid</a></li><li><a href=#setenv>setenv</a></li><li><a href=#setvar>setvar</a></li><li><a href=#skip>skip</a></li><li><a href=#skipafter>skipAfter</a></li><li><a href=#status>status</a></li><li><a href=#t>t</a></li><li><a href=#tag>tag</a></li><li><a href=#ver>ver</a></li></ul></nav></div></nav><p>Actions are defined as part of a <code>SecRule</code> or as parameter for <code>SecAction</code> or <code>SecDefaultAction</code>. A rule can have no or serveral actions which need to be separated by a comma.</p><p>Actions can be categorized by how they affect overall processing:</p><ul><li><strong>Disruptive actions</strong> - Cause Coraza to do something. In many cases something means block transaction, but not in all. For example, the allow action is classified as a disruptive action, but it does the opposite of blocking. There can only be one disruptive action per rule (if there are multiple disruptive actions present, or inherited, only the last one will take effect), or rule chain (in a chain, a disruptive action can only appear in the first rule).<div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">👉</div><div class=w-100>Disruptive actions will NOT be executed if the <code>SecRuleEngine</code> is set to <code>DetectionOnly</code>. If you are creating exception/whitelisting rules that use the allow action, you should also add the <code>ctl:ruleEngine=On</code> action to execute the action.</div></div></li><li><strong>Non-disruptive actions</strong> - Do something, but that something does not and cannot affect the rule processing flow. Setting a variable, or changing its value is an example of a non-disruptive action. Non-disruptive action can appear in any rule, including each rule belonging to a chain.</li><li><strong>Flow actions</strong> - These actions affect the rule flow (for example skip or skipAfter).</li><li><strong>Meta-data actions</strong> - used to provide more information about rules. Examples include id, rev, severity and msg.</li><li><strong>Data actions</strong> - Not really actions, these are mere containers that hold data used by other actions. For example, the status action holds the status that will be used for blocking (if it takes place).</li></ul><h2 id=accuracy>accuracy <a href=#accuracy class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Specifies the relative accuracy level of the rule related to false positives/negatives. The value is a string based on a numeric scale (1-9 where 9 is very strong and 1 has many false positives).</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;\bgetparentfolder\b&quot; \
    &quot;id:'958016',phase:2,ver:'CRS/2.2.4,accuracy:'9',maturity:'9',capture,\
    t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,\
    ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',\
    tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',\
    tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'%{TX.0}',\
    severity:'2',setvar:'tx.msg=%{rule.msg}',\
    setvar:tx.xss_score=+%{tx.critical_anomaly_score},\
    setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},\
    setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;
</code></pre><h2 id=allow>allow <a href=#allow class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Stops rule processing on a successful match and allows the transaction to proceed.</p><p><strong>Action Group:</strong> Disruptive</p><p><strong>Example:</strong></p><pre><code># Allow unrestricted access from 192.168.1.100 
SecRule REMOTE_ADDR &quot;^192\.168\.1\.100$&quot; phase:1,id:95,nolog,allow
</code></pre><p>Prior to Coraza 2.5 the allow action would only affect the current phase. An allow in phase 1 would skip processing the remaining rules in phase 1 but the rules from phase 2 would execute. Starting with v2.5.0 allow was enhanced to allow for fine-grained control of what is done. The following rules now apply:</p><p>If used on its own, like in the example above, allow will affect the entire transaction, stopping processing of the current phase, but also skipping over all other phases apart from the logging phase. (The logging phase is special; it is designed to always execute.)
If used with parameter &ldquo;phase&rdquo;, allow will cause the engine to stop processing the current phase. Other phases will continue as normal.
If used with parameter &ldquo;request&rdquo;, allow will cause the engine to stop processing the current phase. The next phase to be processed will be phase RESPONSE_HEADERS.
Examples:</p><pre><code># Do not process request but process response.
SecAction phase:1,allow:request,id:96

# Do not process transaction (request and response).
SecAction phase:1,allow,id:97
If you want to allow a response through, put a rule in phase RESPONSE_HEADERS and simply use allow on its own:

# Allow response through.
SecAction phase:3,allow,id:98
</code></pre><h2 id=append>append <a href=#append class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Appends text given as parameter to the end of response body. Content injection must be enabled (using the SecContentInjection directive). No content type checks are made, which means that before using any of the content injection actions, you must check whether the content type of the response is adequate for injection.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Processing Phases:</strong> 3 and 4.</p><p><strong>Example:</strong></p><pre><code>SecRule RESPONSE_CONTENT_TYPE &quot;^text/html&quot; &quot;nolog,id:99,pass,append:'&lt;hr&gt;Footer'&quot;
</code></pre><p>Warning : Although macro expansion is allowed in the additional content, you are strongly cautioned against inserting user-defined data fields into output. Doing so would create a cross-site scripting vulnerability.</p><h2 id=auditlog>auditlog <a href=#auditlog class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Marks the transaction for logging in the audit log.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REMOTE_ADDR &quot;^192\.168\.1\.100$&quot; &quot;auditlog,phase:1,id:100,allow&quot;
</code></pre><p>Note : The auditlog action is now explicit if log is already specified.</p><h2 id=block>block <a href=#block class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Performs the disruptive action defined by the previous <code>SecDefaultAction</code>.</p><p><strong>Action Group:</strong> Disruptive</p><p>This action is essentially a placeholder that is intended to be used by rule writers to request a blocking action, but without specifying how the blocking is to be done. The idea is that such decisions are best left to rule users, as well as to allow users, to override blocking if they so desire. In future versions of Coraza, more control and functionality will be added to define &ldquo;how&rdquo; to block.</p><p><strong>Examples:</strong></p><pre><code># Specify how blocking is to be done 
SecDefaultAction &quot;phase:2,deny,id:101,status:403,log,auditlog&quot;

# Detect attacks where we want to block 
SecRule ARGS &quot;@rx attack1&quot; &quot;phase:2,block,id:102&quot;

# Detect attacks where we want only to warn 
SecRule ARGS &quot;@rx attack2&quot; &quot;phase:2,pass,id:103&quot;
</code></pre><p>It is possible to use the <code>SecRuleUpdateActionById</code> directive to override how a rule handles blocking. This is useful in three cases:</p><ol><li>If a rule has blocking hard-coded, and you want it to use the policy you determine</li><li>If a rule was written to <code>block</code>, but you want it to only warn</li><li>If a rule was written to only <code>warn</code>, but you want it to block</li></ol><p>The following example demonstrates the first case, in which the hard-coded block is removed in favor of the user-controllable block:</p><pre><code># Specify how blocking is to be done 
SecDefaultAction &quot;phase:2,deny,status:403,log,auditlog,id:104&quot;

# Detect attacks and block 
SecRule ARGS &quot;@rx attack1&quot; &quot;phase:2,id:1,deny&quot;

# Change how rule ID 1 blocks 
SecRuleUpdateActionById 1 &quot;block&quot;
</code></pre><h2 id=capture>capture <a href=#capture class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: When used together with the regular expression operator <code>@rx</code>, the capture action creates a copy of the regular expression captures and places them into the transaction variable collection.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_BODY &quot;^username=(\w{25,})&quot; phase:2,capture,t:none,chain,id:105
  SecRule TX:1 &quot;(?:(?:a(dmin|nonymous)))&quot;
</code></pre><p>Up to 10 captures will be copied on a successful pattern match, each with a name consisting of a digit from 0 to 9. The <code>TX.0</code> variable always contains the entire area that the regular expression matched. All the other variables contain the captured values, in the order in which the capturing parentheses appear in the regular expression.</p><p>**This action is being forced by now, it might be reused in the future)</p><h2 id=chain>chain <a href=#chain class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Chains the current rule with the rule that immediately follows it, creating a rule chain. Chained rules allow for more complex processing logic.</p><p><strong>Action Group:</strong> Flow</p><p><strong>Example:</strong></p><pre><code class=language-bash># Refuse to accept POST requests that do not contain a Content-Length header. 
#
# Note: this rule should be preceded by a rule that verifies only valid
# request methods are used.
SecRule REQUEST_METHOD &quot;^POST$&quot; &quot;phase:1,chain,t:none,id:105&quot;
  SecRule &amp;REQUEST_HEADERS:Content-Length &quot;@eq 0&quot; &quot;t:none&quot;
</code></pre><p>Note : Rule chains allow you to simulate logical AND. The disruptive actions specified in the first portion of the chained rule will be triggered only if all of the variable checks return positive hits. If any one aspect of a chained rule comes back negative, then the entire rule chain will fail to match. Also note that disruptive actions, execution phases, metadata actions (id, rev, msg, tag, severity, logdata), skip, and skipAfter actions can be specified only by the chain starter rule.
The following directives can be used in rule chains:</p><ul><li><code>SecAction</code></li><li><code>SecRule</code></li><li><code>SecRuleScript</code></li></ul><p>Special rules control the usage of actions in chained rules:</p><ul><li>Any actions that affect the rule flow (i.e., the disruptive actions, <code>skip</code> and <code>skipAfter</code>) can be used only in the chain starter. They will be executed only if the entire chain matches.</li><li>Non-disruptive rules can be used in any rule; they will be executed if the rule that contains them matches and not only when the entire chain matches.</li><li>The metadata actions (e.g., <code>id</code>, <code>rev</code>, <code>msg</code>) can be used only in the chain starter.</li></ul><h2 id=ctl>ctl <a href=#ctl class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Changes Coraza configuration on transient, per-transaction basis. Any changes made using this action will affect only the transaction in which the action is executed. The default configuration, as well as the other transactions running in parallel, will be unaffected.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code># Parse requests with Content-Type &quot;text/xml&quot; as XML 
SecRule REQUEST_CONTENT_TYPE ^text/xml &quot;nolog,pass,id:106,ctl:requestBodyProcessor=XML&quot;

# white-list the user parameter for rule #981260 when the REQUEST_URI is /index.php
SecRule REQUEST_URI &quot;@beginsWith /index.php&quot; &quot;phase:1,t:none,pass,\
  nolog,ctl:ruleRemoveTargetById=981260;ARGS:user&quot;
</code></pre><p>The following configuration options are supported:</p><ul><li><code>auditEngine</code></li><li><code>auditLogParts</code></li><li><code>debugLogLevel</code></li><li><code>forceRequestBodyVariable</code></li><li><code>requestBodyAccess</code></li><li><code>requestBodyLimit</code></li><li><code>requestBodyProcessor</code></li><li><code>responseBodyAccess</code></li><li><code>responseBodyLimit</code></li><li><code>ruleEngine</code></li><li><code>ruleRemoveById</code> - since this action us triggered at run time, it should be specified before the rule in which it is disabling.</li><li><code>ruleRemoveByMsg</code></li><li><code>ruleRemoveByTag</code></li><li><code>ruleRemoveTargetById</code> - since this action is used to just remove targets, users don&rsquo;t need to use the char ! before the target list.</li><li><code>ruleRemoveTargetByMsg</code> - since this action is used to just remove targets, users don&rsquo;t need to use the char ! before the target list.</li><li><code>ruleRemoveTargetByTag</code> - since this action is used to just remove targets, users don&rsquo;t need to use the char ! before the target list.</li><li><code>hashEngine</code> (<strong>Supported on Coraza:</strong> TBI)</li><li><code>hashEnforcement</code> (<strong>Supported on Coraza:</strong> TBI)</li></ul><p>With the exception of the <code>requestBodyProcessor</code> and <code>forceRequestBodyVariable</code> settings, each configuration option corresponds to one configuration directive and the usage is identical.</p><p>The <code>requestBodyProcessor</code> option allows you to configure the request body processor. By default, Coraza will use the <code>URLENCODED</code> and <code>MULTIPART</code> processors to process an <code>application/x-www-form-urlencoded</code> and a <code>multipart/form-data</code> body, respectively. Other two processors are also supported: <code>JSON</code> and <code>XML</code>, but they are never used implicitly. Instead, you must tell Coraza to use it by placing a few rules in the <code>REQUEST_HEADERS</code> processing phase. After the request body is processed as XML, you will be able to use the XML-related features to inspect it.</p><p>Request body processors will not interrupt a transaction if an error occurs during parsing. Instead, they will set the variables <code>REQBODY_PROCESSOR_ERROR</code> and <code>REQBODY_PROCESSOR_ERROR_MSG</code>. These variables should be inspected in the <code>REQUEST_BODY</code> phase and an appropriate action taken. The forceRequestBodyVariable option allows you to configure the <code>REQUEST_BODY</code> variable to be set when there is no request body processor configured. This allows for inspection of request bodies of unknown types.</p><h2 id=deny>deny <a href=#deny class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Stops rule processing and intercepts transaction.</p><p><strong>Action Group:</strong> Disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;nikto&quot; &quot;log,deny,id:107,msg:'Nikto Scanners Identified'&quot;
</code></pre><h2 id=drop>drop <a href=#drop class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Initiates an immediate close of the TCP connection by sending a FIN packet.</p><p><strong>Action Group:</strong> Disruptive</p><p><strong>Example:</strong> The following example initiates an IP collection for tracking Basic Authentication attempts. If the client goes over the threshold of more than 25 attempts in 2 minutes, it will <code>DROP</code> subsequent connections.</p><pre><code>SecAction phase:1,id:109,initcol:ip=%{REMOTE_ADDR},nolog
SecRule ARGS:login &quot;!^$&quot; &quot;nolog,phase:1,id:110,setvar:ip.auth_attempt=+1,deprecatevar:ip.auth_attempt=25/120&quot;
SecRule IP:AUTH_ATTEMPT &quot;@gt 25&quot; &quot;log,drop,phase:1,id:111,msg:'Possible Brute Force Attack'&quot;
</code></pre><p><strong>Note :</strong> This action depends on each implementation, the server is instructed to drop the connection.</p><p>This action is extremely useful when responding to both Brute Force and Denial of Service attacks in that, in both cases, you want to minimize both the network bandwidth and the data returned to the client. This action causes error message to appear in the log &ldquo;(9)Bad file descriptor: core_output_filter: writing data to the network&rdquo;</p><h2 id=exec>exec <a href=#exec class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Executes an external script/binary supplied as parameter.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code># Run external program on rule match 
SecRule REQUEST_URI &quot;^/cgi-bin/script\.pl&quot; &quot;phase:2,id:112,t:none,t:lowercase,t:normalizePath,block,\ exec:/usr/local/apache/bin/test.sh&quot;

# Run Lua script on rule match 
SecRule ARGS:p attack &quot;phase:2,id:113,block,exec:/usr/local/apache/conf/exec.lua&quot;
</code></pre><p>The <code>exec</code> action is executed independently from any disruptive actions specified. External scripts will always be called with no parameters. Some transaction information will be placed in environment variables. All the usual CGI environment variables will be there. You should be aware that forking a threaded process results in all threads being replicated in the new process. Forking can therefore incur larger overhead in a multithreaded deployment. The script you execute must write something (anything) to stdout; if it doesn’t, Coraza will assume that the script failed, and will record the failure.</p><h2 id=expirevar>expirevar <a href=#expirevar class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Configures a collection variable to expire after the given time period (in seconds).</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_COOKIES:JSESSIONID &quot;!^$&quot; &quot;nolog,phase:1,id:114,pass,setsid:%{REQUEST_COOKIES:JSESSIONID}&quot;
SecRule REQUEST_URI &quot;^/cgi-bin/script\.pl&quot; &quot;phase:2,id:115,t:none,t:lowercase,t:normalizePath,log,allow,\
    setvar:session.suspicious=1,expirevar:session.suspicious=3600,phase:1&quot;
</code></pre><p>You should use the expirevar actions at the same time that you use setvar actions in order to keep the intended expiration time. If they are used on their own (perhaps in a SecAction directive), the expire time will be reset.</p><h2 id=id>id <a href=#id class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Assigns a unique ID to the rule or chain in which it appears. This action is mandatory and must be numeric.</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule &amp;REQUEST_HEADERS:Host &quot;@eq 0&quot; &quot;log,id:60008,severity:2,msg:'Request Missing a Host Header'&quot;
</code></pre><p>Note : The id action is required for all SecRule/SecAction.</p><h2 id=initcol>initcol <a href=#initcol class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Initializes a named persistent collection, either by loading data from storage or by creating a new collection in memory.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Example:</strong> The following example initiates IP address tracking, which is best done in phase 1:</p><pre><code>SecAction &quot;phase:1,id:116,nolog,pass,initcol:ip=%{REMOTE_ADDR}&quot;
</code></pre><p>Collections are loaded into memory on-demand, when the initcol action is executed. A collection will be persisted only if a change was made to it in the course of transaction processing.</p><p>See the &ldquo;Persistent Storage&rdquo; section for further details.</p><h2 id=log>log <a href=#log class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Indicates that a successful match of the rule needs to be logged.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecAction &quot;phase:1,id:117,pass,initcol:ip=%{REMOTE_ADDR},log&quot;
</code></pre><p>This action will log matches to the Apache error log file and the Coraza audit log.</p><h2 id=logdata>logdata <a href=#logdata class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Logs a data fragment as part of the alert message.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule ARGS:p &quot;@rx &lt;script&gt;&quot; &quot;phase:2,id:118,log,pass,logdata:%{MATCHED_VAR}&quot;
</code></pre><p>The logdata information appears in the error and/or audit log files. Macro expansion is performed, so you may use variable names such as %{TX.0} or %{MATCHED_VAR}. The information is properly escaped for use with logging of binary data.</p><h2 id=maturity>maturity <a href=#maturity class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Specifies the relative maturity level of the rule related to the length of time a rule has been public and the amount of testing it has received. The value is a string based on a numeric scale (1-9 where 9 is extensively tested and 1 is a brand new experimental rule).</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;\bgetparentfolder\b&quot; \
    &quot;phase:2,ver:'CRS/2.2.4,accuracy:'9',maturity:'9',capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',id:'958016',tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'% \
{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;
</code></pre><h2 id=msg>msg <a href=#msg class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Assigns a custom message to the rule or chain in which it appears. The message will be logged along with every alert.</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule &amp;REQUEST_HEADERS:Host &quot;@eq 0&quot; &quot;log,id:60008,severity:2,msg:'Request Missing a Host Header'&quot;
</code></pre><p>Note : The msg information appears in the error and/or audit log files and is not sent back to the client in response headers.</p><h2 id=multimatch>multiMatch <a href=#multimatch class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: If enabled, Coraza will perform multiple operator invocations for every target, before and after every anti-evasion transformation is performed.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule ARGS &quot;attack&quot; &quot;phase1,log,deny,id:119,t:removeNulls,t:lowercase,multiMatch&quot;
</code></pre><p>Normally, variables are inspected only once per rule, and only after all transformation functions have been completed. With multiMatch, variables are checked against the operator before and after every transformation function that changes the input.</p><h2 id=noauditlog>noauditlog <a href=#noauditlog class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Indicates that a successful match of the rule should not be used as criteria to determine whether the transaction should be logged to the audit log.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;@streq Test&quot; &quot;allow,noauditlog,id:120&quot;
</code></pre><p>If the SecAuditEngine is set to On, all of the transactions will be logged. If it is set to RelevantOnly, then you can control the logging with the noauditlog action.</p><p>The noauditlog action affects only the current rule. If you prevent audit logging in one rule only, a match in another rule will still cause audit logging to take place. If you want to prevent audit logging from taking place, regardless of whether any rule matches, use ctl:auditEngine=Off.</p><h2 id=nolog>nolog <a href=#nolog class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Prevents rule matches from appearing in both the error and audit logs.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;@streq Test&quot; &quot;allow,nolog,id:121&quot;
</code></pre><p>Although nolog implies noauditlog, you can override the former by using nolog,auditlog.</p><h2 id=pass>pass <a href=#pass class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Continues processing with the next rule in spite of a successful match.</p><p><strong>Action Group:</strong> Disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;@streq Test&quot; &quot;log,pass,id:122&quot;
</code></pre><p>When using pass with a SecRule with multiple targets, all variables will be inspected and all non-disruptive actions trigger for every match. In the following example, the TX.test variable will be incremented once for every request parameter:</p><pre><code># Set TX.test to zero 
SecAction &quot;phase:2,nolog,pass,setvar:TX.test=0,id:123&quot;

# Increment TX.test for every request parameter 
SecRule ARGS &quot;test&quot; &quot;phase:2,log,pass,setvar:TX.test=+1,id:124&quot;
</code></pre><h2 id=pause>pause <a href=#pause class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Pauses transaction processing for the specified number of milliseconds. This feature also supports macro expansion.</p><p><strong>Action Group:</strong> Disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;Test&quot; &quot;log,pause:5000,id:125&quot;
</code></pre><p>Warning : This feature can be of limited benefit for slowing down brute force authentication attacks, but use with care. If you are under a denial of service attack, the pause feature may make matters worse, as it will cause an entire Apache worker (process or thread, depending on the deployment mode) to sit idle until the pause is completed.</p><h2 id=phase>phase <a href=#phase class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Places the rule or chain into one of five available processing phases. It can also be used in <code>SecDefaultAction</code> to establish the rule defaults.</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code># Initialize IP address tracking in phase 1
SecAction phase:1,nolog,pass,id:126,initcol:IP=%{REMOTE_ADDR}
</code></pre><p>There are aliases for some phase numbers:</p><ul><li>2 - request</li><li>4 - response</li><li>5 - logging</li></ul><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;Test&quot; &quot;phase:request,log,deny,id:127&quot;
</code></pre><p>Warning : Keep in mind that if you specify the incorrect phase, the variable used in the rule may not yet be available. This could lead to a false negative situation where your variable and operator may be correct, but it misses malicious data because you specified the wrong phase.</p><h2 id=prepend>prepend <a href=#prepend class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Prepends the text given as parameter to response body. Content injection must be enabled (using the SecContentInjection directive). No content type checks are made, which means that before using any of the content injection actions, you must check whether the content type of the response is adequate for injection.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Processing Phases:</strong> 3 and 4.</p><p><strong>Example:</strong></p><pre><code>SecRule RESPONSE_CONTENT_TYPE &quot;^text/html&quot; &quot;phase:3,nolog,pass,id:128,prepend:'Header&lt;br&gt;'&quot;
</code></pre><p>Warning : Although macro expansion is allowed in the injected content, you are strongly cautioned against inserting user defined data fields int output. Doing so would create a cross-site scripting vulnerability.</p><h2 id=proxy>proxy <a href=#proxy class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Intercepts the current transaction by forwarding the request to another web server using the proxy backend. The forwarding is carried out transparently to the HTTP client (i.e., there’s no external redirection taking place).</p><p><strong>Action Group:</strong> Disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;@streq Test&quot; &quot;log,id:129,proxy:http://honeypothost/&quot;
SecRule REQUEST_URI &quot;@streq /test.txt&quot; &quot;phase:1,proxy:'http://$ENV{SERVER_NAME}:$ENV{SERVER_PORT}/test.txt',id:500005&quot;
</code></pre><p>For this action to work, the implementation must handle the proxy connection after the interruption notification.</p><h2 id=redirect>redirect <a href=#redirect class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Intercepts transaction by issuing an external (client-visible) redirection to the given location..</p><p><strong>Action Group:</strong> Disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_HEADERS:User-Agent &quot;@streq Test&quot; &quot;phase:1,id:130,log,redirect:http://www.example.com/failed.html&quot;
</code></pre><p>If the status action is present on the same rule, and its value can be used for a redirection (i.e., is one of the following: 301, 302, 303, or 307), the value will be used for the redirection status code. Otherwise, status code 302 will be used.</p><h2 id=rev>rev <a href=#rev class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Specifies rule revision. It is useful in combination with the id action to provide an indication that a rule has been changed.</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;(?:(?:[\;\|\`]\W*?\bcc|\b(wget|curl))\b|\/cc(?:[\'\&quot;\|\;\`\-\s]|$))&quot; \
    &quot;phase:2,rev:'2.1.3',capture,t:none,t:normalizePath,t:lowercase,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'950907',tag:'WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%{tx.0},skipAfter:END_COMMAND_INJECTION1&quot;
</code></pre><p>Note : This action is used in combination with the id action to allow the same rule ID to be used after changes take place but to still provide some indication the rule changed.</p><h2 id=sanitisearg>sanitiseArg <a href=#sanitisearg class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Prevents sensitive request parameter data from being logged to audit log. Each byte of the named parameter(s) is replaced with an asterisk.</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code># Never log passwords 
SecAction &quot;nolog,phase:2,id:131,sanitiseArg:password,sanitiseArg:newPassword,sanitiseArg:oldPassword&quot;
</code></pre><p>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</p><h2 id=sanitisematched>sanitiseMatched <a href=#sanitisematched class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Prevents the matched variable (request argument, request header, or response header) from being logged to audit log. Each byte of the named parameter(s) is replaced with an asterisk.</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong> This action can be used to sanitise arbitrary transaction elements when they match a condition. For example, the example below will sanitise any argument that contains the word password in the name.</p><pre><code>SecRule ARGS_NAMES password nolog,pass,id:132,sanitiseMatched
</code></pre><p>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</p><h2 id=sanitisematchedbytes>sanitiseMatchedBytes <a href=#sanitisematchedbytes class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Prevents the matched string in a variable from being logged to audit log. Each or a range of bytes of the named parameter(s) is replaced with an asterisk.</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong> This action can be used to sanitise arbitrary transaction elements when they match a condition. For example, the example below will sanitise the credit card number.</p><ul><li><code>sanitiseMatchedBytes</code> &ndash; This would x out only the bytes that matched.</li><li><code>sanitiseMatchedBytes</code>:1/4 &ndash; This would x out the bytes that matched, but keep the first byte and last 4 bytes</li></ul><pre><code># Detect credit card numbers in parameters and 
# prevent them from being logged to audit log 
SecRule ARGS &quot;@verifyCC \d{13,16}&quot; &quot;phase:2,id:133,nolog,capture,pass,msg:'Potential credit card number in request',sanitiseMatchedBytes&quot;
SecRule RESPONSE_BODY &quot;@verifyCC \d{13,16}&quot; &quot;phase:4,id:134,t:none,log,capture,block,msg:'Potential credit card number is response body',sanitiseMatchedBytes:0/4&quot;
</code></pre><p>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI. You must use capture action with sanitiseMatchedBytes, so the operator must support capture action. ie: @rx, @verifyCC.</p><h2 id=sanitiserequestheader>sanitiseRequestHeader <a href=#sanitiserequestheader class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Prevents a named request header from being logged to audit log. Each byte of the named request header is replaced with an asterisk.</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong> This will sanitise the data in the Authorization header.</p><pre><code>SecAction &quot;phase:1,nolog,pass,id:135,sanitiseRequestHeader:Authorization&quot;
</code></pre><p>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</p><h2 id=sanitiseresponseheader>sanitiseResponseHeader <a href=#sanitiseresponseheader class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Prevents a named response header from being logged to audit log. Each byte of the named response header is replaced with an asterisk.</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong> This will sanitise the Set-Cookie data sent to the client.</p><pre><code>SecAction &quot;phase:3,nolog,pass,id:136,sanitiseResponseHeader:Set-Cookie&quot;
</code></pre><p>Note : The sanitize actions affect only the data as it is logged to audit log. High-level debug logs may contain sensitive data. Apache access log may contain sensitive data placed in the request URI.</p><h2 id=severity>severity <a href=#severity class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Assigns severity to the rule in which it is used.</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_METHOD &quot;^PUT$&quot; &quot;id:340002,rev:1,severity:CRITICAL,msg:'Restricted HTTP function'&quot;
</code></pre><p>Severity values in Coraza follows the numeric scale of syslog (where 0 is the most severe). The data below is used by the OWASP Core Rule Set (CRS):</p><ul><li><strong>0 - EMERGENCY</strong>: is generated from correlation of anomaly scoring data where there is an inbound attack and an outbound leakage.</li><li><strong>1 - ALERT</strong>: is generated from correlation where there is an inbound attack and an outbound application level error.</li><li><strong>2 CRITICAL</strong>: Anomaly Score of 5. Is the highest severity level possible without correlation. It is normally generated by the web attack rules (40 level files).</li><li><strong>3 - ERROR</strong>: Error - Anomaly Score of 4. Is generated mostly from outbound leakage rules (50 level files).</li><li><strong>4 - WARNING</strong>: Anomaly Score of 3. Is generated by malicious client rules (35 level files).</li><li><strong>5 - NOTICE</strong>: Anomaly Score of 2. Is generated by the Protocol policy and anomaly files.</li><li><strong>6 - INFO</strong></li><li><strong>7 - DEBUG</strong></li></ul><p>It is possible to specify severity levels using either the numerical values or the text values, but you should always specify severity levels using the text values, because it is difficult to remember what a number stands for. The use of the numerical values is deprecated as of version 2.5.0 and may be removed in one of the subsequent major updates.</p><h2 id=setuid>setuid <a href=#setuid class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Special-purpose action that initializes the USER collection using the username provided as parameter.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Example:</strong></p><pre><code>SecRule ARGS:username &quot;.*&quot; &quot;phase:2,id:137,t:none,pass,nolog,noauditlog,capture,setvar:session.username=%{TX.0},setuid:%{TX.0}&quot;
</code></pre><p>After initialization takes place, the variable USERID will be available for use in the subsequent rules. This action understands application namespaces (configured using SecWebAppId), and will use one if it is configured.</p><h2 id=setrsc>setrsc <a href=#setrsc class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Special-purpose action that initializes the RESOURCE collection using a key provided as parameter.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Example:</strong></p><pre><code>SecAction &quot;phase:1,pass,id:3,log,setrsc:'abcd1234'&quot;
</code></pre><p>This action understands application namespaces (configured using SecWebAppId), and will use one if it is configured.</p><h2 id=setsid>setsid <a href=#setsid class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Special-purpose action that initializes the SESSION collection using the session token provided as parameter.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Example:</strong></p><pre><code># Initialise session variables using the session cookie value 
SecRule REQUEST_COOKIES:PHPSESSID !^$ &quot;nolog,pass,id:138,setsid:%{REQUEST_COOKIES.PHPSESSID}&quot;
</code></pre><p><strong>Note:</strong> After the initialization takes place, the variable <code>SESSION</code> will be available for use in the subsequent rules. This action understands application namespaces (configured using <code>SecWebAppId</code>), and will use one if it is configured.</p><p>Setsid takes an individual variable, not a collection. Variables within an action, such as setsid, use the format [collection].[variable] .</p><h2 id=setenv>setenv <a href=#setenv class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Creates, removes, and updates environment variables that can be accessed by the implementation.</p><p><strong>Action Group:</strong> Non-disruptive</p><p>Examples:</p><pre><code>SecRule RESPONSE_HEADERS:/Set-Cookie2?/ &quot;(?i:(j?sessionid|(php)?sessid|(asp|jserv|jw)?session[-_]?(id)?|cf(id|token)|sid))&quot; &quot;phase:3,t:none,pass,id:139,nolog,setvar:tx.sessionid=%{matched_var}&quot;
SecRule TX:SESSIONID &quot;!(?i:\;? ?httponly;?)&quot; &quot;phase:3,id:140,t:none,setenv:httponly_cookie=%{matched_var},pass,log,auditlog,msg:'AppDefect: Missing HttpOnly Cookie Flag.'&quot;
</code></pre><pre><code class=language-apache>Header set Set-Cookie &quot;%{httponly_cookie}e; HTTPOnly&quot; env=httponly_cookie
</code></pre><p>Note : When used in a chain this action will be execute when an individual rule matches and not the entire chain.</p><h2 id=setvar>setvar <a href=#setvar class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Creates, removes, or updates a variable. Variable names are case-insensitive.</p><p><strong>Action Group:</strong> Non-disruptive</p><p>Examples: To create a variable and set its value to 1 (usually used for setting flags), use: <code>setvar:TX.score</code></p><p>To create a variable and initialize it at the same time, use: <code>setvar:TX.score=10</code></p><p>To remove a variable, prefix the name with an exclamation mark: <code>setvar:!TX.score</code></p><p>To increase or decrease variable value, use + and - characters in front of a numerical value: <code>setvar:TX.score=+5</code></p><p>Example from OWASP CRS:</p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;\bsys\.user_catalog\b&quot; \
  &quot;phase:2,rev:'2.1.3',capture,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,t:replaceComments,t:compressWhiteSpace,ctl:auditLogParts=+E, \
block,msg:'Blind SQL Injection Attack',id:'959517',tag:'WEB_ATTACK/SQL_INJECTION',tag:'WASCTC/WASC-19',tag:'OWASP_TOP_10/A1',tag:'OWASP_AppSensor/CIE1', \
tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score}, \
setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/SQL_INJECTION-%{matched_var_name}=%{tx.0}&quot;
</code></pre><p>Note : When used in a chain this action will be executed when an individual rule matches and not the entire chain.This means that</p><pre><code>SecRule REQUEST_FILENAME &quot;@contains /test.php&quot; &quot;chain,id:7,phase:1,t:none,nolog,setvar:tx.auth_attempt=+1&quot; 
    SecRule ARGS_POST:action &quot;@streq login&quot; &quot;t:none&quot;
</code></pre><p>will increment every time that test.php is visited (regardless of the parameters submitted). If the desired goal is to set the variable only if the entire rule matches, it should be included in the last rule of the chain. For instance:</p><pre><code>SecRule REQUEST_FILENAME &quot;@streq test.php&quot; &quot;chain,id:7,phase:1,t:none,nolog&quot;
    SecRule ARGS_POST:action &quot;@streq login&quot; &quot;t:none,setvar:tx.auth_attempt=+1&quot;

</code></pre><h2 id=skip>skip <a href=#skip class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Skips one or more rules (or chains) on successful match.</p><p><strong>Action Group:</strong> Flow</p><p><strong>Example:</strong></p><pre><code># Require Accept header, but not from access from the localhost 
SecRule REMOTE_ADDR &quot;^127\.0\.0\.1$&quot; &quot;phase:1,skip:1,id:141&quot; 

# This rule will be skipped over when REMOTE_ADDR is 127.0.0.1 
SecRule &amp;REQUEST_HEADERS:Accept &quot;@eq 0&quot; &quot;phase:1,id:142,deny,msg:'Request Missing an Accept Header'&quot;
</code></pre><p>The <code>skip</code> action works only within the current processing phase and not necessarily in the order in which the rules appear in the configuration file. If you place a phase 2 rule after a phase 1 rule that uses skip, it will not skip over the phase 2 rule. It will skip over the next phase 1 rule that follows it in the phase.</p><h2 id=skipafter>skipAfter <a href=#skipafter class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Skips one or more rules (or chains) on a successful match, resuming rule execution with the first rule that follows the rule (or marker created by SecMarker) with the provided ID.</p><p><strong>Action Group:</strong> Flow</p><p><strong>Example:</strong> The following rules implement the same logic as the skip example, but using skipAfter:</p><pre><code># Require Accept header, but not from access from the localhost 
SecRule REMOTE_ADDR &quot;^127\.0\.0\.1$&quot; &quot;phase:1,id:143,skipAfter:IGNORE_LOCALHOST&quot; 

# This rule will be skipped over when REMOTE_ADDR is 127.0.0.1 
SecRule &amp;REQUEST_HEADERS:Accept &quot;@eq 0&quot; &quot;phase:1,deny,id:144,msg:'Request Missing an Accept Header'&quot; 
SecMarker IGNORE_LOCALHOST
</code></pre><p>Example from the OWASP CRS:</p><pre><code>SecMarker BEGIN_HOST_CHECK

 SecRule &amp;REQUEST_HEADERS:Host &quot;@eq 0&quot; \
      &quot;skipAfter:END_HOST_CHECK,phase:2,rev:'2.1.3',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21', \
tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score}, \
setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;

 SecRule REQUEST_HEADERS:Host &quot;^$&quot; \
      &quot;phase:2,rev:'2.1.3',t:none,block,msg:'Request Missing a Host Header',id:'960008',tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7', \
tag:'PCI/6.5.10',severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score}, \
setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;

SecMarker END_HOST_CHECK
</code></pre><p>The <code>skipAfter</code> action works only within the current processing phase and not necessarily the order in which the rules appear in the configuration file. If you place a phase 2 rule after a phase 1 rule that uses skip, it will not skip over the phase 2 rule. It will skip over the next phase 1 rule that follows it in the phase.</p><h2 id=status>status <a href=#status class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Specifies the response status code to use with actions deny and redirect.</p><p><strong>Action Group:</strong> Data</p><p><strong>Example:</strong></p><pre><code># Deny with status 403
SecDefaultAction &quot;phase:1,log,deny,id:145,status:403&quot;
</code></pre><h2 id=t>t <a href=#t class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: This action is used to specify the transformation pipeline to use to transform the value of each variable used in the rule before matching.</p><p><strong>Action Group:</strong> Non-disruptive</p><p><strong>Example:</strong></p><pre><code>SecRule ARGS &quot;(asfunction|javascript|vbscript|data|mocha|livescript):&quot; &quot;id:146,t:none,t:htmlEntityDecode,t:lowercase,t:removeNulls,t:removeWhitespace&quot;
</code></pre><p>Any transformation functions that you specify in a SecRule will be added to the previous ones specified in <code>SecDefaultAction</code>. It is recommended that you always use t:none in your rules, which prevents them depending on the default configuration.</p><h2 id=tag>tag <a href=#tag class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Assigns a tag (category) to a rule or a chain.</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;\bgetparentfolder\b&quot; \
 &quot;phase:2,rev:'2.1.3',capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',id:'958016',tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'% \
{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;
</code></pre><p>The tag information appears along with other rule metadata. The purpose of the tagging mechanism to allow easy automated categorization of events. Multiple tags can be specified on the same rule. Use forward slashes to create a hierarchy of categories (as in the example). Tag support Macro Expansions</p><h2 id=ver>ver <a href=#ver class=anchor aria-hidden=true>#</a></h2><p><strong>Description</strong>: Specifies the rule set version.</p><p><strong>Action Group:</strong> Meta-data</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;\bgetparentfolder\b&quot; \
 &quot;phase:2,ver:'CRS/2.2.4,capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,msg:'Cross-site Scripting (XSS) Attack',id:'958016',tag:'WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'% \
{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;
</code></pre><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/seclang/actions.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/seclang/syntax/><div class="card my-1"><div class="card-body py-2">&larr; Syntax</div></div></a><a class=ms-auto href=https://coraza.io/docs/seclang/execution-flow/><div class="card my-1"><div class="card-body py-2">Execution flow &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ❤️ (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.f06fe6dc0efc9ee1e806021a0c338278256ecf163b547e8e8769fe60b0a1c0d505782852616ca4e1ff6a719eb8fc954e1d26031b8ab3ca71fb9d9998081b319e.js integrity="sha512-8G/m3A78nuHoBgIaDDOCeCVuzxY7VH6Oh2n+YLChwNUFeChSYWyk4f9qcZ64/JVOHSYDG4qzynH7nZmYCBsxng==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.5c42765ed4daf59624a6e775bdc4bc68bba6664f4d678ecbc55390f986b6852e562c726fb5fd57b078713aa5aef95ebac205fe24f3d998ab84e10b6b28c413ee.js integrity="sha512-XEJ2XtTa9ZYkpud1vcS8aLumZk9NZ47LxVOQ+Ya2hS5WLHJvtf1XsHhxOqWu+V66wgX+JPPZmKuE4QtrKMQT7g==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.3bb8f119f63c6e06aa99acc71b7037b0c5461db421d5a169df0b668ca079081263bcc72dccff7584205495b398338b1da5ab6051c7fd7d0dc8a29c73e0a86c97.js integrity="sha512-O7jxGfY8bgaqmazHG3A3sMVGHbQh1aFp3wtmjKB5CBJjvMctzP91hCBUlbOYM4sdpatgUcf9fQ3Iopxz4Khslw==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.cdbb8d22808922eaf383e333a9859ee124264202d94d624a8f4632d420a8e467174a8f7ffa7c2d5926065063a5ac4b71e8f60e8f5100ed42245ba7efd885eb82.js integrity="sha512-zbuNIoCJIurzg+MzqYWe4SQmQgLZTWJKj0Yy1CCo5GcXSo9/+nwtWSYGUGOlrEtx6PYOj1EA7UIkW6fv2IXrgg==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>