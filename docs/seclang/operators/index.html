<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://coraza.io/main.e9d56aaf8618abb2dc3143a1f6077bd0f5a50ea13c2743a5134a1a7cdc6ad41db01a85514ed59078656efa6356ad40048b97a84e37ed41fa4e6ddaff26b746c2.css integrity="sha512-6dVqr4YYq7LcMUOh9gd70PWlDqE8J0OlE0oafNxq1B2wGoVRTtWQeGVu+mNWrUAEi5eoTjftQfpObdr/JrdGwg==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Operators - OWASP Coraza</title>
<meta name=description content="This section documents the operators currently available in Coraza."><link rel=canonical href=https://coraza.io/docs/seclang/operators/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Operators"><meta property="og:description" content="This section documents the operators currently available in Coraza."><meta property="og:url" content="https://coraza.io/docs/seclang/operators/"><meta property="og:site_name" content="OWASP Coraza"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/images/logo_animal_only.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Operators"><meta name=twitter:description content="This section documents the operators currently available in Coraza."><meta name=twitter:image content="https://coraza.io/images/logo_animal_only.png"><meta name=twitter:image:alt content="Operators"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/operators/","url":"https://coraza.io/docs/seclang/operators/","name":"Operators","description":"This section documents the operators currently available in Coraza.","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/operators/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/operators/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/operators/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/operators/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/operators/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Operators","description":"This section documents the operators currently available in Coraza.","isPartOf":{"@id":"https://coraza.io/docs/seclang/operators/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/operators/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/operators/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso and Coraza contributors","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/operators/#/schema/image/2","url":"https://coraza.io/images/logo_animal_only.png","contentUrl":"https://coraza.io/images/logo_animal_only.png","caption":"Operators"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza
</a><button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 üÜï</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 üÜï</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#beginswith>beginsWith</a></li><li><a href=#contains>contains</a></li><li><a href=#containsword>containsWord</a></li><li><a href=#detectsqli>detectSQLi</a></li><li><a href=#detectxss>detectXSS</a></li><li><a href=#endswith>endsWith</a></li><li><a href=#eq>eq</a></li><li><a href=#fuzzyhash>fuzzyHash</a></li><li><a href=#ge>ge</a></li><li><a href=#geolookup>geoLookup</a></li><li><a href=#gt>gt</a></li><li><a href=#inspectfile>inspectFile</a></li><li><a href=#ipmatch>ipMatch</a></li><li><a href=#ipmatchf>ipMatchF</a></li><li><a href=#ipmatchfromdataset>ipMatchFromDataSet</a></li><li><a href=#ipmatchfromfile>ipMatchFromFile</a></li><li><a href=#le>le</a></li><li><a href=#lt>lt</a></li><li><a href=#nomatch>noMatch</a></li><li><a href=#pm>pm</a></li><li><a href=#pmf>pmf</a></li><li><a href=#pmfromdataset>pmFromDataset</a></li><li><a href=#pmfromfile>pmFromFile</a></li><li><a href=#rbl>rbl</a></li><li><a href=#restpath>restpath</a></li><li><a href=#rsub>rsub</a></li><li><a href=#rx>rx</a></li><li><a href=#streq>streq</a></li><li><a href=#strmatch>strmatch</a></li><li><a href=#unconditionalmatch>unconditionalMatch</a></li><li><a href=#validatebyterange>validateByteRange</a></li><li><a href=#validatehash>validateHash</a></li><li><a href=#validatenid>validateNid</a></li><li><a href=#validateurlencoding>validateUrlEncoding</a></li><li><a href=#validateutf8encoding>validateUtf8Encoding</a></li><li><a href=#verifycc>verifyCC</a></li><li><a href=#within>within</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#beginswith>beginsWith</a></li><li><a href=#contains>contains</a></li><li><a href=#containsword>containsWord</a></li><li><a href=#detectsqli>detectSQLi</a></li><li><a href=#detectxss>detectXSS</a></li><li><a href=#endswith>endsWith</a></li><li><a href=#eq>eq</a></li><li><a href=#fuzzyhash>fuzzyHash</a></li><li><a href=#ge>ge</a></li><li><a href=#geolookup>geoLookup</a></li><li><a href=#gt>gt</a></li><li><a href=#inspectfile>inspectFile</a></li><li><a href=#ipmatch>ipMatch</a></li><li><a href=#ipmatchf>ipMatchF</a></li><li><a href=#ipmatchfromdataset>ipMatchFromDataSet</a></li><li><a href=#ipmatchfromfile>ipMatchFromFile</a></li><li><a href=#le>le</a></li><li><a href=#lt>lt</a></li><li><a href=#nomatch>noMatch</a></li><li><a href=#pm>pm</a></li><li><a href=#pmf>pmf</a></li><li><a href=#pmfromdataset>pmFromDataset</a></li><li><a href=#pmfromfile>pmFromFile</a></li><li><a href=#rbl>rbl</a></li><li><a href=#restpath>restpath</a></li><li><a href=#rsub>rsub</a></li><li><a href=#rx>rx</a></li><li><a href=#streq>streq</a></li><li><a href=#strmatch>strmatch</a></li><li><a href=#unconditionalmatch>unconditionalMatch</a></li><li><a href=#validatebyterange>validateByteRange</a></li><li><a href=#validatehash>validateHash</a></li><li><a href=#validatenid>validateNid</a></li><li><a href=#validateurlencoding>validateUrlEncoding</a></li><li><a href=#validateutf8encoding>validateUtf8Encoding</a></li><li><a href=#verifycc>verifyCC</a></li><li><a href=#within>within</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Operators</li></ol></nav><h1>Operators</h1><p class=lead>This section documents the operators currently available in Coraza.</p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#beginswith>beginsWith</a></li><li><a href=#contains>contains</a></li><li><a href=#containsword>containsWord</a></li><li><a href=#detectsqli>detectSQLi</a></li><li><a href=#detectxss>detectXSS</a></li><li><a href=#endswith>endsWith</a></li><li><a href=#eq>eq</a></li><li><a href=#fuzzyhash>fuzzyHash</a></li><li><a href=#ge>ge</a></li><li><a href=#geolookup>geoLookup</a></li><li><a href=#gt>gt</a></li><li><a href=#inspectfile>inspectFile</a></li><li><a href=#ipmatch>ipMatch</a></li><li><a href=#ipmatchf>ipMatchF</a></li><li><a href=#ipmatchfromdataset>ipMatchFromDataSet</a></li><li><a href=#ipmatchfromfile>ipMatchFromFile</a></li><li><a href=#le>le</a></li><li><a href=#lt>lt</a></li><li><a href=#nomatch>noMatch</a></li><li><a href=#pm>pm</a></li><li><a href=#pmf>pmf</a></li><li><a href=#pmfromdataset>pmFromDataset</a></li><li><a href=#pmfromfile>pmFromFile</a></li><li><a href=#rbl>rbl</a></li><li><a href=#restpath>restpath</a></li><li><a href=#rsub>rsub</a></li><li><a href=#rx>rx</a></li><li><a href=#streq>streq</a></li><li><a href=#strmatch>strmatch</a></li><li><a href=#unconditionalmatch>unconditionalMatch</a></li><li><a href=#validatebyterange>validateByteRange</a></li><li><a href=#validatehash>validateHash</a></li><li><a href=#validatenid>validateNid</a></li><li><a href=#validateurlencoding>validateUrlEncoding</a></li><li><a href=#validateutf8encoding>validateUtf8Encoding</a></li><li><a href=#verifycc>verifyCC</a></li><li><a href=#within>within</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#beginswith>beginsWith</a></li><li><a href=#contains>contains</a></li><li><a href=#containsword>containsWord</a></li><li><a href=#detectsqli>detectSQLi</a></li><li><a href=#detectxss>detectXSS</a></li><li><a href=#endswith>endsWith</a></li><li><a href=#eq>eq</a></li><li><a href=#fuzzyhash>fuzzyHash</a></li><li><a href=#ge>ge</a></li><li><a href=#geolookup>geoLookup</a></li><li><a href=#gt>gt</a></li><li><a href=#inspectfile>inspectFile</a></li><li><a href=#ipmatch>ipMatch</a></li><li><a href=#ipmatchf>ipMatchF</a></li><li><a href=#ipmatchfromdataset>ipMatchFromDataSet</a></li><li><a href=#ipmatchfromfile>ipMatchFromFile</a></li><li><a href=#le>le</a></li><li><a href=#lt>lt</a></li><li><a href=#nomatch>noMatch</a></li><li><a href=#pm>pm</a></li><li><a href=#pmf>pmf</a></li><li><a href=#pmfromdataset>pmFromDataset</a></li><li><a href=#pmfromfile>pmFromFile</a></li><li><a href=#rbl>rbl</a></li><li><a href=#restpath>restpath</a></li><li><a href=#rsub>rsub</a></li><li><a href=#rx>rx</a></li><li><a href=#streq>streq</a></li><li><a href=#strmatch>strmatch</a></li><li><a href=#unconditionalmatch>unconditionalMatch</a></li><li><a href=#validatebyterange>validateByteRange</a></li><li><a href=#validatehash>validateHash</a></li><li><a href=#validatenid>validateNid</a></li><li><a href=#validateurlencoding>validateUrlEncoding</a></li><li><a href=#validateutf8encoding>validateUtf8Encoding</a></li><li><a href=#verifycc>verifyCC</a></li><li><a href=#within>within</a></li></ul></nav></div></nav><h2 id=beginswith>beginsWith <a href=#beginswith class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Returns true if the parameter string is found at the beginning of the input. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect request line that does not begin with &quot;GET&quot;
SecRule REQUEST_LINE &quot;!@beginsWith GET&quot; &quot;id:149&quot;
</code></pre><h2 id=contains>contains <a href=#contains class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Returns true if the parameter string is found anywhere in the input. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect &quot;.php&quot; anywhere in the request line
SecRule REQUEST_LINE &quot;@contains .php&quot; &quot;id:150&quot;
</code></pre><h2 id=containsword>containsWord <a href=#containsword class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Returns true if the parameter string (with word boundaries) is found anywhere in the input. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect &quot;select&quot; anywhere in ARGS
SecRule ARGS &quot;@containsWord select&quot; &quot;id:151&quot;
</code></pre><p>Would match on -
-1 union select BENCHMARK(2142500,MD5(CHAR(115,113,108,109,97,112))) FROM wp_users WHERE ID=1 and (ascii(substr(user_login,1,1))&amp;0x01=0) from wp_users where ID=1&ndash;</p><p>But not on -
Your site has a wide selection of computers.</p><h2 id=detectsqli>detectSQLi <a href=#detectsqli class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Returns true if SQL injection payload is found. This operator uses LibInjection to detect SQLi attacks.</p><p><strong>Example</strong>:</p><pre><code class=language-seclang># Detect SQL Injection inside request uri data&quot;
SecRule REQUEST_URI &quot;@detectSQLi&quot; &quot;id:152&quot;
</code></pre><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=detectxss>detectXSS <a href=#detectxss class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Returns true if XSS injection is found. This operator uses LibInjection to detect XSS attacks.</p><p><strong>Example:</strong></p><pre><code class=language-seclang># Detect XSS Injection inside request body
SecRule REQUEST_BODY &quot;@detectXSS&quot; &quot;id:12345,log,deny&quot;
</code></pre><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=endswith>endsWith <a href=#endswith class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Returns <em>true</em> if the parameter string is found at the end of the input. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect request line that does not end with &quot;HTTP/1.1&quot;
SecRule REQUEST_LINE &quot;!@endsWith HTTP/1.1&quot; &quot;id:152&quot;
</code></pre><h2 id=eq>eq <a href=#eq class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs numerical comparison and returns true if the input value is equal to the provided parameter. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect exactly 15 request headers
SecRule &amp;REQUEST_HEADERS_NAMES &quot;@eq 15&quot; &quot;id:153&quot;
</code></pre><p><strong>Note:</strong> If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</p><h2 id=fuzzyhash>fuzzyHash <a href=#fuzzyhash class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> The <code>fuzzyHash</code> operator uses the ssdeep, which is a program for computing context triggered piecewise hashes (CTPH). Also called fuzzy hashes, CTPH can match inputs that have homologies. Such inputs have sequences of identical bytes in the same order, although bytes in between these sequences may be different in both content and length.</p><p>For further information on ssdeep, visit its site: http://ssdeep.sourceforge.net/</p><p><strong>Supported:</strong> TBI</p><p><strong>Example:</strong></p><pre><code>SecRule REQUEST_BODY &quot;\@fuzzyHash /path/to/ssdeep/hashes.txt 6&quot; &quot;id:192372,log,deny&quot;
</code></pre><h2 id=ge>ge <a href=#ge class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs numerical comparison and returns true if the input value is greater than or equal to the provided parameter. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect 15 or more request headers
SecRule &amp;REQUEST_HEADERS_NAMES &quot;@ge 15&quot; &quot;id:154&quot;
</code></pre><p><strong>Note:</strong> If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</p><h2 id=geolookup>geoLookup <a href=#geolookup class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a geolocation lookup using the IP address in input against the geolocation database previously configured using SecGeoLookupDb. If the lookup is successful, the obtained information is captured in the GEO collection.</p><p><strong>Example:</strong> The geoLookup operator matches on success and is thus best used in combination with nolog,pass. If you wish to block on a failed lookup (which may be over the top, depending on how accurate the geolocation database is), the following example demonstrates how best to do it:</p><pre><code># Configure geolocation database
SecGeoLookupDb /path/to/GeoLiteCity.dat
...
# Lookup IP address
SecRule REMOTE_ADDR &quot;@geoLookup&quot; &quot;phase:1,id:155,nolog,pass&quot;

# Block IP address for which geolocation failed
SecRule &amp;GEO &quot;@eq 0&quot; &quot;phase:1,id:156,deny,msg:'Failed to lookup IP'&quot;
See the GEO variable for an example and more information on various fields available.
</code></pre><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=gt>gt <a href=#gt class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs numerical comparison and returns true if the input value is greater than the operator parameter. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect more than 15 headers in a request
SecRule &amp;REQUEST_HEADERS_NAMES &quot;@gt 15&quot; &quot;id:158&quot;
</code></pre><p><strong>Note:</strong> If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</p><h2 id=inspectfile>inspectFile <a href=#inspectfile class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Executes an external program for every variable in the target list. The contents of the variable is provided to the script as the first parameter on the command line. The program must be specified as the first parameter to the operator. As of version 2.5.0, if the supplied program filename is not absolute, it is treated as relative to the directory in which the configuration file resides. Also as of version 2.5.0, if the filename is determined to be a Lua script (based on its .lua extension), the script will be processed by the internal Lua engine. Internally processed scripts will often run faster (there is no process creation overhead) and have full access to the transaction context of Coraza.</p><p>The <code>inspectFile</code> operator was initially designed for file inspection (hence the name), but it can also be used in any situation that requires decision making using external logic.</p><pre><code>#!/usr/bin/perl
#
# runav.pl
# Copyright (c) 2004-2011 Trustwave
#
# This script is an interface between Coraza and its
# ability to intercept files being uploaded through the
# web server, and ClamAV


$CLAMSCAN = &quot;clamscan&quot;;

if ($#ARGV != 0) {
    print &quot;Usage: runav.pl &lt;filename&gt;\n&quot;;
    exit;
}

my ($FILE) = shift @ARGV;

$cmd = &quot;$CLAMSCAN --stdout --no-summary $FILE&quot;;
$input = `$cmd`;
$input =~ m/^(.+)/;
$error_message = $1;

$output = &quot;0 Unable to parse clamscan output [$1]&quot;;

if ($error_message =~ m/: Empty file\.?$/) {
    $output = &quot;1 empty file&quot;;
}
elsif ($error_message =~ m/: (.+) ERROR$/) {
    $output = &quot;0 clamscan: $1&quot;;
}
elsif ($error_message =~ m/: (.+) FOUND$/) {
    $output = &quot;0 clamscan: $1&quot;;
}
elsif ($error_message =~ m/: OK$/) {
    $output = &quot;1 clamscan: OK&quot;;
}

print &quot;$output\n&quot;;
</code></pre><p><strong>Example:</strong> Using the runav.pl script:</p><pre><code># Execute external program to validate uploaded files
SecRule FILES_TMPNAMES &quot;@inspectFile /path/to/util/runav.pl&quot; &quot;id:159&quot;
</code></pre><p><strong>Note:</strong> Coraza will not fill the FILES_TMPNAMES variable unless SecTmpSaveUploadedFiles directive is On, or the SecUploadKeepFiles directive is set to RelevantOnly.</p><p><strong>Note:</strong> Use @inspectFile with caution. It may not be safe to use @inspectFile with variables other than FILES_TMPNAMES. Other variables such as &ldquo;FULL_REQUEST&rdquo; may contains content that force your platform to fork process out of your control, making possible to an attacker to execute code using the same permissions of your web server. For other variables you may want to look at the Lua script engine. This observation was brought to our attention by &ldquo;Gryzli&rdquo;, on our users mailing list.</p><p><strong>Reference:</strong> http://blog.spiderlabs.com/2010/10/advanced-topic-of-the-week-preventing-malicious-pdf-file-uploads.html</p><p><strong>Reference:</strong> http://sourceforge.net/p/mod-security/mailman/mod-security-users/?viewmonth=201512</p><h2 id=ipmatch>ipMatch <a href=#ipmatch class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a fast ipv4 or ipv6 match of REMOTE_ADDR variable data. Can handle the following formats:</p><ul><li>Full IPv4 Address - 192.168.1.100</li><li>Network Block/CIDR Address - 192.168.1.0/24</li><li>Full IPv6 Address - 2001:db8:85a3:8d3:1319:8a2e:370:7348</li><li>Network Block/CIDR Address - 2001:db8:85a3:8d3:1319:8a2e:370:0/24</li></ul><p><strong>Examples:</strong></p><p><strong>Individual Address:</strong></p><pre><code>SecRule REMOTE_ADDR &quot;@ipMatch 192.168.1.100&quot; &quot;id:161&quot;
Multiple Addresses w/network block:
SecRule REMOTE_ADDR &quot;@ipMatch 192.168.1.100,192.168.1.50,10.10.50.0/24&quot; &quot;id:162&quot;
</code></pre><h2 id=ipmatchf>ipMatchF <a href=#ipmatchf class=anchor aria-hidden=true>#</a></h2><p>short alias for <code>ipMatchFromFile</code></p><h2 id=ipmatchfromdataset>ipMatchFromDataSet <a href=#ipmatchfromdataset class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> This operator is the same as @ipFromFile below, except that it uses a memory dataset instead of a file as argument. It will match any one of the IPs listed in the dataset anywhere in the target value.</p><p><strong>Example:</strong></p><pre><code class=language-seclang>SecDataset ip_dataset &quot;
127.0.0.1
8.8.8.8
&quot;
SecRule REQUEST_ADDR &quot;@ipFromDataset ip_dataset&quot; &quot;id:1,log,phase:1,pass,msg:'Match ip_dataset'&quot;
</code></pre><p><strong>Note:</strong> SecDatasets are added as replacement for <code>.data</code> files. WASM support is an essential feature of Coraza v3, but users cannot fully enjoy its potential because of file reading limitations. For this reason, SecDataset is a decent replacement for .data files.</p><h2 id=ipmatchfromfile>ipMatchFromFile <a href=#ipmatchfromfile class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a fast ipv4 or ipv6 match of REMOTE_ADDR variable, loading data from a file. Can handle the following formats:</p><ul><li>Full IPv4 Address - 192.168.1.100</li><li>Network Block/CIDR Address - 192.168.1.0/24</li><li>Full IPv6 Address - 2001:db8:85a3:8d3:1319:8a2e:370:7348</li><li>Network Block/CIDR Address - 2001:db8:85a3:8d3:1319:8a2e:370:0/24</li></ul><p><strong>Examples:</strong></p><pre><code>SecRule REMOTE_ADDR &quot;@ipMatchFromFile ips.txt&quot; &quot;id:163&quot;
</code></pre><p>The file ips.txt may contain:</p><ul><li>192.168.0.1</li><li>172.16.0.0/16</li><li>10.0.0.0/8</li></ul><p><strong>Note:</strong> This operator also supports to load content served by an HTTPS server.</p><p><strong>Note:</strong> When used with content served by a HTTPS server, the directive SecRemoteRulesFailAction can be used to configure a warning instead of an abort, when the remote content could not be retrieved.</p><h2 id=le>le <a href=#le class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs numerical comparison and returns true if the input value is less than or equal to the operator parameter. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect 15 or fewer headers in a request
SecRule &amp;REQUEST_HEADERS_NAMES &quot;@le 15&quot; &quot;id:164&quot;
</code></pre><p><strong>Note:</strong> If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</p><h2 id=lt>lt <a href=#lt class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs numerical comparison and returns true if the input value is less than to the operator parameter. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect fewer than 15 headers in a request
SecRule &amp;REQUEST_HEADERS_NAMES &quot;@lt 15&quot; &quot;id:165&quot;
</code></pre><p><strong>Note:</strong> If a value is provided that cannot be converted to an integer (i.e a string) this operator will treat that value as 0.</p><h2 id=nomatch>noMatch <a href=#nomatch class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Will force the rule to always return false.</p><h2 id=pm>pm <a href=#pm class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a case-insensitive match of the provided phrases against the desired input value. The operator uses a set-based matching algorithm (Aho-Corasick), which means that it will match any number of keywords in parallel. When matching of a large number of keywords is needed, this operator performs much better than a regular expression.</p><p><strong>Example:</strong></p><pre><code># Detect suspicious client by looking at the user agent identification
SecRule REQUEST_HEADERS:User-Agent &quot;@pm WebZIP WebCopier Webster WebStripper ... SiteSnagger ProWebWalker CheeseBot&quot; &quot;id:166&quot;
</code></pre><p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">üëâ</div><div class=w-100>This operator supports a snort/suricata content style. ie: "@pm A|42|C|44|F".</div></div><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">‚ö†Ô∏è</div><div class=w-100>This operator does not support macro expansion.</div></div></p><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=pmf>pmf <a href=#pmf class=anchor aria-hidden=true>#</a></h2><p>Short alias for pmFromFile.</p><h2 id=pmfromdataset>pmFromDataset <a href=#pmfromdataset class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> This operator is the same as @pmFromFile below, except that it uses a memory dataset instead of a file as argument. It will match any one of the phrases listed in the dataset anywhere in the target value.</p><p><strong>Example:</strong></p><pre><code class=language-seclang>SecDataset pm_dataset &quot;
uri1
uri2
&quot;
SecRule REQUEST_URI &quot;@pmFromDataset pm_dataset&quot; &quot;id:1,log,phase:1,pass,msg:'Match pm_dataset'&quot;
</code></pre><p><strong>Note:</strong> SecDatasets are added as replacement for <code>.data</code> files. WASM support is an essential feature of Coraza v3, but users cannot fully enjoy its potential because of file reading limitations. For this reason, SecDataset is a decent replacement for .data files.</p><h2 id=pmfromfile>pmFromFile <a href=#pmfromfile class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a case-insensitive match of the provided phrases against the desired input value. The operator uses a set-based matching algorithm (Aho-Corasick), which means that it will match any number of keywords in parallel. When matching of a large number of keywords is needed, this operator performs much better than a regular expression.</p><p>This operator is the same as @pm, except that it takes a list of files as arguments. It will match any one of the phrases listed in the file(s) anywhere in the target value.</p><p><strong>Example:</strong></p><pre><code class=language-seclang># Detect suspicious user agents using the keywords in
# the files /path/to/denylist1 and 2 (the latter
# must be placed in the same folder as the configuration file)
SecRule REQUEST_HEADERS:User-Agent &quot;@pmFromFile /path/to/denylist1 denylist2&quot; &quot;id:167&quot;
</code></pre><p><strong>Notes:</strong></p><p>Files must contain exactly one phrase per line. End of line markers (both LF and CRLF) will be stripped from each phrase and any whitespace trimmed from both the beginning and the end. Empty lines and comment lines (those beginning with the # character) will be ignored.
To allow easier inclusion of phrase files with rule sets, relative paths may be used to the phrase files. In this case, the path of the file containing the rule is prepended to the phrase file path.
The @pm operator phrases do not support metacharacters.
Because this operator does not check for boundaries when matching, false positives are possible in some cases. For example, if you want to use @pm for IP address matching, the phrase 1.2.3.4 will potentially match more than one IP address (e.g., it will also match 1.2.3.40 or 1.2.3.41). To avoid the false positives, you can use your own boundaries in phrases. For example, use /1.2.3.4/ instead of just 1.2.3.4. Then, in your rules, also add the boundaries where appropriate. You will find a complete example in the example.</p><pre><code class=language-seclang># Prepare custom REMOTE_ADDR variable
SecAction &quot;phase:1,id:168,nolog,pass,setvar:tx.REMOTE_ADDR=/%{REMOTE_ADDR}/&quot;

# Check if REMOTE_ADDR is denylisted
SecRule TX:REMOTE_ADDR &quot;@pmFromFile denylist.txt&quot; &quot;phase:1,id:169,deny,msg:'Denylisted IP address'&quot;
</code></pre><p>The file denylist.txt may contain:</p><pre><code class=language-seclang># ip-denylist.txt contents:
# Note: All IPs must be prefixed/suffixed with &quot;/&quot; as the rules
#   will add in this character as a boundary to ensure
#   the entire IP is matched.
# SecAction &quot;phase:1,id:170,pass,nolog,setvar:tx.remote_addr='/%{REMOTE_ADDR}/'&quot;
/1.2.3.4/
/5.6.7.8/
</code></pre><p><strong>Note:</strong> This operator supports a snort/suricata content style. ie: &ldquo;A|42|C|44|F&rdquo;.</p><p><strong>Note II:</strong> This operator also supports to load content served by an HTTPS server. However, only one url can be used at a time.</p><h2 id=rbl>rbl <a href=#rbl class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Looks up the input value in the RBL (real-time block list) given as parameter. The parameter can be an IPv4 address or a hostname.</p><p><strong>Example:</strong></p><pre><code>SecRule REMOTE_ADDR &quot;@rbl sbl-xbl.spamhaus.org&quot; &quot;phase:1,id:171,t:none,pass,nolog,auditlog,msg:'RBL Match for SPAM Source',tag:'AUTOMATION/MALICIOUS',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.automation_score=+%{tx.warning_anomaly_score},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score}, \
setvar:tx.%{rule.id}-AUTOMATION/MALICIOUS-%{matched_var_name}=%{matched_var},setvar:ip.spammer=1,expirevar:ip.spammer=86400,setvar:ip.previous_rbl_check=1,expirevar:ip.previous_rbl_check=86400,skipAfter:END_RBL_CHECK&quot;
</code></pre><p><strong>Note:</strong> If the RBL used is dnsbl.httpbl.org (Honeypot Project RBL) then the SecHttpBlKey directive must specify the user&rsquo;s registered API key.</p><p><strong>Note:</strong> If the RBL used is either multi.uribl.com or zen.spamhaus.org combined RBLs, it is possible to also parse the return codes in the last octet of the DNS response to identify which specific RBL the IP was found in.</p><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=restpath>restpath <a href=#restpath class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> takes as argument a path expression in the format <code>/path/to/resource/{id}/{name}/{age}</code> and helps evaluation of application urls. The path will be transformed to a regex and assigned to variables in <code>ARGS_PATH</code>, <code>ARGS_NAMES</code>, and <code>ARGS</code></p><p><strong>Syntax:</strong> <code>"/some-random/url-{id}/{name}"</code></p><p><strong>Examples:</strong></p><pre><code class=language-seclang>SecRule REQUEST_URI &quot;@restpath /some/random/url/{id}/{name}&quot; \
  &quot;deny,chain&quot;
  SecRule ARGS_PATH:id &quot;!@eq %{user:session_id}&quot; &quot;t:none&quot;
</code></pre><h2 id=rsub>rsub <a href=#rsub class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs regular expression data substitution when applied to either the STREAM_INPUT_BODY or STREAM_OUTPUT_BODY variables. This operator also supports macro expansion. Starting with Coraza 2.7.0 this operator supports the syntax |hex| allowing users to use special chars like \n \r</p><p><strong>Syntax:</strong> @rsub s/regex/str/[id]</p><p><strong>Supported:</strong> TBI</p><p><strong>Examples:</strong> Removing HTML Comments from response bodies:</p><pre><code>SecStreamOutBodyInspection On
SecRule STREAM_OUTPUT_BODY &quot;@rsub s// /&quot; &quot;phase:4,id:172,t:none,nolog,pass&quot;
</code></pre><p><strong>Note:</strong> If you plan to manipulate live data by using @rsub with the STREAM_ variables, you must also enable SecContentInjection directive.
Regular expressions are handled by the PCRE library http://www.pcre.org. Coraza compiles its regular expressions with the following settings:</p><p>The entire input is treated as a single line, even when there are newline characters present.
All matches are case-sensitive. If you wish to perform case-insensitive matching, you can either use the lowercase transformation function or force case-insensitive matching by prefixing the regular expression pattern with the (?i) modifier (a PCRE feature; you will find many similar features in the PCRE documentation). Also a flag [d] should be used if you want to escape the regex string chars when use macro expansion.
The PCRE_DOTALL and PCRE_DOLLAR_ENDONLY flags are set during compilation, meaning that a single dot will match any character, including the newlines, and a $ end anchor will not match a trailing newline character.
Regular expressions are a very powerful tool. You are strongly advised to read the PCRE documentation to get acquainted with its features.</p><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=rx>rx <a href=#rx class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a regular expression match of the pattern provided as parameter. This is the default operator; the rules that do not explicitly specify an operator default to @rx.</p><p><strong>Examples:</strong></p><pre><code># Detect Nikto
SecRule REQUEST_HEADERS:User-Agent &quot;@rx nikto&quot; phase:1,id:173,t:lowercase

SecRule REQUEST_HEADERS:User-Agent &quot;@rx (?i)nikto&quot; phase:1,id:174,t:none
# Detect Nikto with a case-insensitive pattern

# Detect Nikto with a case-insensitive pattern
SecRule REQUEST_HEADERS:User-Agent &quot;(?i)nikto&quot; &quot;id:175&quot;
</code></pre><p>Regular expressions are handled by the RE2. Coraza compiles its regular expressions with the following settings:</p><p>The entire input is treated as a single line, even when there are newline characters present.
All matches are case-sensitive. If you wish to perform case-insensitive matching, you can either use the lowercase transformation function or force case-insensitive matching by prefixing the regular expression pattern with the (?i) modifier (a PCRE feature; you will find many similar features in the PCRE documentation).
A single dot will match any character, including the newlines, and a $ end anchor will not match a trailing newline character.
Regular expressions are a very powerful tool. You are strongly advised to read the PCRE documentation to get acquainted with its features.</p><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=streq>streq <a href=#streq class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a string comparison and returns true if the parameter string is identical to the input string. Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect request parameters &quot;foo&quot; that do not # contain &quot;bar&quot;, exactly.
SecRule ARGS:foo &quot;!@streq bar&quot; &quot;id:176&quot;
</code></pre><h2 id=strmatch>strmatch <a href=#strmatch class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Performs a string match of the provided word against the desired input value. The operator uses the pattern matching Boyer-Moore-Horspool algorithm, which means that it is a single pattern matching operator. This operator performs much better than a regular expression.</p><p><strong>Example:</strong></p><pre><code># Detect suspicious client by looking at the user agent identification
SecRule REQUEST_HEADERS:User-Agent &quot;@strmatch WebZIP&quot; &quot;id:177&quot;
</code></pre><p><strong>Note:</strong> Starting on Coraza v2.6.0 this operator supports a snort/suricata content style. ie: &ldquo;@strmatch A|42|C|44|F&rdquo;.
unconditionalMatch</p><p><strong>Description:</strong> Will force the rule to always return true. This is similar to SecAction however all actions that occur as a result of a rule matching will fire such as the setting of MATCHED_VAR. This can also be part a chained rule.</p><p><strong>Example:</strong></p><pre><code>SecRule REMOTE_ADDR &quot;@unconditionalMatch&quot; &quot;id:1000,phase:1,pass,nolog,t:hexEncode,setvar:TX.ip_hash=%{MATCHED_VAR}&quot;
</code></pre><h2 id=unconditionalmatch>unconditionalMatch <a href=#unconditionalmatch class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Will force the rule to always return true. This is similar to SecAction however all actions that occur as a result of a rule matching will fire such as the setting of MATCHED_VAR. This can also be part a chained rule.</p><p><strong>Example:</strong></p><pre><code class=language-seclang>SecRule REMOTE_ADDR &quot;@unconditionalMatch&quot; &quot;id:1000,phase:1,pass,nolog,t:hexEncode,setvar:TX.ip_hash=%{MATCHED_VAR}&quot;
</code></pre><h2 id=validatebyterange>validateByteRange <a href=#validatebyterange class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Validates that the byte values used in input fall into the range specified by the operator parameter. This operator matches on an input value that contains bytes that are not in the specified range.</p><p><strong>Example:</strong></p><pre><code># Enforce very strict byte range for request parameters (only
# works for the applications that do not use the languages other
# than English).
SecRule ARGS &quot;@validateByteRange 10, 13, 32-126&quot; &quot;id:178&quot;
</code></pre><p>The validateByteRange is most useful when used to detect the presence of NUL bytes, which don‚Äôt have a legitimate use, but which are often used as an evasion technique.</p><pre><code># Do not allow NUL bytes
SecRule ARGS &quot;@validateByteRange 1-255&quot; &quot;id:179&quot;
</code></pre><p><strong>Note:</strong> You can force requests to consist only of bytes from a certain byte range. This can be useful to avoid stack overflow attacks (since they usually contain &ldquo;random&rdquo; binary content). Default range values are 0 and 255, i.e. all byte values are allowed. This directive does not check byte range in a POST payload when multipart/form-data encoding (file upload) is used. Doing so would prevent binary files from being uploaded. However, after the parameters are extracted from such request they are checked for a valid range.</p><h2 id=validatehash>validateHash <a href=#validatehash class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Validates REQUEST_URI that contains data protected by the hash engine.</p><p><strong>Supported:</strong> TBI</p><p><strong>Example:</strong></p><pre><code># Validates requested URI that matches a regular expression.
SecRule REQUEST_URI &quot;@validatehash &quot;product_info|product_list&quot; &quot;phase:1,deny,id:123456&quot;
</code></pre><h2 id=validatenid>validateNid <a href=#validatenid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Validates the matched argument contains a valid <code>National IDentifier</code></p><p><strong>Syntax:</strong> <code>@validatenid cl|us</code></p><p><strong>Example:</strong></p><pre><code class=language-seclang>SecRule ARGS:nid &quot;!@validatenid cl&quot; &quot;id:100,nolog,noauditlog,phase:2,deny&quot;
</code></pre><h2 id=validateurlencoding>validateUrlEncoding <a href=#validateurlencoding class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Validates the URL-encoded characters in the provided input string.</p><p><strong>Example:</strong></p><pre><code># Validate URL-encoded characters in the request URI
SecRule REQUEST_URI_RAW &quot;@validateUrlEncoding&quot; &quot;id:192&quot;
</code></pre><p>Coraza will automatically decode the URL-encoded characters in request parameters, which means that there is little sense in applying the @validateUrlEncoding operator to them ‚Äîthat is, unless you know that some of the request parameters were URL-encoded more than once. Use this operator against raw input, or against the input that you know is URL-encoded. For example, some applications will URL-encode cookies, although that‚Äôs not in the standard. Because it is not in the standard, Coraza will neither validate nor decode such encodings.</p><h2 id=validateutf8encoding>validateUtf8Encoding <a href=#validateutf8encoding class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Check whether the input is a valid UTF-8 string.</p><p><strong>Example:</strong></p><pre><code># Make sure all request parameters contain only valid UTF-8
SecRule ARGS &quot;@validateUtf8Encoding&quot; &quot;id:193&quot;
</code></pre><p>The @validateUtf8Encoding operator detects the following problems:</p><ul><li><strong>Not enough bytes :</strong> UTF-8 supports two-, three-, four-, five-, and six-byte encodings. Coraza will locate cases when one or more bytes is/are missing from a character.</li><li><strong>Invalid characters :</strong> The two most significant bits in most characters should be fixed to 0x80. Some attack techniques use different values as an evasion technique.</li><li><strong>Overlong characters :</strong> ASCII characters are mapped directly into UTF-8, which means that an ASCII character is one UTF-8 character at the same time. However, in UTF-8 many ASCII characters can also be encoded with two, three, four, five, and six bytes. This is no longer legal in the newer versions of Unicode, but many older implementations still support it. The use of overlong UTF-8 characters is common for evasion.</li></ul><p><strong>Notes :</strong></p><ul><li>Most, but not all applications use UTF-8. If you are dealing with an application that does, validating that all request parameters are valid UTF-8 strings is a great way to prevent a number of evasion techniques that use the assorted UTF-8 weaknesses. False positives are likely if you use this operator in an application that does not use UTF-8.</li><li>Many web servers will also allow UTF-8 in request URIs. If yours does, you can verify the request URI using @validateUtf8Encoding.</li></ul><h2 id=verifycc>verifyCC <a href=#verifycc class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Detects credit card numbers in input. This operator will first use the supplied regular expression to perform an initial match, following up with the Luhn algorithm calculation to minimize false positives.</p><p><strong>Supported on Coraza:</strong> TBI</p><p><strong>Example:</strong></p><pre><code># Detect credit card numbers in parameters and
# prevent them from being logged to audit log
SecRule ARGS &quot;@verifyCC \d{13,16}&quot; &quot;phase:2,id:194,nolog,pass,msg:'Potential credit card number',sanitiseMatched&quot;
</code></pre><p><strong>Note:</strong> This operator supports the &ldquo;capture&rdquo; action.</p><h2 id=within>within <a href=#within class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Returns true if the input value (the needle) is found anywhere within the @within parameter (the haystack). Macro expansion is performed on the parameter string before comparison.</p><p><strong>Example:</strong></p><pre><code># Detect request methods other than GET, POST and HEAD
SecRule REQUEST_METHOD &quot;!@within GET,POST,HEAD&quot;
</code></pre><p><strong>Note:</strong> There are no delimiters for this operator, it is therefore often necessary to artificially impose some; this can be done using setvar. For instance in the example below, without the imposed delimiters (of &lsquo;/&rsquo;) this rule would also match on the &lsquo;range&rsquo; header (along with many other combinations), since &lsquo;range&rsquo; is within the provided parameter. With the imposed delimiters, the rule would check for &lsquo;/range/&rsquo; when the range header is provided, and therefore would not match since &lsquo;/range/ is not part of the @within parameter.</p><pre><code>SecRule REQUEST_HEADERS_NAMES &quot;@rx ^.*$&quot; \
&quot;chain,\
id:1,\
block,\
t:lowercase,\
setvar:'tx.header_name=/%{tx.0}/'&quot;
   SecRule TX:header_name &quot;@within /proxy/ /lock-token/ /content-range/ /translate/ /if/&quot; &quot;t:none&quot;
</code></pre><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/seclang/operators.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
Edit this page on</a></div></div><div class="docs-navigation d-flex justify-content-between"><a href=https://coraza.io/docs/tutorials/introduction/><div class="card my-1"><div class="card-body py-2">&larr; Introduction</div></div></a><a class=ms-auto href=https://coraza.io/docs/seclang/transformations/><div class="card my-1"><div class="card-body py-2">Transformations &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ‚ù§Ô∏è (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.65b764f3f70840775592c168123a8a92ee58fa31c33c0638906528635b818ac422aaf64445e00ff62d028010b62c46f7d396b104e737269c293e34304a172624.js integrity="sha512-Zbdk8/cIQHdVksFoEjqKku5Y+jHDPAY4kGUoY1uBisQiqvZEReAP9i0CgBC2LEb305axBOc3JpwpPjQwShcmJA==" crossorigin=anonymous defer></script><script src=https://coraza.io/js/highlight.min.86beb544fe09c932e7d01490675d38341a1986f7782726a5edad74025e4a0f885c60e18ddaee0a483160d2b3af97274830f9fe127b750d503b7d16ecb34cab57.js integrity="sha512-hr61RP4JyTLn0BSQZ104NBoZhvd4Jyal7a10Al5KD4hcYOGN2u4KSDFg0rOvlydIMPn+Ent1DVA7fRbss0yrVw==" crossorigin=anonymous defer></script><script src=https://coraza.io/main.min.bfa65cedd6250da819d42442541d2515f4bc08872cc860fbda3fd95f9183125b3418e48c5ebfee53f1ec729b29ddd1ec7be9990ad33785624c81b9268ea2fe6b.js integrity="sha512-v6Zc7dYlDagZ1CRCVB0lFfS8CIcsyGD72j/ZX5GDEls0GOSMXr/uU/Hscpsp3dHse+mZCtM3hWJMgbkmjqL+aw==" crossorigin=anonymous defer></script><script src=https://coraza.io/index.min.568c115e065cd78755df9c575a275815db602b1ce9a64dcdf0fab08f7bfdc2bd4644b13b0156adb36a63c53dcc8821f60fc9c7db931399f30eeb43738d0a5537.js integrity="sha512-VowRXgZc14dV35xXWidYFdtgKxzppk3N8Pqwj3v9wr1GRLE7AVats2pjxT3MiCH2D8nH25MTmfMO60NzjQpVNw==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>