<!doctype html><html lang=en-US><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://coraza.io/main.68ba88090ac5b0e605ef6d6fa19ccf6bf83facedf687e8f921424f9632a0f413c261dce8047ef4ebec42f4088cd43bc30bfe78af58c40cd9ef3d202249ed49ae.css integrity="sha512-aLqICQrFsOYF721voZzPa/g/rO32h+j5IUJPljKg9BPCYdzoBH706+xC9AiM1DvDC/54r1jEDNnvPSAiSe1Jrg==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Directives - OWASP Coraza</title><meta name=description content="The following section outlines all of the Coraza directives. "><link rel=canonical href=https://coraza.io/docs/seclang/directives/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Directives"><meta property="og:description" content="The following section outlines all of the Coraza directives. "><meta property="og:url" content="https://coraza.io/docs/seclang/directives/"><meta property="og:site_name" content="OWASP Coraza"><meta property="article:published_time" content="2020-10-06T08:48:57+00:00"><meta property="article:modified_time" content="2026-01-15T08:01:39-03:00"><meta property="og:image" content="https://coraza.io/images/logo_animal_only.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Directives"><meta name=twitter:description content="The following section outlines all of the Coraza directives. "><meta name=twitter:image content="https://coraza.io/images/logo_animal_only.png"><meta name=twitter:image:alt content="Directives"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/directives/","url":"https://coraza.io/docs/seclang/directives/","name":"Directives","description":"The following section outlines all of the Coraza directives. ","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2026-01-15T08:01:39CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/directives/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/directives/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/directives/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://coraza.io/#/schema/article/1","headline":"Directives","description":"The following section outlines all of the Coraza directives. ","isPartOf":{"@id":"https://coraza.io/docs/seclang/directives/"},"mainEntityOfPage":{"@id":"https://coraza.io/docs/seclang/directives/"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2026-01-15T08:01:39CET","author":{"@id":"https://coraza.io/#/schema/person/2"},"publisher":{"@id":"https://coraza.io/#/schema/person/1"},"image":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/2","name":"Juan Pablo Tosso and Coraza contributors","sameAs":["https://twitter.com/jptosso","https://www.linkedin.com/in/jptosso/","https://github.com/corazawaf"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2","url":"https://coraza.io/images/logo_animal_only.png","contentUrl":"https://coraza.io/images/logo_animal_only.png","caption":"Directives"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza
</a><button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu">
<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span>
<span class=toggle-light><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 ðŸ†•</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class="docs-link active" href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-4 col-xl-3 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrade to v3 ðŸ†•</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class="docs-link active" href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg>
<svg width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#include>Include</a></li><li><a href=#secaction>SecAction</a></li><li><a href=#secargumentslimit>SecArgumentsLimit</a></li><li><a href=#secauditengine>SecAuditEngine</a></li><li><a href=#secauditlog>SecAuditLog</a></li><li><a href=#secauditlogdir>SecAuditLogDir</a></li><li><a href=#secauditlogdirmode>SecAuditLogDirMode</a></li><li><a href=#secauditlogfilemode>SecAuditLogFileMode</a></li><li><a href=#secauditlogformat>SecAuditLogFormat</a></li><li><a href=#secauditlogparts>SecAuditLogParts</a></li><li><a href=#secauditlogrelevantstatus>SecAuditLogRelevantStatus</a></li><li><a href=#secdebuglog>SecDebugLog</a></li><li><a href=#secdebugloglevel>SecDebugLogLevel</a></li><li><a href=#secdefaultaction>SecDefaultAction</a></li><li><a href=#secmarker>SecMarker</a></li><li><a href=#secrequestbodyaccess>SecRequestBodyAccess</a></li><li><a href=#secrequestbodyinmemorylimit>SecRequestBodyInMemoryLimit</a></li><li><a href=#secrequestbodylimit>SecRequestBodyLimit</a></li><li><a href=#secrequestbodylimitaction>SecRequestBodyLimitAction</a></li><li><a href=#secrequestbodynofileslimit>SecRequestBodyNoFilesLimit</a></li><li><a href=#secresponsebodyaccess>SecResponseBodyAccess</a></li><li><a href=#secresponsebodylimit>SecResponseBodyLimit</a></li><li><a href=#secresponsebodylimitaction>SecResponseBodyLimitAction</a></li><li><a href=#secrule>SecRule</a></li><li><a href=#secruleengine>SecRuleEngine</a></li><li><a href=#secruleremovebyid>SecRuleRemoveByID</a></li><li><a href=#secruleremovebytag>SecRuleRemoveByTag</a></li><li><a href=#secruleupdatetargetbyid>SecRuleUpdateTargetByID</a></li><li><a href=#secruleupdatetargetbytag>SecRuleUpdateTargetByTag</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#include>Include</a></li><li><a href=#secaction>SecAction</a></li><li><a href=#secargumentslimit>SecArgumentsLimit</a></li><li><a href=#secauditengine>SecAuditEngine</a></li><li><a href=#secauditlog>SecAuditLog</a></li><li><a href=#secauditlogdir>SecAuditLogDir</a></li><li><a href=#secauditlogdirmode>SecAuditLogDirMode</a></li><li><a href=#secauditlogfilemode>SecAuditLogFileMode</a></li><li><a href=#secauditlogformat>SecAuditLogFormat</a></li><li><a href=#secauditlogparts>SecAuditLogParts</a></li><li><a href=#secauditlogrelevantstatus>SecAuditLogRelevantStatus</a></li><li><a href=#secdebuglog>SecDebugLog</a></li><li><a href=#secdebugloglevel>SecDebugLogLevel</a></li><li><a href=#secdefaultaction>SecDefaultAction</a></li><li><a href=#secmarker>SecMarker</a></li><li><a href=#secrequestbodyaccess>SecRequestBodyAccess</a></li><li><a href=#secrequestbodyinmemorylimit>SecRequestBodyInMemoryLimit</a></li><li><a href=#secrequestbodylimit>SecRequestBodyLimit</a></li><li><a href=#secrequestbodylimitaction>SecRequestBodyLimitAction</a></li><li><a href=#secrequestbodynofileslimit>SecRequestBodyNoFilesLimit</a></li><li><a href=#secresponsebodyaccess>SecResponseBodyAccess</a></li><li><a href=#secresponsebodylimit>SecResponseBodyLimit</a></li><li><a href=#secresponsebodylimitaction>SecResponseBodyLimitAction</a></li><li><a href=#secrule>SecRule</a></li><li><a href=#secruleengine>SecRuleEngine</a></li><li><a href=#secruleremovebyid>SecRuleRemoveByID</a></li><li><a href=#secruleremovebytag>SecRuleRemoveByTag</a></li><li><a href=#secruleupdatetargetbyid>SecRuleUpdateTargetByID</a></li><li><a href=#secruleupdatetargetbytag>SecRuleUpdateTargetByTag</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Directives</li></ol></nav><h1>Directives</h1><p class=lead>The following section outlines all of the Coraza directives.</p><nav class=d-xl-none aria-label="Quaternary navigation"><div class=d-xl-none><button class="btn btn-outline-primary btn-sm doks-toc-toggle collapsed" type=button data-bs-toggle=collapse data-bs-target=#onThisPage aria-controls=doks-docs-nav aria-expanded=false aria-label="Toggle On this page navigation">
<span></span>
<span><svg width="18" height="18" viewBox="0 0 24 24" class="doks doks-expand" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Expand</title><polyline points="7 13 12 18 17 13"/><polyline points="7 6 12 11 17 6"/></svg>
<svg width="18" height="18" viewBox="0 0 24 24" class="doks doks-collapse" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><title>Collapse</title><polyline points="17 11 12 6 7 11"/><polyline points="17 18 12 13 7 18"/></svg></span></button><div class=collapse id=onThisPage><div class="card card-body mt-3 py-1"><div class=page-links><nav id=TableOfContents><ul><li><a href=#include>Include</a></li><li><a href=#secaction>SecAction</a></li><li><a href=#secargumentslimit>SecArgumentsLimit</a></li><li><a href=#secauditengine>SecAuditEngine</a></li><li><a href=#secauditlog>SecAuditLog</a></li><li><a href=#secauditlogdir>SecAuditLogDir</a></li><li><a href=#secauditlogdirmode>SecAuditLogDirMode</a></li><li><a href=#secauditlogfilemode>SecAuditLogFileMode</a></li><li><a href=#secauditlogformat>SecAuditLogFormat</a></li><li><a href=#secauditlogparts>SecAuditLogParts</a></li><li><a href=#secauditlogrelevantstatus>SecAuditLogRelevantStatus</a></li><li><a href=#secdebuglog>SecDebugLog</a></li><li><a href=#secdebugloglevel>SecDebugLogLevel</a></li><li><a href=#secdefaultaction>SecDefaultAction</a></li><li><a href=#secmarker>SecMarker</a></li><li><a href=#secrequestbodyaccess>SecRequestBodyAccess</a></li><li><a href=#secrequestbodyinmemorylimit>SecRequestBodyInMemoryLimit</a></li><li><a href=#secrequestbodylimit>SecRequestBodyLimit</a></li><li><a href=#secrequestbodylimitaction>SecRequestBodyLimitAction</a></li><li><a href=#secrequestbodynofileslimit>SecRequestBodyNoFilesLimit</a></li><li><a href=#secresponsebodyaccess>SecResponseBodyAccess</a></li><li><a href=#secresponsebodylimit>SecResponseBodyLimit</a></li><li><a href=#secresponsebodylimitaction>SecResponseBodyLimitAction</a></li><li><a href=#secrule>SecRule</a></li><li><a href=#secruleengine>SecRuleEngine</a></li><li><a href=#secruleremovebyid>SecRuleRemoveByID</a></li><li><a href=#secruleremovebytag>SecRuleRemoveByTag</a></li><li><a href=#secruleupdatetargetbyid>SecRuleUpdateTargetByID</a></li><li><a href=#secruleupdatetargetbytag>SecRuleUpdateTargetByTag</a></li></ul></nav></div></div></div></div><div class="page-links d-none d-xl-block"><h3></h3><nav id=TableOfContents><ul><li><a href=#include>Include</a></li><li><a href=#secaction>SecAction</a></li><li><a href=#secargumentslimit>SecArgumentsLimit</a></li><li><a href=#secauditengine>SecAuditEngine</a></li><li><a href=#secauditlog>SecAuditLog</a></li><li><a href=#secauditlogdir>SecAuditLogDir</a></li><li><a href=#secauditlogdirmode>SecAuditLogDirMode</a></li><li><a href=#secauditlogfilemode>SecAuditLogFileMode</a></li><li><a href=#secauditlogformat>SecAuditLogFormat</a></li><li><a href=#secauditlogparts>SecAuditLogParts</a></li><li><a href=#secauditlogrelevantstatus>SecAuditLogRelevantStatus</a></li><li><a href=#secdebuglog>SecDebugLog</a></li><li><a href=#secdebugloglevel>SecDebugLogLevel</a></li><li><a href=#secdefaultaction>SecDefaultAction</a></li><li><a href=#secmarker>SecMarker</a></li><li><a href=#secrequestbodyaccess>SecRequestBodyAccess</a></li><li><a href=#secrequestbodyinmemorylimit>SecRequestBodyInMemoryLimit</a></li><li><a href=#secrequestbodylimit>SecRequestBodyLimit</a></li><li><a href=#secrequestbodylimitaction>SecRequestBodyLimitAction</a></li><li><a href=#secrequestbodynofileslimit>SecRequestBodyNoFilesLimit</a></li><li><a href=#secresponsebodyaccess>SecResponseBodyAccess</a></li><li><a href=#secresponsebodylimit>SecResponseBodyLimit</a></li><li><a href=#secresponsebodylimitaction>SecResponseBodyLimitAction</a></li><li><a href=#secrule>SecRule</a></li><li><a href=#secruleengine>SecRuleEngine</a></li><li><a href=#secruleremovebyid>SecRuleRemoveByID</a></li><li><a href=#secruleremovebytag>SecRuleRemoveByTag</a></li><li><a href=#secruleupdatetargetbyid>SecRuleUpdateTargetByID</a></li><li><a href=#secruleupdatetargetbytag>SecRuleUpdateTargetByTag</a></li></ul></nav></div></nav><h2 id=include>Include <a href=#include class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Include and evaluate a file or file pattern.</p><p><strong>Syntax:</strong> <code>Include [PATH_TO_CONF_FILES]</code></p><p>Include loads a file or a list of files from the filesystem using golang Glob syntax.</p><p><strong>Example:</strong></p><pre><code class=language-apache>Include /path/coreruleset/rules/*.conf
</code></pre><p>Quoting <a href=https://pkg.go.dev/path/filepath#Glob>Glob documentation</a>:</p><blockquote><p>The syntax of patterns is the same as in Match. The pattern may describe hierarchical
names such as /usr/*/bin/ed (assuming the Separator is â€˜/â€™).
Glob ignores file system errors such as I/O errors reading directories. The only possible returned error is ErrBadPattern, when pattern is malformed.</p></blockquote><h2 id=secaction>SecAction <a href=#secaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Unconditionally processes the action list it receives as the first and only parameter.</p><p><strong>Syntax:</strong> <code>SecAction "action1,action2,action3,..."</code></p><p>This directive is commonly used to set variables and initialize persistent collections using the
<code>initcol</code> action. The syntax of the parameter is identical to that of the third parameter of <a href=#secrule><code>SecRule</code></a>.</p><p><strong>Example:</strong></p><pre><code class=language-apache>SecAction &quot;nolog,phase:1,initcol:RESOURCE=%{REQUEST_FILENAME}&quot;
</code></pre><h2 id=secargumentslimit>SecArgumentsLimit <a href=#secargumentslimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum number of ARGS that will be accepted for processing.</p><p><strong>Syntax:</strong> <code>SecArgumentsLimit [LIMIT]</code></p><p><strong>Default:</strong> <code>1000</code></p><p>Exceeding the limit will not be included.
With JSON body processing, there is nothing to do when exceed the limit.
<strong>Example:</strong></p><pre><code class=language-apache>SecArgumentsLimit 1000
</code></pre><h2 id=secauditengine>SecAuditEngine <a href=#secauditengine class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the audit logging engine.</p><p><strong>Syntax:</strong> <code>SecAuditEngine RelevantOnly</code></p><p><strong>Default:</strong> <code>Off</code></p><p>The <a href=#secauditengine><code>SecAuditEngine</code></a> directive is used to configure the audit engine, which logs complete
transactions.</p><p>The possible values for the audit log engine are as follows:</p><ul><li>On: log all transactions</li><li>Off: do not log any transactions</li><li>RelevantOnly: only the log transactions that have triggered a warning or an error, or have
a status code that is considered to be relevant (as determined by the <a href=#secauditlogrelevantstatus><code>SecAuditLogRelevantStatus</code></a>
directive)</li></ul><p><strong>Note:</strong> If you need to change the audit log engine configuration on a per-transaction basis (e.g.,
in response to some transaction data), use the <code>ctl</code> action.</p><p>The following example demonstrates how <a href=#secauditengine><code>SecAuditEngine</code></a> is used:</p><pre><code class=language-apache>SecAuditEngine RelevantOnly
SecAuditLog logs/audit/audit.log
SecAuditLogParts ABCFHZ
SecAuditLogType concurrent
SecAuditLogDir logs/audit
SecAuditLogRelevantStatus ^(?:5|4(?!04))
</code></pre><h2 id=secauditlog>SecAuditLog <a href=#secauditlog class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines the path to the main audit log file (serial logging format) or the concurrent logging index file (concurrent logging format).</p><p><strong>Syntax:</strong> <code>SecAuditLog [ABSOLUTE_PATH_TO_LOG_FILE]</code></p><p><strong>Example:</strong></p><pre><code class=language-apache>SecAuditLog &quot;/path/to/audit.log&quot;
</code></pre><p><strong>Note:</strong> This audit log file is opened on startup when the server typically still runs
as root. You should not allow non-root users to have write privileges for this file
or for the directory.</p><h2 id=secauditlogdir>SecAuditLogDir <a href=#secauditlogdir class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the directory where concurrent audit log entries are stored.</p><p><strong>Syntax:</strong> <code>SecAuditLogDir [PATH_TO_LOG_DIR]</code></p><p>This directive is required only when concurrent audit logging is used. Ensure that you
specify a file system location with adequate disk space.</p><p><strong>Example:</strong></p><pre><code class=language-apache>SecAuditLogDir /tmp/auditlogs/
</code></pre><h2 id=secauditlogdirmode>SecAuditLogDirMode <a href=#secauditlogdirmode class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the mode (permissions) of any directories created for the concurrent audit logs, using an octal mode value as parameter (as used in <code>chmod</code>).</p><p><strong>Syntax:</strong> <code>SecAuditLogDirMode octal_mode|"default"</code></p><p><strong>Default:</strong> <code>0600</code></p><p>The default mode for new audit log directories (0600) only grants read/write access
to the owner.</p><p><strong>Example:</strong></p><pre><code class=language-apache>SecAuditLogDirMode 02750
</code></pre><h2 id=secauditlogfilemode>SecAuditLogFileMode <a href=#secauditlogfilemode class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the mode (permissions) of any files created for concurrent audit logs using an octal mode (as used in <code>chmod</code>). See <a href=#secauditlogdirmode><code>SecAuditLogDirMode</code></a> for controlling the mode of created audit log directories.</p><p><strong>Syntax:</strong> <code>SecAuditLogFileMode octal_mode|"default"</code></p><p><strong>Default:</strong> <code>0600</code></p><p><strong>Example:</strong></p><pre><code class=language-apache>SecAuditLogFileMode 00640
</code></pre><h2 id=secauditlogformat>SecAuditLogFormat <a href=#secauditlogformat class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Select the output format of the AuditLogs. The format can be the native AuditLogs format, JSON, or OCSF (Open CyberSecurity Schema Framework).</p><p><strong>Syntax:</strong> <code>SecAuditLogFormat JSON|JsonLegacy|Native|OCSF</code></p><p><strong>Default:</strong> <code>Native</code></p><h2 id=secauditlogparts>SecAuditLogParts <a href=#secauditlogparts class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines which parts of each transaction are going to be recorded in the audit log. Each part is assigned a single letter; when a letter appears in the list then the equivalent part will be recorded. See below for the list of all parts.</p><p><strong>Syntax:</strong> <code>SecAuditLogParts [PARTLETTERS]</code></p><p><strong>Default:</strong> <code>ABCFHZ</code></p><p>The format of the audit log format is documented in detail in the Audit Log Data
Format Documentation.</p><p><strong>Example:</strong></p><pre><code class=language-apache>SecAuditLogParts ABCFHZ
</code></pre><p>Available audit log parts:</p><ul><li>A: Audit log header (mandatory).</li><li>B: Request headers.</li><li>C: Request body (present only if the request body exists and Coraza is configured
to intercept it. This would require <a href=#secrequestbodyaccess><code>SecRequestBodyAccess</code></a> to be set to on).</li><li>D: Reserved for intermediary response headers; not implemented yet.</li><li>E: Intermediary response body (present only if Coraza is configured to intercept
response bodies, and if the audit log engine is configured to record it. Intercepting
response bodies requires <a href=#secresponsebodyaccess><code>SecResponseBodyAccess</code></a> to be enabled). Intermediary response
body is the same as the actual response body unless Coraza intercepts the intermediary
response body, in which case the actual response body will contain the error message.</li><li>F: Final response headers.</li><li>G: Reserved for the actual response body; not implemented yet.</li><li>H: Audit log trailer.</li><li>I: This part is a replacement for part C. It will log the same data as C in all cases except when
<code>multipart/form-data</code> encoding in used. In this case, it will log a fake <code>application/x-www-form-urlencoded</code>
body that contains the information about parameters but not about the files. This is handy if
you donâ€™t want to have (often large) files stored in your audit logs.</li><li>J: This part contains information about the files uploaded using <code>multipart/form-data</code> encoding.</li><li>K: This part contains a full list of every rule that matched (one per line) in the order they were
matched. The rules are fully qualified and will thus show inherited actions and default operators.</li><li>Z: Final boundary, signifies the end of the entry (mandatory).</li></ul><h2 id=secauditlogrelevantstatus>SecAuditLogRelevantStatus <a href=#secauditlogrelevantstatus class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures which response status code is to be considered relevant for the purpose of audit logging.</p><p><strong>Syntax:</strong> <code>SecAuditLogRelevantStatus [REGEX]</code></p><p>The main purpose of this directive is to allow you to configure audit logging for
only the transactions that have the status code that matches the supplied regular
expression.</p><p><strong>Example:</strong></p><pre><code>SecAuditLogRelevantStatus &quot;^(?:5|40[1235])&quot;
</code></pre><p>This example would log all 5xx and 4xx level status codes,
except for 404s. Although you could achieve the same effect with a rule in phase 5,
<a href=#secauditlogrelevantstatus><code>SecAuditLogRelevantStatus</code></a> is sometimes better, because it continues to work even when
<a href=#secruleengine><code>SecRuleEngine</code></a> is disabled.</p><p><strong>Note:</strong> Must have <a href=#secauditengine><code>SecAuditEngine</code></a> set to <code>RelevantOnly</code>. Additionally, the auditlog action
is present by default in rules, this will make the engine bypass the <a href=#secauditlogrelevantstatus><code>SecAuditLogRelevantStatus</code></a>
and send rule matches to the audit log regardless of status. You must specify noauditlog in the
rules manually or set it in <a href=#secdefaultaction><code>SecDefaultAction</code></a>.</p><h2 id=secdebuglog>SecDebugLog <a href=#secdebuglog class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Path to the Coraza debug log file.</p><p><strong>Syntax:</strong> <code>SecDebugLog [ABSOLUTE_PATH_TO_DEBUG_LOG]</code></p><p>Logs will be written to this file. Make sure the process user has write access to the
directory.</p><h2 id=secdebugloglevel>SecDebugLogLevel <a href=#secdebugloglevel class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the verboseness of the debug log data.</p><p><strong>Syntax:</strong> <code>SecDebugLogLevel [LOG_LEVEL]</code></p><p><strong>Default:</strong> <code>3</code></p><p>Depending on the implementation, errors ranging from 1 to 2 might be directly
logged to the connector error log. For example, level 1 (error) logs will be
written to caddy server error logs.
The possible values for the debug log level are:</p><ul><li>0: No logging (least verbose)</li><li>1: Error</li><li>2: Warn</li><li>3: Info</li><li>4-8: Debug</li><li>9: Trace (most verbose)</li></ul><p>Levels outside the 0-9 range will default to level 3 (Info)</p><h2 id=secdefaultaction>SecDefaultAction <a href=#secdefaultaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Defines the default list of actions, which will be inherited by the rules in the same configuration context.</p><p><strong>Syntax:</strong> <code>SecDefaultAction "phase:2,log,auditlog,deny,status:403,tag:'SLA 24/7'"</code></p><p><strong>Default:</strong> <code>phase:2,log,auditlog,pass</code></p><p>Every rule following a previous <a href=#secdefaultaction><code>SecDefaultAction</code></a> directive in the same configuration
context will inherit its settings unless more specific actions are used.</p><p>Rulesets like OWASP Core Ruleset uses this to define operation modes:</p><ul><li>You can set the default disruptive action to block for phases 1 and 2 and you can force
a phase 3 rule to be disrupted if the thread score is high.</li><li>You can set the default disruptive action to deny and each risky rule will interrupt
the connection.</li></ul><p>Important: Every <a href=#secdefaultaction><code>SecDefaultAction</code></a> directive must specify a disruptive action and a processing
phase and cannot contain metadata actions.</p><h2 id=secmarker>SecMarker <a href=#secmarker class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Adds a fixed rule marker that can be used as a target in a <code>skipAfter</code> action. A <a href=#secmarker><code>SecMarker</code></a> directive essentially creates a rule that does nothing and whose only purpose is to carry the given ID.</p><p><strong>Syntax:</strong> <code>SecMarker [ID|TEXT]</code></p><p>The value can be either a number or a text string. The SecMarker directive is available to
allow you to choose the best way to implement a skip-over. Here is an example used from the
Core Rule Set:</p><pre><code class=language-apache>
	SecMarker BEGIN_HOST_CHECK

	SecRule &amp;REQUEST_HEADERS:Host &quot;@eq 0&quot; \
		&quot;id:'960008',skipAfter:END_HOST_CHECK,phase:2,rev:'2.1.1',\
		t:none,block,msg:'Request Missing a Host Header',\
		tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',\
		tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',\
		severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},\
		setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},\
		setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;
	SecRule REQUEST_HEADERS:Host &quot;^$&quot; \
		&quot;id:'960008',phase:2,rev:'2.1.1',t:none,block,msg:'Request Missing a Host Header',\
		tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',\
		tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',\
		setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},\
		setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},\
		setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;

	SecMarker END_HOST_CHECK

</code></pre><h2 id=secrequestbodyaccess>SecRequestBodyAccess <a href=#secrequestbodyaccess class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures whether request bodies will be buffered and processed by Coraza.</p><p><strong>Syntax:</strong> <code>SecRequestBodyAccess On|Off</code></p><p><strong>Default:</strong> <code>Off</code></p><p>This directive is required if you want to inspect the data transported request bodies
(e.g., POST parameters). Request buffering is also required in order to make reliable
blocking possible. The possible values are:</p><ul><li>On: buffer request bodies</li><li>Off: do not buffer request bodies</li></ul><h2 id=secrequestbodyinmemorylimit>SecRequestBodyInMemoryLimit <a href=#secrequestbodyinmemorylimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum request body size that Coraza will store in memory.</p><p><strong>Syntax:</strong> <code>SecRequestBodyInMemoryLimit [LIMIT_IN_BYTES]</code></p><p><strong>Default:</strong> <code>defaults to RequestBodyLimit</code></p><p>When a <code>multipart/form-data</code> request is being processed, once the in-memory limit is reached,
the request body will start to be streamed into a temporary file on disk.</p><h2 id=secrequestbodylimit>SecRequestBodyLimit <a href=#secrequestbodylimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum request body size Coraza will accept for buffering.</p><p><strong>Syntax:</strong> <code>SecRequestBodyLimit [LIMIT_IN_BYTES]</code></p><p><strong>Default:</strong> <code>134217728 (128 Mib)</code></p><p>Anything over the limit will be rejected with status code 413 (Request Entity Too Large).
There is a hard limit of 1 GB.</p><h2 id=secrequestbodylimitaction>SecRequestBodyLimitAction <a href=#secrequestbodylimitaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Controls what happens once a request body limit, configured with SecRequestBodyLimit, is encountered</p><p><strong>Syntax:</strong> <code>SecRequestBodyLimitAction Reject|ProcessPartial</code></p><p><strong>Default:</strong> <code>Reject</code></p><p>By default, Coraza will reject a request body that is longer than specified to
avoid OOM issues while buffering the request body prior the inspection.</p><h2 id=secrequestbodynofileslimit>SecRequestBodyNoFilesLimit <a href=#secrequestbodynofileslimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum request body size Coraza will accept for buffering, excluding the size of any files being transported in the request. This directive is useful to reduce susceptibility to DoS attacks when someone is sending request bodies of very large sizes. Web applications that require file uploads must configure <a href=#secrequestbodylimit><code>SecRequestBodyLimit</code></a> to a high value, but because large files are streamed to disk, file uploads will not increase memory consumption. However, itâ€™s still possible for someone to take advantage of a large request body limit and send non-upload requests with large body sizes. This directive eliminates that loophole.</p><p><strong>Syntax:</strong> <code>SecRequestBodyNoFilesLimit 131072</code></p><p><strong>Default:</strong> <code>1048576 (1 MB)</code></p><p>Generally speaking, the default value is not small enough. For most applications, you
should be able to reduce it down to 128 KB or lower. Anything over the limit will be
rejected with status code 413 (Request Entity Too Large). There is a hard limit of 1 GB.
<strong>Note:</strong> not implemented yet</p><h2 id=secresponsebodyaccess>SecResponseBodyAccess <a href=#secresponsebodyaccess class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures whether response bodies are to be buffered.</p><p><strong>Syntax:</strong> <code>SecResponseBodyAccess On|Off</code></p><p><strong>Default:</strong> <code>Off</code></p><p>This directive is required if you plan to inspect HTML responses and implement
response blocking. Possible values are:</p><ul><li>On: buffer response bodies (but only if the response MIME type matches the list
configured with <a href=#secresponsebodymimetype><code>SecResponseBodyMimeType</code></a>).</li><li>Off: do not buffer response bodies.</li></ul><h2 id=secresponsebodylimit>SecResponseBodyLimit <a href=#secresponsebodylimit class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the maximum response body size that will be accepted for buffering.</p><p><strong>Syntax:</strong> <code>SecResponseBodyLimit [LIMIT_IN_BYTES]</code></p><p><strong>Default:</strong> <code>524288 (512 Kib)</code></p><p>Anything over this limit will be rejected with status code 500 (Internal Server Error).
This setting will not affect the responses with MIME types that are not selected for
buffering. There is a hard limit of 1 GB.</p><h2 id=secresponsebodylimitaction>SecResponseBodyLimitAction <a href=#secresponsebodylimitaction class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Controls what happens once a response body limit, configured with <a href=#secresponsebodylimit><code>SecResponseBodyLimit</code></a>, is encountered.</p><p><strong>Syntax:</strong> <code>SecResponseBodyLimitAction Reject|ProcessPartial</code></p><p>By default, Coraza will reject a response body that is longer than specified.
Some web sites, however, will produce very long responses, making it difficult
to come up with a reasonable limit. Such sites would have to raise the limit
significantly to function properly, defying the purpose of having the limit in
the first place (to control memory consumption). With the ability to choose what
happens once a limit is reached, site administrators can choose to inspect only
the first part of the response, the part that can fit into the desired limit, and
let the rest through. Some could argue that allowing parts of responses to go
uninspected is a weakness. This is true in theory, but applies only to cases in
which the attacker controls the output (e.g., can make it arbitrary long). In such
cases, however, it is not possible to prevent leakage anyway. The attacker could
compress, obfuscate, or even encrypt data before it is sent back, and therefore
bypass any monitoring device.</p><h2 id=secrule>SecRule <a href=#secrule class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Creates a rule that will analyze the selected variables using the selected operator.</p><p><strong>Syntax:</strong> <code>SecRule VARIABLES OPERATOR [ACTIONS]</code></p><p>Every rule must provide one or more variables along with the operator that should
be used to inspect them. If no actions are provided, the default list will be used.
(There is always a default list, even if one was not explicitly set with <a href=#secdefaultaction><code>SecDefaultAction</code></a>.)
If there are actions specified in a rule, they will be merged with the default list
to form the final actions that will be used. (The actions in the rule will overwrite
those in the default list.) Refer to <a href=#secdefaultaction><code>SecDefaultAction</code></a> for more information.</p><p><strong>Example:</strong></p><pre><code class=language-apache>SecRule ARGS &quot;@rx attack&quot; &quot;phase:1,log,deny,id:1&quot;
</code></pre><h2 id=secruleengine>SecRuleEngine <a href=#secruleengine class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Configures the rules engine.</p><p><strong>Syntax:</strong> <code>SecRuleEngine On|Off|DetectionOnly</code></p><p><strong>Default:</strong> <code>Off</code></p><p>The possible values are:</p><ul><li>On: process rules</li><li>Off: do not process rules</li><li>DetectionOnly: process rules but never executes any disruptive actions
(block, deny, drop, allow, proxy and redirect)</li></ul><h2 id=secruleremovebyid>SecRuleRemoveByID <a href=#secruleremovebyid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Removes the matching rules from the current configuration context.</p><p><strong>Syntax:</strong> <code>SecRuleRemoveById ...[ID OR RANGE]</code></p><h2 id=secruleremovebytag>SecRuleRemoveByTag <a href=#secruleremovebytag class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Removes the matching rules from the current configuration context.</p><p><strong>Syntax:</strong> <code>SecRuleRemoveByTag [TAG]</code></p><p>Normally, you would use <a href=#secruleremovebyid><code>SecRuleRemoveById</code></a> to remove rules, but it may occasionally
be easier to disable an entire group of rules with <a href=#secruleremovebytag><code>SecRuleRemoveByTag</code></a>. Matching is
by case-sensitive string equality.</p><p><strong>Example:</strong></p><pre><code class=language-apache>SecRuleRemoveByTag attack-dos
</code></pre><p><strong>Note:</strong> OWASP CRS has a list of supported tags https://coreruleset.org/docs/rules/metadata/</p><h2 id=secruleupdatetargetbyid>SecRuleUpdateTargetByID <a href=#secruleupdatetargetbyid class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Updates the target (variable) list of the specified rule(s).</p><p><strong>Syntax:</strong> <code>SecRuleUpdateTargetById ID TARGET1[|TARGET2|TARGET3]</code></p><p>This directive will append variables to the specified rule with the targets provided in the second parameter.
The rule ID can be single IDs or ranges of IDs. The targets are separated by a pipe character.</p><h2 id=secruleupdatetargetbytag>SecRuleUpdateTargetByTag <a href=#secruleupdatetargetbytag class=anchor aria-hidden=true>#</a></h2><p><strong>Description:</strong> Updates the target (variable) list of the specified rule(s) by tag.</p><p><strong>Syntax:</strong> <code>SecRuleUpdateTargetByTag TAG TARGET1[|TARGET2|TARGET3]</code></p><p>As an alternative to <a href=#secruleupdatetargetbyid><code>SecRuleUpdateTargetById</code></a>, this directive will append variables to the specified rule
with the targets provided in the second parameter. It can be handy for updating an entire group of rules.
Matching is by case-sensitive string equality.
This directive will append variables to the specified rule with the targets provided in the second parameter.
The rule ID can be single IDs or ranges of IDs. The targets are separated by a pipe character.
<strong>Note:</strong> OWASP CRS has a list of supported tags https://coreruleset.org/docs/rules/metadata/</p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/seclang/directives.md><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
Edit this page on</a></div></div><div class="docs-navigation d-flex justify-content-between"><a class=ms-auto href=https://coraza.io/docs/seclang/syntax/><div class="card my-1"><div class="card-body py-2">Syntax &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love â¤ï¸ (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.bdd16591022949a580db09a7d4f7553da4378491c6ce72d656a2bdd0e06593829eb2f23dbfd37b22b3b0ae0751e6719ab5da7d0245dfa3770ec3a4726ba0c9b5.js integrity="sha512-vdFlkQIpSaWA2wmn1PdVPaQ3hJHGznLWVqK90OBlk4KesvI9v9N7IrOwrgdR5nGatdp9AkXfo3cOw6Rya6DJtQ==" crossorigin=anonymous defer></script><script src=https://coraza.io/js/highlight.min.7771c56e89d0ed6d0fdb1feecf684c4740edc48e1ea7cea2ff1fca3450ce23c7e48ae3ddf5c7f860fc112dd3bc04675e78c221bb16b20364ab4d67454de50f02.js integrity="sha512-d3HFbonQ7W0P2x/uz2hMR0DtxI4ep86i/x/KNFDOI8fkiuPd9cf4YPwRLdO8BGdeeMIhuxayA2SrTWdFTeUPAg==" crossorigin=anonymous defer></script><script src=https://coraza.io/main.min.22d8b246b1be2978435f96303ee2ffc165de03cbd76ed7ccdc26eb97b95d1345f2d018452680c590e12fbde17c50110ac350ebb7aed6d9cc7142c9fb4ba03f03.js integrity="sha512-ItiyRrG+KXhDX5YwPuL/wWXeA8vXbtfM3Cbrl7ldE0Xy0BhFJoDFkOEvveF8UBEKw1Drt67W2cxxQsn7S6A/Aw==" crossorigin=anonymous defer></script><script src=https://coraza.io/index.min.e6335a12b69bd90c30df7cafb75547e2b9d9268bc1c4249e998299667e51a35faa8fe78158c665c63d92b8f520e624e2cc96683ff90780b92adcb41d8a7fba03.js integrity="sha512-5jNaErab2Qww33yvt1VH4rnZJovBxCSemYKZZn5Ro1+qj+eBWMZlxj2SuPUg5iTizJZoP/kHgLkq3LQdin+6Aw==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>