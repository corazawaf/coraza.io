<!doctype html><html lang=" en-us"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://coraza.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,e=localStorage.getItem("theme");t&&e===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),t&&e==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),e==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><script>(()=>{Object.keys(localStorage).forEach(function(e){/^global-alert-/.test(e)&&document.documentElement.setAttribute("data-global-alert","closed")})})()</script><link rel=stylesheet href=https://coraza.io/main.40abc73e5a2a2eff060c63ebda259239092cb4975a1f301e036e0194a1d839f0cba6bd6197d9115760f6685683a05580081bebe421a21d01f8469072245e42bd.css integrity="sha512-QKvHPloqLv8GDGPr2iWSOQkstJdaHzAeA24BlKHYOfDLpr1hl9kRV2D2aFaDoFWACBvr5CGiHQH4RpByJF5CvQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Directives - OWASP Coraza</title><meta name=description content="The following section outlines all of the Coraza directives. "><link rel=canonical href=https://coraza.io/docs/seclang/directives/><meta property="og:locale" content="en_US"><meta property="og:type" content="website"><meta property="og:title" content="Directives"><meta property="og:description" content="The following section outlines all of the Coraza directives. "><meta property="og:url" content="https://coraza.io/docs/seclang/directives/"><meta property="og:site_name" content="OWASP Coraza"><meta property="og:updated_time" content="2020-10-06T08:48:57+00:00"><meta property="og:image" content="https://coraza.io/doks.png"><meta property="og:image:alt" content="OWASP Coraza"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@corazatech"><meta name=twitter:creator content="@jptosso"><meta name=twitter:title content="Directives"><meta name=twitter:description content="The following section outlines all of the Coraza directives. "><meta name=twitter:image content="https://coraza.io/doks.png"><meta name=twitter:image:alt content="Directives"><link rel=alternate type=application/rss+xml href=https://coraza.io/docs/seclang/directives/index.xml><link rel=sitemap type=application/xml href=https://coraza.io/docs/seclang/directives/sitemap.xml><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://coraza.io/#/schema/person/1","name":"OWASP Coraza WAF","url":"https://coraza.io/","sameAs":["https://twitter.com/jptosso","https://github.com/corazawaf/coraza"],"image":{"@type":"ImageObject","@id":"https://coraza.io/#/schema/image/1","url":"https://coraza.io/doks.png","width":1280,"height":640,"caption":"OWASP Coraza WAF"}},{"@type":"WebSite","@id":"https://coraza.io/#/schema/website/1","url":"https://coraza.io/","name":"OWASP Coraza","description":"OWASP Coraza is an enterprise-grade, open-source, and high-performance Web Application Firewall library ready to protect your beloved applications.","publisher":{"@id":"https://coraza.io/#/schema/person/1"}},{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/directives/","url":"https://coraza.io/docs/seclang/directives/","name":"Directives","description":"The following section outlines all of the Coraza directives. ","isPartOf":{"@id":"https://coraza.io/#/schema/website/1"},"about":{"@id":"https://coraza.io/#/schema/person/1"},"datePublished":"2020-10-06T08:48:57CET","dateModified":"2020-10-06T08:48:57CET","breadcrumb":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://coraza.io/docs/seclang/directives/"]}]},{"@type":"BreadcrumbList","@id":"https://coraza.io/docs/seclang/directives/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://coraza.io/","url":"https://coraza.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/","url":"https://coraza.io/docs/","name":"Docs"}},{"@type":"ListItem","position":3,"item":{"@type":"WebPage","@id":"https://coraza.io/docs/seclang/","url":"https://coraza.io/docs/seclang/","name":"Seclang"}},{"@type":"ListItem","position":4,"item":{"@id":"https://coraza.io/docs/seclang/directives/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://coraza.io/docs/seclang/directives/#/schema/image/2","url":"https://coraza.io/doks.png","contentUrl":"https://coraza.io/doks.png","caption":"Directives"}]}]}</script><meta name=theme-color content="#fff"><link rel=icon href=https://coraza.io/favicon.ico sizes=any><link rel=apple-touch-icon sizes=180x180 href=https://coraza.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://coraza.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://coraza.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://coraza.io/site.webmanifest></head><body><div id=announcement data-id=global-alert-5c43d4a74d41be706ab06ce490a3cf1b class="alert alert-primary alert-dismissible fade show text-lg-center" role=alert>Coraza v3 will be available soon, <a class=alert-link href=https://github.com/corazawaf/coraza/issues/336>stay tuned!</a>
<button type=button class=btn-close data-bs-dismiss=alert aria-label=Close></button></div><div class=sticky-top><div class=header-bar></div><header class="navbar navbar-expand-lg navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand order-0" href=https://coraza.io/ aria-label="OWASP Coraza">OWASP Coraza</a>
<button class="btn btn-menu order-2 d-block d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-end border-0 py-lg-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-lg-none"></div><div class="offcanvas-header d-lg-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://coraza.io/>OWASP Coraza</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body p-4 p-lg-0"><ul class="nav flex-column flex-lg-row align-items-lg-center mt-2 mt-lg-0 ms-lg-2 me-lg-auto"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://coraza.io/docs/tutorials/introduction/>Docs</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/blog>Blog</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/plugins>Plugins</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://coraza.io/connectors>Connectors</a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://playground.coraza.io/>Playground</a></li></ul><hr class="text-black-50 my-4 d-lg-none"><form class="doks-search position-relative flex-grow-1 ms-lg-auto me-lg-2"><input id=search class="form-control is-search" type=search placeholder aria-label autocomplete=off><div id=suggestions class="shadow bg-white rounded d-none"></div></form><hr class="text-black-50 my-4 d-lg-none"><ul class="nav flex-column flex-lg-row"><li class=nav-item><a class="nav-link social-link" href=https://twitter.com/corazaio><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-lg-none">Twitter</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://github.com/corazawaf/coraza><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-lg-none">GitHub</small></a></li><li class=nav-item><a class="nav-link social-link" href=https://owasp.org/slack/invite><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 10c-.83.0-1.5-.67-1.5-1.5v-5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5z"/><path d="M20.5 10H19V8.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/><path d="M9.5 14c.83.0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5S8 21.33 8 20.5v-5c0-.83.67-1.5 1.5-1.5z"/><path d="M3.5 14H5v1.5c0 .83-.67 1.5-1.5 1.5S2 16.33 2 15.5 2.67 14 3.5 14z"/><path d="M14 14.5c0-.83.67-1.5 1.5-1.5h5c.83.0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-5c-.83.0-1.5-.67-1.5-1.5z"/><path d="M15.5 19H14v1.5c0 .83.67 1.5 1.5 1.5s1.5-.67 1.5-1.5-.67-1.5-1.5-1.5z"/><path d="M10 9.5C10 8.67 9.33 8 8.5 8h-5C2.67 8 2 8.67 2 9.5S2.67 11 3.5 11h5c.83.0 1.5-.67 1.5-1.5z"/><path d="M8.5 5H10V3.5C10 2.67 9.33 2 8.5 2S7 2.67 7 3.5 7.67 5 8.5 5z"/></svg><small class="ms-2 d-lg-none">Slack</small></a></li></ul><hr class="text-black-50 my-4 d-lg-none"><button id=mode class="btn btn-link" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></div></div></nav></header></div><div class=container-xxl><aside class=doks-sidebar><nav id=doks-docs-nav class="collapse d-lg-none" aria-label="Tertiary navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrave to v3 üÜï</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></aside></div><div class="wrap container-xxl" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><h3 class="h6 text-uppercase mb-2">Tutorials</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/tutorials/introduction/>Introduction</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/quick-start/>Quick Start</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/coreruleset/>OWASP Core Ruleset</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/using-plugins/>Using Plugins</a></li><li><a class=docs-link href=https://coraza.io/docs/tutorials/upgrade/>Upgrave to v3 üÜï</a></li></ul><h3 class="h6 text-uppercase mb-2">Seclang</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/seclang/syntax/>Syntax</a></li><li><a class="docs-link active" href=https://coraza.io/docs/seclang/directives/>Directives</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/actions/>Actions</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/execution-flow/>Execution flow</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/operators/>Operators</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/transformations/>Transformations</a></li><li><a class=docs-link href=https://coraza.io/docs/seclang/variables/>Variables</a></li></ul><h3 class="h6 text-uppercase mb-2">Reference</h3><ul class=list-unstyled><li><a class=docs-link href=https://coraza.io/docs/reference/internals/>Internals</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/benchmarks/>Benchmarks</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/body-processing/>Body Processing</a></li><li><a class=docs-link href=https://coraza.io/docs/reference/extending/>Extending</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://coraza.io/>Home</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://coraza.io/docs/seclang/>Seclang</a></li><li class="breadcrumb-item active" aria-current=page>Directives</li></ol></nav><h1>Directives</h1><nav class=d-xl-none aria-label="Quaternary navigation">TOC</nav><h2 id=Include><a href=https://coraza.io/docs/seclang/directives/include/>Include</a>
<a href=#Include class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Include and evaluate a file or file pattern.</p><p><strong>Version Compatibility:</strong> v2.1+</p><p><strong>Tinygo Compatibility:</strong> false</p><p><strong>Syntax:</strong> <code>Include /path/coreruleset/rules/*.conf</code></p><p><p style=text-align:justify><p>Include loads a file or a list of files from the filesystem using <a href=https://pkg.go.dev/path/filepath#Glob>golang Glob</a> syntax.</p><p>Quoting golang documentation:</p><blockquote><p>The syntax of patterns is the same as in Match. The pattern may describe hierarchical names such as /usr/*/bin/ed (assuming the Separator is &lsquo;/&rsquo;).<br>Glob ignores file system errors such as I/O errors reading directories. The only possible returned error is ErrBadPattern, when pattern is malformed.`</p></blockquote></p></p><p></p><h2 id=SecAction><a href=https://coraza.io/docs/seclang/directives/secaction/>SecAction</a>
<a href=#SecAction class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Unconditionally processes the action list it receives as the first and only parameter. The syntax of the parameter is identical to that of the third parameter of SecRule.</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecAction "action1,action2,action3,‚Ä¶</code></p><p><p style=text-align:justify><p>This directive is commonly used to set variables and initialize persistent collections using the initcol action. For example:</p><pre><code>SecAction &quot;nolog,phase:1,initcol:RESOURCE=%{REQUEST_FILENAME}&quot;
</code></pre></p></p><p></p><h2 id=SecArgumentSeparator><a href=https://coraza.io/docs/seclang/directives/secargumentseparator/>SecArgumentSeparator</a>
<a href=#SecArgumentSeparator class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Specifies which character to use as the separator for application/x-www-form- urlencoded content.</p><p><strong>Default:</strong> &</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecArgumentSeparator &lt;separator></code></p><p><p style=text-align:justify><p>This directive is needed if a backend web application is using a nonstandard argument separator. Applications are sometimes (very rarely) written to use a semicolon separator. You should not change the default setting unless you establish that the application you are working with requires a different separator. If this directive is not set properly for each web application, then Coraza will not be able to parse the arguments appropriately and the effectiveness of the rule matching will be significantly decreased.</p></p></p><p></p><h2 id=SecAuditEngine><a href=https://coraza.io/docs/seclang/directives/secauditengine/>SecAuditEngine</a>
<a href=#SecAuditEngine class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Configures the audit logging engine.</p><p><strong>Default:</strong> Off</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> Partial, some engines and formats might be unavailable.</p><p><strong>Syntax:</strong> <code>SecAuditEngine RelevantOnly</code></p><p><p style=text-align:justify><p>The <code>SecAuditEngine</code> directive is used to configure the audit engine, which logs complete transactions. Coraza is currently able to log most, but not all transactions. Transactions involving errors (e.g., 400 and 404 transactions) use a different execution path, which Coraza does not support.</p><p>The possible values for the audit log engine are as follows:</p><ul><li><strong>On:</strong> log all transactions</li><li><strong>Off:</strong> do not log any transactions</li><li><strong>RelevantOnly:</strong> only the log transactions that have triggered a warning or an error, or have a status code that is considered to be relevant (as determined by the <code>SecAuditLogRelevantStatus</code> directive)</li></ul><p><strong>Note :</strong> If you need to change the audit log engine configuration on a per-transaction basis (e.g., in response to some transaction data), use the ctl action. The following example demonstrates how <code>SecAuditEngine</code> is used:</p><pre><code class=language-apache>SecAuditEngine RelevantOnly
SecAuditLog logs/audit/audit.log
SecAuditLogParts ABCFHZ 
SecAuditLogType concurrent 
SecAuditLogStorageDir logs/audit 
SecAuditLogRelevantStatus ^(?:5|4(?!04))
</code></pre></p></p><p></p><h2 id=SecAuditEngine><a href=https://coraza.io/docs/seclang/directives/secauditlogparts/>SecAuditEngine</a>
<a href=#SecAuditEngine class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Defines which parts of each transaction are going to be recorded in the audit log. Each part is assigned a single letter; when a letter appears in the list then the equivalent part will be recorded. See below for the list of all parts.</p><p><strong>Default:</strong> ABCFHZ</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecAuditLogParts ABCFHZ</code></p><p><p style=text-align:justify><p>The format of the audit log format is documented in detail in the logging page.</p><p>Available audit log parts:</p><ul><li><strong>A:</strong> Audit log header (mandatory).</li><li><strong>B:</strong> Request headers.</li><li><strong>C:</strong> Request body (present only if the request body exists and Coraza is configured to intercept it. This would require SecRequestBodyAccess to be set to on).</li><li><strong>D:</strong> Reserved for intermediary response headers; not implemented yet.</li><li><strong>E:</strong> Intermediary response body (present only if Coraza is configured to intercept response bodies, and if the audit log engine is configured to record it. Intercepting response bodies requires SecResponseBodyAccess to be enabled). Intermediary response body is the same as the actual response body unless Coraza intercepts the intermediary response body, in which case the actual response body will contain the error message (either the Apache default error message, - <strong>or</strong>the ErrorDocument page).</li><li><strong>F:</strong> Final response headers (excluding the Date and Server headers, which are always added by Apache in the late stage of content delivery).</li><li><strong>G:</strong> Reserved for the actual response body; not implemented yet.</li><li><strong>H:</strong> Audit log trailer.</li><li><strong>I:</strong> This part is a replacement for part C. It will log the same data as C in all cases except when multipart/form-data encoding in used. In this case, it will log a fake application/x-www-form-urlencoded body that contains the information about parameters but not about the files. This is handy if you don‚Äôt want to have (often large) files stored in your audit logs.</li><li><strong>J:</strong> This part contains information about the files uploaded using multipart/form-data encoding.</li><li><strong>K:</strong> This part contains a full list of every rule that matched (one per line) in the order they were matched. The rules are fully qualified and will thus show inherited actions and default operators.</li><li><strong>Z:</strong> Final boundary, signifies the end of the entry (mandatory).</li></ul></p></p><p></p><h2 id=SecAuditLog><a href=https://coraza.io/docs/seclang/directives/secauditlog/>SecAuditLog</a>
<a href=#SecAuditLog class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Defines the path to the main audit log file (serial logging format) or the concurrent logging index file (concurrent logging format). When used in combination with mlogc (only possible with concurrent logging), this directive defines the mlogc location and command line.</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> Partial, file writing is not available on all platforms.</p><p><strong>Syntax:</strong> <code>SecAuditLog /path/to/audit.log</code></p><p><p style=text-align:justify><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">üëâ</div><div class=w-100>Writing to programs using pipe (|) is not implemented yet.</div></div><pre><code class=language-apache>SecAuditLog &quot;|/path/to/mlogc /path/to/mlogc.conf&quot;
</code></pre><p><strong>Note :</strong> This audit log file is opened on startup when the server typically still runs as root. You should not allow non-root users to have write privileges for this file or for the directory.</p></p></p><p></p><h2 id=SecAuditLogRelevantStatus><a href=https://coraza.io/docs/seclang/directives/secauditlogrelevantstatus/>SecAuditLogRelevantStatus</a>
<a href=#SecAuditLogRelevantStatus class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Configures which response status code is to be considered relevant for the purpose of audit logging.</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecAuditLogRelevantStatus REGEX</code></p><p><p style=text-align:justify><p><strong>Example Usage:</strong> <code>SecAuditLogRelevantStatus "^(?:5|40[1235])"</code></p><p><strong>Dependencies/Notes:</strong> Must have SecAuditEngine set to <strong>RelevantOnly</strong>. Additionally, the auditlog action is present by default in rules, this will make the engine bypass the <code>SecAuditLogRelevantStatus</code> and send rule matches to the audit log regardless of status. You must specify <strong>noauditlog</strong> in the rules manually or set it in <strong>SecDefaultAction</strong>.</p><p>The main purpose of this directive is to allow you to configure audit logging for only the transactions that have the status code that matches the supplied regular expression. The example provided would log all 5xx and 4xx level status codes, except for 404s. Although you could achieve the same effect with a rule in phase 5, SecAuditLogRelevantStatus is sometimes better, because it continues to work even when SecRuleEngine is disabled.</p></p></p><p></p><h2 id=SecDebugLog><a href=https://coraza.io/docs/seclang/directives/secdebuglog/>SecDebugLog</a>
<a href=#SecDebugLog class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Path to the Coraza debug log file.</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> Partial, file writing is not available on all platforms.</p><p><strong>Syntax:</strong> <code>SecDebugLog /path/to/coraza-debug.log</code></p><p><p style=text-align:justify><p>Logs will be written to this file. Make sure the process user has write access to the directory.</p></p></p><p></p><h2 id=SecDebugLogLevel><a href=https://coraza.io/docs/seclang/directives/secdebugloglevel/>SecDebugLogLevel</a>
<a href=#SecDebugLogLevel class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Configures the verboseness of the debug log data.</p><p><strong>Default:</strong> 2</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecDebugLogLevel 4</code></p><p><p style=text-align:justify><p>Depending on the implementation, errors ranging from 1 to 2 might be directly logged to the connector error log. For example, level 2 (error) logs will be written to caddy server error logs.</p><p>The possible values for the debug log level are:</p><ul><li><strong>0:</strong> Fatal</li><li><strong>1:</strong> Panic</li><li><strong>2:</strong> Error</li><li><strong>3:</strong> Warning</li><li><strong>4:</strong> details of how transactions are handled</li><li><strong>5:</strong> log everything, including very detailed debugging information</li></ul><p>All levels over 5 will be considered as 5.</p></p></p><p></p><h2 id=SecDefaultAction><a href=https://coraza.io/docs/seclang/directives/secdefaultaction/>SecDefaultAction</a>
<a href=#SecDefaultAction class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Defines the default list of actions, which will be inherited by the rules in the same configuration context.</p><p><strong>Default:</strong> phase:2,log,auditlog,pass</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecDefaultAction "phase:2,log,auditlog,deny,status:403,tag:'SLA 24/7'"</code></p><p><p style=text-align:justify><p>Every rule following a previous SecDefaultAction directive in the same configuration context will inherit its settings unless more specific actions are used.</p><p>Rulesets like OWASP Core Ruleset uses this to define operation modes:</p><ul><li>You can set the default disruptive action to block for phases 1 and 2 and you can force a phase 3 rule to be disrupted if the thread score is high.</li><li>You can set the default disruptive action to deny and each risky rule will interrupt the connection.</li></ul><p>**Important:**Every SecDefaultAction directive must specify a disruptive action and a processing phase and cannot contain metadata actions.</p></p></p><p></p><h2 id=SecMarker><a href=https://coraza.io/docs/seclang/directives/secmarker/>SecMarker</a>
<a href=#SecMarker class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Adds a fixed rule marker that can be used as a target in a skipAfter action. A SecMarker directive essentially creates a rule that does nothing and whose only purpose is to carry the given ID.</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecMarker ID|TEXT</code></p><p><p style=text-align:justify><p>The value can be either a number or a text string. The <code>SecMarker</code> directive is available to allow you to choose the best way to implement a skip-over. Here is an example used from the Core Rule Set:</p><pre><code class=language-apache>SecMarker BEGIN_HOST_CHECK

SecRule &amp;REQUEST_HEADERS:Host &quot;@eq 0&quot; \
    &quot;id:'960008',skipAfter:END_HOST_CHECK,phase:2,rev:'2.1.1',\
    t:none,block,msg:'Request Missing a Host Header',\
    tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',\
    tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',\
    severity:'5',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},\
    setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},\
    setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;
SecRule REQUEST_HEADERS:Host &quot;^$&quot; \
    &quot;id:'960008',phase:2,rev:'2.1.1',t:none,block,msg:'Request Missing a Host Header',\
    tag:'PROTOCOL_VIOLATION/MISSING_HEADER_HOST',tag:'WASCTC/WASC-21',\
    tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'5',\
    setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},\
    setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},\
    setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/MISSING_HEADER-%{matched_var_name}=%{matched_var}&quot;

SecMarker END_HOST_CHECK
</code></pre></p></p><p></p><h2 id=SecRequestBodyAccess><a href=https://coraza.io/docs/seclang/directives/secrequestbodyaccess/>SecRequestBodyAccess</a>
<a href=#SecRequestBodyAccess class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Configures whether request bodies will be buffered and processed by Coraza.</p><p><strong>Default:</strong> false</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecRequestBodyAccess On|Off</code></p><p><p style=text-align:justify><p>This directive is required if you want to inspect the data transported request bodies (e.g., POST parameters). Request buffering is also required in order to make reliable blocking possible. The possible values are:</p><ul><li><strong>On:</strong> buffer request bodies</li><li><strong>Off:</strong> do not buffer request bodies</li></ul></p></p><p></p><h2 id=SecRequestBodyInMemoryLimit><a href=https://coraza.io/docs/seclang/directives/secrequestbodyinmemorylimit/>SecRequestBodyInMemoryLimit</a>
<a href=#SecRequestBodyInMemoryLimit class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Configures the maximum request body size that Coraza will store in memory.</p><p><strong>Default:</strong> 131072 (128 KB)</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> Partial, file writing is not available on all platforms.</p><p><strong>Syntax:</strong> <code>SecRequestBodyInMemoryLimit LIMIT_IN_BYTES</code></p><p><p style=text-align:justify><p>When a multipart/form-data request is being processed, once the in-memory limit is reached, the request body will start to be streamed into a temporary file on disk.</p><div class="alert alert-warning d-flex" role=alert><div class="flex-shrink-1 alert-icon">üëâ</div><div class=w-100>If a tinygo implementation is not capable of writing files, this feature will be disabled.</div></div></p></p><p></p><h2 id=SecRequestBodyLimit><a href=https://coraza.io/docs/seclang/directives/secrequestbodylimit/>SecRequestBodyLimit</a>
<a href=#SecRequestBodyLimit class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Configures the maximum request body size Coraza will accept for buffering.</p><p><strong>Default:</strong> 134217728 (131072 KB)</p><p><strong>Version Compatibility:</strong> v1.0+</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecRequestBodyLimit 134217728</code></p><p><p style=text-align:justify><p>Anything over the limit will be rejected with status code 413 (Request Entity Too Large). There is a hard limit of 1 GB.</p></p></p><p></p><h2 id=SecRequestBodyNoFilesLimit><a href=https://coraza.io/docs/seclang/directives/secrequestbodynolimit/>SecRequestBodyNoFilesLimit</a>
<a href=#SecRequestBodyNoFilesLimit class=anchor aria-hidden=true>#</a></a></h2><p style=text-align:justify><strong>Description:</strong> Configures the maximum request body size Coraza will accept for buffering, excluding the size of any files being transported in the request. This directive is useful to reduce susceptibility to DoS attacks when someone is sending request bodies of very large sizes. Web applications that require file uploads must configure SecRequestBodyLimit to a high value, but because large files are streamed to disk, file uploads will not increase memory consumption. However, it‚Äôs still possible for someone to take advantage of a large request body limit and send non-upload requests with large body sizes. This directive eliminates that loophole.</p><p><strong>Default:</strong> 1048576 (1 MB)</p><p><strong>Tinygo Compatibility:</strong> true</p><p><strong>Syntax:</strong> <code>SecRequestBodyNoFilesLimit 131072</code></p><p><div class="alert alert-info d-flex" role=alert><div class="flex-shrink-1 alert-icon">üëâ</div><div class=w-100>This feature has not been implemented yet, but it might be implemented soon.</div></div><p style=text-align:justify><p>Generally speaking, the default value is not small enough. For most applications, you should be able to reduce it down to 128 KB or lower. Anything over the limit will be rejected with status code 413 (Request Entity Too Large). There is a hard limit of 1 GB.</p></p></p><p></p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/corazawaf/coraza.io/content/en/docs/seclang/directives/_index.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on</a></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by a lot of love ‚ù§Ô∏è (and code) - By Juan Pablo Tosso and Coraza Contributors</li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://coraza.io/js/bootstrap.min.44fc78ffe68ed681865871fdec9750ca44c6febe429bf0779d114896edde0f92b92891b983ef933484a02a2c7ceb3d1fa6392c39179350ad04197a153a2db970.js integrity="sha512-RPx4/+aO1oGGWHH97JdQykTG/r5Cm/B3nRFIlu3eD5K5KJG5g++TNISgKix86z0fpjksOReTUK0EGXoVOi25cA==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/js/highlight.min.5635e92dfdf21584f3359cccd776c79b9b92c9665094ee329b41860fd37f743aa089bee5d5e22fc5d30ebf5591f5125cfeee5403ffed0c7c47a9a7fcdc61381f.js integrity="sha512-VjXpLf3yFYTzNZzM13bHm5uSyWZQlO4ym0GGD9N/dDqgib7l1eIvxdMOv1WR9RJc/u5UA//tDHxHqaf83GE4Hw==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/main.min.f30a958e6d2d4cbc943428cc3c449d908f6fb4e6efedc9c8496db90722172b37b93864ed525147095926576dd5a53a8c0565d9e7bf9cf786e3676f0e90a2a353.js integrity="sha512-8wqVjm0tTLyUNCjMPESdkI9vtObv7cnISW25ByIXKze5OGTtUlFHCVkmV23VpTqMBWXZ57+c94bjZ28OkKKjUw==" crossorigin=anonymous defer></script>
<script src=https://coraza.io/index.min.7300dd122b23bf2267cafafe656f9aeddd5dadd608c2f3035ac421863841efb7d08930ab052c9607344218fe3f3e7b6440a2a1969801ca71d0603993abc3d9e8.js integrity="sha512-cwDdEisjvyJnyvr+ZW+a7d1drdYIwvMDWsQhhjhB77fQiTCrBSyWBzRCGP4/PntkQKKhlpgBynHQYDmTq8PZ6A==" crossorigin=anonymous defer></script><div class="d-flex fixed-bottom pb-4 pb-lg-5 pe-4 pe-lg-5"><a id=toTop href=# class="btn btn-outline-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-up"><polyline points="18 15 12 9 6 15"/></svg></a></div></body></html>